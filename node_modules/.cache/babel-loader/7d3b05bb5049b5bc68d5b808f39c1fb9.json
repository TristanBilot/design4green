{"ast":null,"code":"import * as cons from './../base/css-constants';\nimport { TreeGrid, ContextMenu as TreeGridContextMenu } from '@syncfusion/ej2-treegrid';\nimport { remove, closest, isNullOrUndefined, getValue, extend, addClass } from '@syncfusion/ej2-base';\nimport { Deferred } from '@syncfusion/ej2-data';\nimport { ContextMenu as Menu } from '@syncfusion/ej2-navigations'; // eslint-disable-next-line\n\n/**\n * The ContextMenu module is used to handle the context menu items & sub-menu items.\n *\n * @returns {void} .\n */\n\nvar ContextMenu =\n/** @class */\nfunction () {\n  function ContextMenu(parent) {\n    var _this = this;\n\n    this.segmentIndex = -1;\n\n    this.headerContextMenuClick = function (args) {\n      var gridRow = closest(args.event.target, '.e-row');\n      var chartRow = closest(args.event.target, '.e-chart-row');\n\n      if (isNullOrUndefined(gridRow) && isNullOrUndefined(chartRow)) {\n        args.type = 'Header';\n\n        _this.parent.trigger('contextMenuClick', args);\n      }\n    };\n\n    this.headerContextMenuOpen = function (args) {\n      var gridRow = closest(args.event.target, '.e-row');\n      var chartRow = closest(args.event.target, '.e-chart-row');\n\n      if (isNullOrUndefined(gridRow) && isNullOrUndefined(chartRow)) {\n        args.type = 'Header';\n\n        _this.parent.trigger('contextMenuOpen', args);\n      } else {\n        args.cancel = true;\n      }\n    };\n\n    this.parent = parent;\n    this.ganttID = parent.element.id;\n    TreeGrid.Inject(TreeGridContextMenu);\n    this.parent.treeGrid.contextMenuClick = this.headerContextMenuClick.bind(this);\n    this.parent.treeGrid.contextMenuOpen = this.headerContextMenuOpen.bind(this);\n    this.addEventListener();\n    this.resetItems();\n  }\n\n  ContextMenu.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.on('initiate-contextMenu', this.render, this);\n    this.parent.on('reRender-contextMenu', this.reRenderContextMenu, this);\n    this.parent.on('contextMenuClick', this.contextMenuItemClick, this);\n    this.parent.on('contextMenuOpen', this.contextMenuBeforeOpen, this);\n  };\n\n  ContextMenu.prototype.reRenderContextMenu = function (e) {\n    if (e.module === this.getModuleName() && e.enable) {\n      if (this.contextMenu) {\n        this.contextMenu.destroy();\n        remove(this.element);\n      }\n\n      this.resetItems();\n      this.render();\n    }\n  };\n\n  ContextMenu.prototype.render = function () {\n    this.element = this.parent.createElement('ul', {\n      id: this.ganttID + '_contextmenu',\n      className: cons.focusCell\n    });\n    this.parent.element.appendChild(this.element);\n    var target = '#' + this.ganttID;\n    this.contextMenu = new Menu({\n      items: this.getMenuItems(),\n      locale: this.parent.locale,\n      target: target,\n      animationSettings: {\n        effect: 'None'\n      },\n      select: this.contextMenuItemClick.bind(this),\n      beforeOpen: this.contextMenuBeforeOpen.bind(this),\n      onOpen: this.contextMenuOpen.bind(this),\n      onClose: this.contextMenuOnClose.bind(this),\n      cssClass: 'e-gantt'\n    });\n    this.contextMenu.appendTo(this.element);\n    this.parent.treeGrid.contextMenuItems = this.headerMenuItems;\n  };\n\n  ContextMenu.prototype.contextMenuItemClick = function (args) {\n    this.item = this.getKeyFromId(args.item.id);\n    var position;\n    var data;\n    var taskfields;\n    var parentItem = getValue('parentObj', args.item);\n    var index = -1;\n\n    if (parentItem && !isNullOrUndefined(parentItem.id) && this.getKeyFromId(parentItem.id) === 'DeleteDependency') {\n      index = parentItem.items.indexOf(args.item);\n    }\n\n    if (this.parent.isAdaptive) {\n      if (this.item === 'TaskInformation' || this.item === 'Above' || this.item === 'Below' || this.item === 'Child' || this.item === 'DeleteTask') {\n        if (this.parent.selectionModule && this.parent.selectionSettings.type === 'Multiple') {\n          this.parent.selectionModule.hidePopUp();\n          document.getElementsByClassName('e-gridpopup')[0].style.display = 'none';\n        }\n      }\n    }\n\n    switch (this.item) {\n      case 'TaskInformation':\n        this.parent.openEditDialog(Number(this.rowData.ganttProperties.rowUniqueID));\n        break;\n\n      case 'Above':\n      case 'Below':\n      case 'Child':\n        position = this.item;\n        data = extend({}, {}, this.rowData.taskData, true);\n        taskfields = this.parent.taskFields;\n\n        if (!isNullOrUndefined(taskfields.dependency)) {\n          data[taskfields.dependency] = null;\n        }\n\n        if (!isNullOrUndefined(taskfields.child) && data[taskfields.child]) {\n          delete data[taskfields.child];\n        }\n\n        if (!isNullOrUndefined(taskfields.parentID) && data[taskfields.parentID]) {\n          data[taskfields.parentID] = null;\n        }\n\n        if (this.rowData) {\n          var rowIndex = this.parent.updatedRecords.indexOf(this.rowData);\n          this.parent.addRecord(data, position, rowIndex);\n        }\n\n        break;\n\n      case 'Milestone':\n      case 'ToMilestone':\n        this.parent.convertToMilestone(this.rowData.ganttProperties.rowUniqueID);\n        break;\n\n      case 'DeleteTask':\n        this.parent.editModule.deleteRecord(this.rowData);\n        break;\n\n      case 'ToTask':\n        data = extend({}, {}, this.rowData.taskData, true);\n        taskfields = this.parent.taskFields;\n\n        if (!isNullOrUndefined(taskfields.duration)) {\n          var ganttProp = this.rowData.ganttProperties;\n          data[taskfields.duration] = '1 ' + ganttProp.durationUnit;\n        } else {\n          data[taskfields.startDate] = new Date(this.rowData.taskData[taskfields.startDate]);\n          var endDate = new Date(this.rowData.taskData[taskfields.startDate]);\n          endDate.setDate(endDate.getDate() + 1);\n          data[taskfields.endDate] = endDate;\n        }\n\n        if (!isNullOrUndefined(data[taskfields.milestone])) {\n          if (data[taskfields.milestone] === true) {\n            data[taskfields.milestone] = false;\n          }\n        }\n\n        this.parent.updateRecordByID(data);\n        break;\n\n      case 'Cancel':\n        this.parent.cancelEdit();\n        break;\n\n      case 'Save':\n        this.parent.editModule.cellEditModule.isCellEdit = false;\n        this.parent.treeGrid.grid.saveCell();\n        break;\n\n      case 'Dependency' + index:\n        this.parent.connectorLineEditModule.removePredecessorByIndex(this.rowData, index);\n        break;\n\n      case 'Auto':\n      case 'Manual':\n        this.parent.changeTaskMode(this.rowData);\n        break;\n\n      case 'Indent':\n        this.parent.indent();\n        break;\n\n      case 'Outdent':\n        this.parent.outdent();\n        break;\n\n      case 'Left':\n      case 'Right':\n        this.mergeCall(this.item);\n        break;\n\n      case 'SplitTask':\n        this.splitTaskCall(args);\n        break;\n    }\n\n    args.type = 'Content';\n    args.rowData = this.rowData;\n    this.parent.trigger('contextMenuClick', args);\n  };\n\n  ContextMenu.prototype.splitTaskCall = function (args) {\n    var _this = this;\n\n    this.isEdit = true;\n    var taskSettings = this.parent.taskFields;\n    var currentClickedDate = this.getClickedDate(args.element);\n\n    if (isNullOrUndefined(this.parent.timelineSettings.bottomTier) && this.parent.timelineSettings.bottomTier.unit !== 'Hour') {\n      currentClickedDate.setHours(0, 0, 0, 0);\n    }\n\n    var eventArgs = {\n      rowData: this.rowData,\n      requestType: 'splitTaskbar',\n      splitDate: currentClickedDate,\n      cancel: false,\n      target: this.targetElement\n    }; // eslint-disable-next-line\n\n    this.parent.trigger('actionBegin', eventArgs, function (eventArgs) {\n      _this.parent.chartRowsModule.splitTask(_this.rowData[taskSettings.id], currentClickedDate);\n    });\n  };\n\n  ContextMenu.prototype.mergeCall = function (item) {\n    var _this = this;\n\n    this.isEdit = true;\n    var taskSettings = this.parent.taskFields;\n    var segments = this.rowData.ganttProperties.segments;\n    var firstSegment = item === 'Right' ? this.segmentIndex : segments[this.segmentIndex - 1].segmentIndex;\n    var secondSegment = item === 'Left' ? this.segmentIndex : segments[this.segmentIndex + 1].segmentIndex;\n    var segmentIndexes = [{\n      'firstSegmentIndex': firstSegment,\n      'secondSegmentIndex': secondSegment\n    }];\n    var eventArgs = {\n      rowData: this.rowData,\n      mergeSegmentIndexes: segmentIndexes,\n      requestType: 'mergeSegment',\n      cancel: false,\n      target: this.targetElement\n    };\n    this.parent.trigger('actionBegin', eventArgs, function (eventArgs) {\n      if (eventArgs.cancel === false) {\n        _this.parent.chartRowsModule.mergeTask(_this.rowData[taskSettings.id], segmentIndexes);\n      }\n    });\n  }; // eslint-disable-next-line\n\n\n  ContextMenu.prototype.getClickedDate = function (element) {\n    // context menu click position\n    var ganttElementPosition = this.parent.getOffsetRect(this.parent.element);\n    var ganttLeft = ganttElementPosition.left - this.parent.element.offsetLeft; // task left position\n\n    var pageLeft = ganttLeft + this.parent.ganttChartModule.chartElement.offsetLeft + this.rowData.ganttProperties.left - this.parent.ganttChartModule.scrollElement.scrollLeft; // difference from task start date to current click position.\n\n    var currentTaskDifference = this.clickedPosition - pageLeft;\n    var splitTaskDuration = Math.ceil(currentTaskDifference / this.parent.perDayWidth);\n    var startDate = this.rowData.ganttProperties.startDate;\n\n    if (!isNullOrUndefined(this.parent.timelineSettings.bottomTier) && this.parent.timelineSettings.bottomTier.unit === 'Hour') {\n      splitTaskDuration = Math.ceil(currentTaskDifference / this.parent.timelineSettings.timelineUnitSize);\n      splitTaskDuration -= 1;\n    }\n\n    var contextMenuClickDate = this.parent.dataOperation.getEndDate(startDate, splitTaskDuration, this.rowData.ganttProperties.durationUnit, this.rowData, false);\n    return contextMenuClickDate;\n  };\n\n  ContextMenu.prototype.contextMenuBeforeOpen = function (args) {\n    var _this = this;\n\n    var target = args.event ? args.event.target : !this.parent.focusModule ? this.parent.focusModule.getActiveElement() : this.parent.ganttChartModule.targetElement; // Closed edited cell before opening context menu\n    // eslint-disable-next-line\n\n    if (!isNullOrUndefined(this.parent.editModule) && this.parent.editModule.cellEditModule && this.parent.editModule.cellEditModule.isCellEdit && target.parentElement.classList.contains('e-row')) {\n      this.parent.treeGrid.closeEdit();\n    }\n\n    if (!isNullOrUndefined(args.element) && args.element.id === this.parent.element.id + '_contextmenu') {\n      this.clickedPosition = getValue('event', args).clientX;\n    }\n\n    var targetElement = closest(target, '.e-gantt-child-taskbar');\n\n    if (targetElement) {\n      this.targetElement = args.target = targetElement;\n    }\n\n    args.gridRow = closest(target, '.e-row');\n    args.chartRow = closest(target, '.e-chart-row');\n    var menuElement = closest(target, '.e-gantt');\n    var editForm = closest(target, cons.editForm);\n\n    if (!editForm && this.parent.editModule && this.parent.editModule.cellEditModule && this.parent.editModule.cellEditModule.isCellEdit && this.parent.editModule.dialogModule.dialogObj && !this.parent.editModule.dialogModule.dialogObj.open) {\n      this.parent.treeGrid.grid.saveCell();\n      this.parent.editModule.cellEditModule.isCellEdit = false;\n    }\n\n    if (this.parent.readOnly) {\n      this.contextMenu.enableItems(['Add', 'Save', 'Convert', 'Delete Dependency', 'Delete Task', 'TaskMode', 'Indent', 'Outdent', 'SplitTask', 'MergeTask'], false);\n    }\n\n    if (isNullOrUndefined(args.gridRow) && isNullOrUndefined(args.chartRow) || this.contentMenuItems.length === 0) {\n      if (!isNullOrUndefined(args.parentItem) && !isNullOrUndefined(menuElement)) {\n        args.cancel = false;\n      } else {\n        args.cancel = true;\n      }\n    }\n\n    if (!args.cancel) {\n      var rowIndex = -1;\n\n      if (args.gridRow) {\n        // eslint-disable-next-line\n        rowIndex = parseInt(args.gridRow.getAttribute('aria-rowindex'), 0);\n      } else if (args.chartRow) {\n        // eslint-disable-next-line\n        rowIndex = parseInt(args.chartRow.getAttribute('aria-rowindex'), 0);\n      }\n\n      if (this.parent.selectionModule && this.parent.allowSelection && !args.parentItem && !isNullOrUndefined(args.chartRow)) {\n        this.parent.selectionModule.selectRow(rowIndex);\n      }\n\n      if (!args.parentItem) {\n        this.rowData = this.parent.updatedRecords[rowIndex];\n      }\n\n      for (var _i = 0, _a = args.items; _i < _a.length; _i++) {\n        var item = _a[_i]; // let target: EventTarget = target;\n\n        if (!item.separator) {\n          this.updateItemStatus(item, target, rowIndex);\n        }\n      }\n\n      args.rowData = this.rowData;\n      args.type = 'Content';\n      args.disableItems = this.disableItems;\n      args.hideItems = this.hideItems;\n      args.hideChildItems = [];\n\n      if (args.rowData.level === 0 && this.parent.viewType === 'ResourceView') {\n        args.cancel = true;\n        return;\n      }\n\n      var callBackPromise_1 = new Deferred();\n      this.parent.trigger('contextMenuOpen', args, function (arg) {\n        callBackPromise_1.resolve(arg);\n        _this.hideItems = arg.hideItems;\n        _this.disableItems = arg.disableItems;\n\n        if (!arg.parentItem && arg.hideItems.length === arg.items.length) {\n          _this.revertItemStatus();\n\n          arg.cancel = true;\n        }\n\n        if (_this.hideItems.length > 0) {\n          _this.contextMenu.hideItems(_this.hideItems);\n        }\n\n        if (_this.disableItems.length > 0) {\n          _this.contextMenu.enableItems(_this.disableItems, false);\n        }\n\n        if (args.hideChildItems.length > 0) {\n          _this.contextMenu.hideItems(args.hideChildItems);\n        }\n      });\n      return callBackPromise_1;\n    }\n  };\n\n  ContextMenu.prototype.updateItemStatus = function (item, target, rowIndex) {\n    var key = this.getKeyFromId(item.id);\n    var editForm = closest(target, cons.editForm);\n    var subMenu = [];\n    var taskbarElement = closest(target, '.e-gantt-child-taskbar');\n\n    if (editForm) {\n      if (!(key === 'Save' || key === 'Cancel')) {\n        this.hideItems.push(item.text);\n      }\n    } else {\n      switch (key) {\n        case 'TaskInformation':\n          if (!this.parent.editSettings.allowEditing || !this.parent.editModule) {\n            this.updateItemVisibility(item.text);\n          }\n\n          break;\n\n        case 'Add':\n          if (!this.parent.editSettings.allowAdding || !this.parent.editModule) {\n            this.updateItemVisibility(item.text);\n          }\n\n          break;\n\n        case 'Save':\n        case 'Cancel':\n          this.hideItems.push(item.text);\n          break;\n\n        case 'Convert':\n          if (this.rowData.hasChildRecords) {\n            this.hideItems.push(item.text);\n          } else if (!this.parent.editSettings.allowEditing || !this.parent.editModule) {\n            this.updateItemVisibility(item.text);\n          } else {\n            if (!this.rowData.ganttProperties.isMilestone) {\n              subMenu.push(this.createItemModel(cons.content, 'ToMilestone', this.getLocale('toMilestone')));\n            } else {\n              subMenu.push(this.createItemModel(cons.content, 'ToTask', this.getLocale('toTask')));\n            }\n\n            item.items = subMenu;\n          }\n\n          break;\n\n        case 'DeleteDependency':\n          {\n            var items = this.getPredecessorsItems();\n\n            if (this.rowData.hasChildRecords) {\n              this.hideItems.push(item.text);\n            } else if (!this.parent.editSettings.allowDeleting || items.length === 0 || !this.parent.editModule) {\n              this.updateItemVisibility(item.text);\n            } else if (items.length > 0) {\n              item.items = items;\n            }\n\n            break;\n          }\n\n        case 'DeleteTask':\n          if (!this.parent.editSettings.allowDeleting || !this.parent.editModule) {\n            this.updateItemVisibility(item.text);\n          }\n\n          break;\n\n        case 'TaskMode':\n          if (this.parent.taskMode !== 'Custom') {\n            this.updateItemVisibility(item.text);\n          } else {\n            if (this.rowData.ganttProperties.isAutoSchedule) {\n              subMenu.push(this.createItemModel(cons.content, 'Manual', this.getLocale('manual')));\n            } else {\n              subMenu.push(this.createItemModel(cons.content, 'Auto', this.getLocale('auto')));\n            }\n\n            item.items = subMenu;\n          }\n\n          break;\n\n        case 'Indent':\n          {\n            var index = this.parent.selectedRowIndex;\n            var isSelected = this.parent.selectionModule ? this.parent.selectionModule.selectedRowIndexes.length === 1 || this.parent.selectionModule.getSelectedRowCellIndexes().length === 1 ? true : false : false;\n            var prevRecord = this.parent.updatedRecords[this.parent.selectionModule.getSelectedRowIndexes()[0] - 1];\n\n            if (!this.parent.editSettings.allowEditing || index === 0 || index === -1 || !isSelected || this.parent.viewType === 'ResourceView' || this.parent.updatedRecords[index].level - prevRecord.level === 1) {\n              this.updateItemVisibility(item.text);\n            }\n\n            break;\n          }\n\n        case 'Outdent':\n          {\n            var ind = this.parent.selectionModule.getSelectedRowIndexes()[0];\n            var isSelect = this.parent.selectionModule ? this.parent.selectionModule.selectedRowIndexes.length === 1 || this.parent.selectionModule.getSelectedRowCellIndexes().length === 1 ? true : false : false;\n\n            if (!this.parent.editSettings.allowEditing || ind === -1 || ind === 0 || !isSelect || this.parent.viewType === 'ResourceView' || this.parent.updatedRecords[ind].level === 0) {\n              this.updateItemVisibility(item.text);\n            }\n\n            break;\n          }\n\n        case 'SplitTask':\n          {\n            var taskSettings = this.parent.taskFields;\n\n            if (this.parent.readOnly || !taskbarElement || isNullOrUndefined(taskSettings.segments) || this.parent.currentViewData[rowIndex].hasChildRecords) {\n              this.updateItemVisibility(item.text);\n            }\n\n            break;\n          }\n\n        case 'MergeTask':\n          if (this.parent.readOnly || !taskbarElement) {\n            this.updateItemVisibility(item.text);\n          } else {\n            this.mergeItemVisiblity(target, item);\n          }\n\n          break;\n      }\n    }\n  };\n\n  ContextMenu.prototype.mergeItemVisiblity = function (target, item) {\n    var subMenu = [];\n    var taskfields = this.parent.taskFields;\n    var currentClickedDate = this.getClickedDate(target);\n    this.segmentIndex = this.parent.chartRowsModule.getSegmentIndex(currentClickedDate, this.rowData);\n    var segments = this.rowData.ganttProperties.segments;\n\n    if (!isNullOrUndefined(segments) && segments.length > 0) {\n      if (isNullOrUndefined(taskfields.segments) && this.segmentIndex === -1) {\n        this.updateItemVisibility(item.text);\n      } else {\n        if (this.segmentIndex === 0) {\n          subMenu.push(this.createItemModel(cons.content, 'Right', this.getLocale('right')));\n        } else if (this.segmentIndex === segments.length - 1) {\n          subMenu.push(this.createItemModel(cons.content, 'Left', this.getLocale('left')));\n        } else {\n          subMenu.push(this.createItemModel(cons.content, 'Right', this.getLocale('right')));\n          subMenu.push(this.createItemModel(cons.content, 'Left', this.getLocale('left')));\n        }\n\n        item.items = subMenu;\n      }\n    } else {\n      this.hideItems.push(item.text);\n    }\n  };\n\n  ContextMenu.prototype.updateItemVisibility = function (text) {\n    var isDefaultItem = !isNullOrUndefined(this.parent.contextMenuItems) ? false : true;\n\n    if (isDefaultItem) {\n      this.hideItems.push(text);\n    } else {\n      this.disableItems.push(text);\n    }\n  };\n\n  ContextMenu.prototype.contextMenuOpen = function (args) {\n    this.isOpen = true;\n    var firstMenuItem = args.element.querySelectorAll('li:not(.e-menu-hide)')[0];\n    addClass([firstMenuItem], 'e-focused');\n  };\n\n  ContextMenu.prototype.getMenuItems = function () {\n    var menuItems = !isNullOrUndefined(this.parent.contextMenuItems) ? this.parent.contextMenuItems : this.getDefaultItems();\n\n    for (var _i = 0, menuItems_1 = menuItems; _i < menuItems_1.length; _i++) {\n      var item = menuItems_1[_i];\n\n      if (typeof item === 'string' && this.getDefaultItems().indexOf(item) !== -1) {\n        this.buildDefaultItems(item);\n      } else if (typeof item !== 'string') {\n        if (this.getDefaultItems().indexOf(item.text) !== -1) {\n          this.buildDefaultItems(item.text, item.iconCss);\n        } else if (item.target === cons.columnHeader) {\n          this.headerMenuItems.push(item);\n        } else {\n          this.contentMenuItems.push(item);\n        }\n      }\n    }\n\n    return this.contentMenuItems;\n  };\n\n  ContextMenu.prototype.createItemModel = function (target, item, text, iconCss) {\n    var itemModel = {\n      text: text,\n      id: this.generateID(item),\n      target: target,\n      iconCss: iconCss ? 'e-icons ' + iconCss : null\n    };\n    return itemModel;\n  };\n\n  ContextMenu.prototype.getLocale = function (text) {\n    var localeText = this.parent.localeObj.getConstant(text);\n    return localeText;\n  };\n\n  ContextMenu.prototype.buildDefaultItems = function (item, iconCSS) {\n    var contentMenuItem;\n\n    switch (item) {\n      case 'AutoFitAll':\n      case 'AutoFit':\n      case 'SortAscending':\n      case 'SortDescending':\n        this.headerMenuItems.push(item);\n        break;\n\n      case 'TaskInformation':\n        contentMenuItem = this.createItemModel(cons.content, item, this.getLocale('taskInformation'), this.getIconCSS(cons.editIcon, iconCSS));\n        break;\n\n      case 'Indent':\n        contentMenuItem = this.createItemModel(cons.content, item, this.getLocale('indent'), this.getIconCSS(cons.indentIcon, iconCSS));\n        break;\n\n      case 'Outdent':\n        contentMenuItem = this.createItemModel(cons.content, item, this.getLocale('outdent'), this.getIconCSS(cons.outdentIcon, iconCSS));\n        break;\n\n      case 'Save':\n        contentMenuItem = this.createItemModel(cons.editIcon, item, this.getLocale('save'), this.getIconCSS(cons.saveIcon, iconCSS));\n        break;\n\n      case 'Cancel':\n        contentMenuItem = this.createItemModel(cons.editIcon, item, this.getLocale('cancel'), this.getIconCSS(cons.cancelIcon, iconCSS));\n        break;\n\n      case 'Add':\n        contentMenuItem = this.createItemModel(cons.content, item, this.getLocale('add'), this.getIconCSS(cons.addIcon, iconCSS)); //Sub item menu\n\n        contentMenuItem.items = [];\n        contentMenuItem.items.push(this.createItemModel(cons.content, 'Above', this.getLocale('above'), this.getIconCSS(cons.addAboveIcon, iconCSS)));\n        contentMenuItem.items.push(this.createItemModel(cons.content, 'Below', this.getLocale('below'), this.getIconCSS(cons.addBelowIcon, iconCSS)));\n\n        if (this.parent.viewType !== 'ResourceView') {\n          contentMenuItem.items.push(this.createItemModel(cons.content, 'Child', this.getLocale('child')));\n        }\n\n        contentMenuItem.items.push(this.createItemModel(cons.content, 'Milestone', this.getLocale('milestone')));\n        break;\n\n      case 'DeleteTask':\n        contentMenuItem = this.createItemModel(cons.content, item, this.getLocale('deleteTask'), this.getIconCSS(cons.deleteIcon, iconCSS));\n        break;\n\n      case 'DeleteDependency':\n        contentMenuItem = this.createItemModel(cons.content, item, this.getLocale('deleteDependency'));\n        contentMenuItem.items = [];\n        contentMenuItem.items.push({});\n        break;\n\n      case 'Convert':\n        contentMenuItem = this.createItemModel(cons.content, item, this.getLocale('convert'));\n        contentMenuItem.items = [];\n        contentMenuItem.items.push({});\n        break;\n\n      case 'TaskMode':\n        contentMenuItem = this.createItemModel(cons.content, item, this.getLocale('changeScheduleMode'));\n        contentMenuItem.items = [];\n        contentMenuItem.items.push({});\n        break;\n\n      case 'SplitTask':\n        contentMenuItem = this.createItemModel(cons.content, item, this.getLocale('splitTask'));\n        break;\n\n      case 'MergeTask':\n        contentMenuItem = this.createItemModel(cons.content, item, this.getLocale('mergeTask'));\n        contentMenuItem.items = [];\n        contentMenuItem.items.push({});\n    }\n\n    if (contentMenuItem) {\n      this.contentMenuItems.push(contentMenuItem);\n    }\n  };\n\n  ContextMenu.prototype.getIconCSS = function (menuClass, iconString) {\n    return isNullOrUndefined(iconString) ? menuClass : iconString;\n  };\n\n  ContextMenu.prototype.getPredecessorsItems = function () {\n    this.predecessors = this.parent.predecessorModule.getValidPredecessor(this.rowData);\n    var items = [];\n    var itemModel;\n    var increment = 0;\n\n    for (var _i = 0, _a = this.predecessors; _i < _a.length; _i++) {\n      var predecessor = _a[_i];\n      var ganttData = this.parent.getRecordByID(predecessor.from);\n      var ganttProp = ganttData.ganttProperties;\n      var text = ganttProp.rowUniqueID + ' - ' + ganttProp.taskName;\n      var id = 'Dependency' + increment++;\n      itemModel = this.createItemModel(cons.content, id, text);\n      items.push(itemModel);\n    }\n\n    return items;\n  };\n\n  ContextMenu.prototype.getDefaultItems = function () {\n    return ['AutoFitAll', 'AutoFit', 'TaskInformation', 'DeleteTask', 'Save', 'Cancel', 'SortAscending', 'SortDescending', 'Add', 'DeleteDependency', 'Convert', 'TaskMode', 'Indent', 'Outdent', 'SplitTask', 'MergeTask'];\n  };\n  /**\n   * To get ContextMenu module name.\n   *\n   * @returns {string} .\n   */\n\n\n  ContextMenu.prototype.getModuleName = function () {\n    return 'contextMenu';\n  };\n\n  ContextMenu.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.off('initiate-contextMenu', this.render);\n    this.parent.off('reRender-contextMenu', this.reRenderContextMenu);\n    this.parent.off('contextMenuClick', this.contextMenuItemClick);\n    this.parent.off('contextMenuOpen', this.contextMenuOpen);\n  };\n\n  ContextMenu.prototype.contextMenuOnClose = function (args) {\n    var parent = 'parentObj';\n\n    if (args.items.length > 0 && args.items[0][parent] instanceof Menu) {\n      this.revertItemStatus();\n    }\n  };\n\n  ContextMenu.prototype.revertItemStatus = function () {\n    this.contextMenu.showItems(this.hideItems);\n    this.contextMenu.enableItems(this.disableItems);\n    this.hideItems = [];\n    this.disableItems = [];\n    this.isOpen = false;\n  };\n\n  ContextMenu.prototype.resetItems = function () {\n    this.hideItems = [];\n    this.disableItems = [];\n    this.headerMenuItems = [];\n    this.contentMenuItems = [];\n    this.item = null;\n  };\n\n  ContextMenu.prototype.generateID = function (item) {\n    return this.ganttID + '_contextMenu_' + item;\n  };\n\n  ContextMenu.prototype.getKeyFromId = function (id) {\n    var idPrefix = this.ganttID + '_contextMenu_';\n\n    if (id.indexOf(idPrefix) > -1) {\n      return id.replace(idPrefix, '');\n    } else {\n      return 'Custom';\n    }\n  };\n  /**\n   * To destroy the contextmenu module.\n   *\n   * @returns {void} .\n   * @private\n   */\n\n\n  ContextMenu.prototype.destroy = function () {\n    this.contextMenu.destroy();\n    remove(this.element);\n    this.removeEventListener();\n    this.contextMenu = null;\n    this.element = null;\n  };\n\n  return ContextMenu;\n}();\n\nexport { ContextMenu };","map":{"version":3,"sources":["/Users/tristanbilot/Desktop/Design4green/design4green/node_modules/@syncfusion/ej2-gantt/src/gantt/actions/context-menu.js"],"names":["cons","TreeGrid","ContextMenu","TreeGridContextMenu","remove","closest","isNullOrUndefined","getValue","extend","addClass","Deferred","Menu","parent","_this","segmentIndex","headerContextMenuClick","args","gridRow","event","target","chartRow","type","trigger","headerContextMenuOpen","cancel","ganttID","element","id","Inject","treeGrid","contextMenuClick","bind","contextMenuOpen","addEventListener","resetItems","prototype","isDestroyed","on","render","reRenderContextMenu","contextMenuItemClick","contextMenuBeforeOpen","e","module","getModuleName","enable","contextMenu","destroy","createElement","className","focusCell","appendChild","items","getMenuItems","locale","animationSettings","effect","select","beforeOpen","onOpen","onClose","contextMenuOnClose","cssClass","appendTo","contextMenuItems","headerMenuItems","item","getKeyFromId","position","data","taskfields","parentItem","index","indexOf","isAdaptive","selectionModule","selectionSettings","hidePopUp","document","getElementsByClassName","style","display","openEditDialog","Number","rowData","ganttProperties","rowUniqueID","taskData","taskFields","dependency","child","parentID","rowIndex","updatedRecords","addRecord","convertToMilestone","editModule","deleteRecord","duration","ganttProp","durationUnit","startDate","Date","endDate","setDate","getDate","milestone","updateRecordByID","cancelEdit","cellEditModule","isCellEdit","grid","saveCell","connectorLineEditModule","removePredecessorByIndex","changeTaskMode","indent","outdent","mergeCall","splitTaskCall","isEdit","taskSettings","currentClickedDate","getClickedDate","timelineSettings","bottomTier","unit","setHours","eventArgs","requestType","splitDate","targetElement","chartRowsModule","splitTask","segments","firstSegment","secondSegment","segmentIndexes","mergeSegmentIndexes","mergeTask","ganttElementPosition","getOffsetRect","ganttLeft","left","offsetLeft","pageLeft","ganttChartModule","chartElement","scrollElement","scrollLeft","currentTaskDifference","clickedPosition","splitTaskDuration","Math","ceil","perDayWidth","timelineUnitSize","contextMenuClickDate","dataOperation","getEndDate","focusModule","getActiveElement","parentElement","classList","contains","closeEdit","clientX","menuElement","editForm","dialogModule","dialogObj","open","readOnly","enableItems","contentMenuItems","length","parseInt","getAttribute","allowSelection","selectRow","_i","_a","separator","updateItemStatus","disableItems","hideItems","hideChildItems","level","viewType","callBackPromise_1","arg","resolve","revertItemStatus","key","subMenu","taskbarElement","push","text","editSettings","allowEditing","updateItemVisibility","allowAdding","hasChildRecords","isMilestone","createItemModel","content","getLocale","getPredecessorsItems","allowDeleting","taskMode","isAutoSchedule","selectedRowIndex","isSelected","selectedRowIndexes","getSelectedRowCellIndexes","prevRecord","getSelectedRowIndexes","ind","isSelect","currentViewData","mergeItemVisiblity","getSegmentIndex","isDefaultItem","isOpen","firstMenuItem","querySelectorAll","menuItems","getDefaultItems","menuItems_1","buildDefaultItems","iconCss","columnHeader","itemModel","generateID","localeText","localeObj","getConstant","iconCSS","contentMenuItem","getIconCSS","editIcon","indentIcon","outdentIcon","saveIcon","cancelIcon","addIcon","addAboveIcon","addBelowIcon","deleteIcon","menuClass","iconString","predecessors","predecessorModule","getValidPredecessor","increment","predecessor","ganttData","getRecordByID","from","taskName","removeEventListener","off","showItems","idPrefix","replace"],"mappings":"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","sourcesContent":["import * as cons from './../base/css-constants';\nimport { TreeGrid, ContextMenu as TreeGridContextMenu } from '@syncfusion/ej2-treegrid';\nimport { remove, closest, isNullOrUndefined, getValue, extend, addClass } from '@syncfusion/ej2-base';\nimport { Deferred } from '@syncfusion/ej2-data';\nimport { ContextMenu as Menu } from '@syncfusion/ej2-navigations';\n// eslint-disable-next-line\n/**\n * The ContextMenu module is used to handle the context menu items & sub-menu items.\n *\n * @returns {void} .\n */\nvar ContextMenu = /** @class */ (function () {\n    function ContextMenu(parent) {\n        var _this = this;\n        this.segmentIndex = -1;\n        this.headerContextMenuClick = function (args) {\n            var gridRow = closest(args.event.target, '.e-row');\n            var chartRow = closest(args.event.target, '.e-chart-row');\n            if (isNullOrUndefined(gridRow) && isNullOrUndefined(chartRow)) {\n                args.type = 'Header';\n                _this.parent.trigger('contextMenuClick', args);\n            }\n        };\n        this.headerContextMenuOpen = function (args) {\n            var gridRow = closest(args.event.target, '.e-row');\n            var chartRow = closest(args.event.target, '.e-chart-row');\n            if (isNullOrUndefined(gridRow) && isNullOrUndefined(chartRow)) {\n                args.type = 'Header';\n                _this.parent.trigger('contextMenuOpen', args);\n            }\n            else {\n                args.cancel = true;\n            }\n        };\n        this.parent = parent;\n        this.ganttID = parent.element.id;\n        TreeGrid.Inject(TreeGridContextMenu);\n        this.parent.treeGrid.contextMenuClick = this.headerContextMenuClick.bind(this);\n        this.parent.treeGrid.contextMenuOpen = this.headerContextMenuOpen.bind(this);\n        this.addEventListener();\n        this.resetItems();\n    }\n    ContextMenu.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on('initiate-contextMenu', this.render, this);\n        this.parent.on('reRender-contextMenu', this.reRenderContextMenu, this);\n        this.parent.on('contextMenuClick', this.contextMenuItemClick, this);\n        this.parent.on('contextMenuOpen', this.contextMenuBeforeOpen, this);\n    };\n    ContextMenu.prototype.reRenderContextMenu = function (e) {\n        if (e.module === this.getModuleName() && e.enable) {\n            if (this.contextMenu) {\n                this.contextMenu.destroy();\n                remove(this.element);\n            }\n            this.resetItems();\n            this.render();\n        }\n    };\n    ContextMenu.prototype.render = function () {\n        this.element = this.parent.createElement('ul', {\n            id: this.ganttID + '_contextmenu', className: cons.focusCell\n        });\n        this.parent.element.appendChild(this.element);\n        var target = '#' + this.ganttID;\n        this.contextMenu = new Menu({\n            items: this.getMenuItems(),\n            locale: this.parent.locale,\n            target: target,\n            animationSettings: { effect: 'None' },\n            select: this.contextMenuItemClick.bind(this),\n            beforeOpen: this.contextMenuBeforeOpen.bind(this),\n            onOpen: this.contextMenuOpen.bind(this),\n            onClose: this.contextMenuOnClose.bind(this),\n            cssClass: 'e-gantt'\n        });\n        this.contextMenu.appendTo(this.element);\n        this.parent.treeGrid.contextMenuItems = this.headerMenuItems;\n    };\n    ContextMenu.prototype.contextMenuItemClick = function (args) {\n        this.item = this.getKeyFromId(args.item.id);\n        var position;\n        var data;\n        var taskfields;\n        var parentItem = getValue('parentObj', args.item);\n        var index = -1;\n        if (parentItem && !isNullOrUndefined(parentItem.id) && this.getKeyFromId(parentItem.id) === 'DeleteDependency') {\n            index = parentItem.items.indexOf(args.item);\n        }\n        if (this.parent.isAdaptive) {\n            if (this.item === 'TaskInformation' || this.item === 'Above' || this.item === 'Below'\n                || this.item === 'Child' || this.item === 'DeleteTask') {\n                if (this.parent.selectionModule && this.parent.selectionSettings.type === 'Multiple') {\n                    this.parent.selectionModule.hidePopUp();\n                    document.getElementsByClassName('e-gridpopup')[0].style.display = 'none';\n                }\n            }\n        }\n        switch (this.item) {\n            case 'TaskInformation':\n                this.parent.openEditDialog(Number(this.rowData.ganttProperties.rowUniqueID));\n                break;\n            case 'Above':\n            case 'Below':\n            case 'Child':\n                position = this.item;\n                data = extend({}, {}, this.rowData.taskData, true);\n                taskfields = this.parent.taskFields;\n                if (!isNullOrUndefined(taskfields.dependency)) {\n                    data[taskfields.dependency] = null;\n                }\n                if (!isNullOrUndefined(taskfields.child) && data[taskfields.child]) {\n                    delete data[taskfields.child];\n                }\n                if (!isNullOrUndefined(taskfields.parentID) && data[taskfields.parentID]) {\n                    data[taskfields.parentID] = null;\n                }\n                if (this.rowData) {\n                    var rowIndex = this.parent.updatedRecords.indexOf(this.rowData);\n                    this.parent.addRecord(data, position, rowIndex);\n                }\n                break;\n            case 'Milestone':\n            case 'ToMilestone':\n                this.parent.convertToMilestone(this.rowData.ganttProperties.rowUniqueID);\n                break;\n            case 'DeleteTask':\n                this.parent.editModule.deleteRecord(this.rowData);\n                break;\n            case 'ToTask':\n                data = extend({}, {}, this.rowData.taskData, true);\n                taskfields = this.parent.taskFields;\n                if (!isNullOrUndefined(taskfields.duration)) {\n                    var ganttProp = this.rowData.ganttProperties;\n                    data[taskfields.duration] = '1 ' + ganttProp.durationUnit;\n                }\n                else {\n                    data[taskfields.startDate] = new Date(this.rowData.taskData[taskfields.startDate]);\n                    var endDate = new Date(this.rowData.taskData[taskfields.startDate]);\n                    endDate.setDate(endDate.getDate() + 1);\n                    data[taskfields.endDate] = endDate;\n                }\n                if (!isNullOrUndefined(data[taskfields.milestone])) {\n                    if (data[taskfields.milestone] === true) {\n                        data[taskfields.milestone] = false;\n                    }\n                }\n                this.parent.updateRecordByID(data);\n                break;\n            case 'Cancel':\n                this.parent.cancelEdit();\n                break;\n            case 'Save':\n                this.parent.editModule.cellEditModule.isCellEdit = false;\n                this.parent.treeGrid.grid.saveCell();\n                break;\n            case 'Dependency' + index:\n                this.parent.connectorLineEditModule.removePredecessorByIndex(this.rowData, index);\n                break;\n            case 'Auto':\n            case 'Manual':\n                this.parent.changeTaskMode(this.rowData);\n                break;\n            case 'Indent':\n                this.parent.indent();\n                break;\n            case 'Outdent':\n                this.parent.outdent();\n                break;\n            case 'Left':\n            case 'Right':\n                this.mergeCall(this.item);\n                break;\n            case 'SplitTask':\n                this.splitTaskCall(args);\n                break;\n        }\n        args.type = 'Content';\n        args.rowData = this.rowData;\n        this.parent.trigger('contextMenuClick', args);\n    };\n    ContextMenu.prototype.splitTaskCall = function (args) {\n        var _this = this;\n        this.isEdit = true;\n        var taskSettings = this.parent.taskFields;\n        var currentClickedDate = this.getClickedDate(args.element);\n        if (isNullOrUndefined(this.parent.timelineSettings.bottomTier) && this.parent.timelineSettings.bottomTier.unit !== 'Hour') {\n            currentClickedDate.setHours(0, 0, 0, 0);\n        }\n        var eventArgs = {\n            rowData: this.rowData,\n            requestType: 'splitTaskbar',\n            splitDate: currentClickedDate,\n            cancel: false,\n            target: this.targetElement\n        };\n        // eslint-disable-next-line\n        this.parent.trigger('actionBegin', eventArgs, function (eventArgs) {\n            _this.parent.chartRowsModule.splitTask(_this.rowData[taskSettings.id], currentClickedDate);\n        });\n    };\n    ContextMenu.prototype.mergeCall = function (item) {\n        var _this = this;\n        this.isEdit = true;\n        var taskSettings = this.parent.taskFields;\n        var segments = this.rowData.ganttProperties.segments;\n        var firstSegment = item === 'Right' ? this.segmentIndex : segments[this.segmentIndex - 1].segmentIndex;\n        var secondSegment = item === 'Left' ? this.segmentIndex : segments[this.segmentIndex + 1].segmentIndex;\n        var segmentIndexes = [\n            { 'firstSegmentIndex': firstSegment, 'secondSegmentIndex': secondSegment }\n        ];\n        var eventArgs = {\n            rowData: this.rowData,\n            mergeSegmentIndexes: segmentIndexes,\n            requestType: 'mergeSegment',\n            cancel: false,\n            target: this.targetElement\n        };\n        this.parent.trigger('actionBegin', eventArgs, function (eventArgs) {\n            if (eventArgs.cancel === false) {\n                _this.parent.chartRowsModule.mergeTask(_this.rowData[taskSettings.id], segmentIndexes);\n            }\n        });\n    };\n    // eslint-disable-next-line\n    ContextMenu.prototype.getClickedDate = function (element) {\n        // context menu click position\n        var ganttElementPosition = this.parent.getOffsetRect(this.parent.element);\n        var ganttLeft = ganttElementPosition.left - this.parent.element.offsetLeft;\n        // task left position\n        var pageLeft = ganttLeft + this.parent.ganttChartModule.chartElement.offsetLeft +\n            this.rowData.ganttProperties.left - this.parent.ganttChartModule.scrollElement.scrollLeft;\n        // difference from task start date to current click position.\n        var currentTaskDifference = this.clickedPosition - pageLeft;\n        var splitTaskDuration = Math.ceil(currentTaskDifference / this.parent.perDayWidth);\n        var startDate = this.rowData.ganttProperties.startDate;\n        if (!isNullOrUndefined(this.parent.timelineSettings.bottomTier) && this.parent.timelineSettings.bottomTier.unit === 'Hour') {\n            splitTaskDuration = Math.ceil(currentTaskDifference / this.parent.timelineSettings.timelineUnitSize);\n            splitTaskDuration -= 1;\n        }\n        var contextMenuClickDate = this.parent.dataOperation.getEndDate(startDate, splitTaskDuration, this.rowData.ganttProperties.durationUnit, this.rowData, false);\n        return contextMenuClickDate;\n    };\n    ContextMenu.prototype.contextMenuBeforeOpen = function (args) {\n        var _this = this;\n        var target = args.event ? args.event.target :\n            !this.parent.focusModule ? this.parent.focusModule.getActiveElement() :\n                this.parent.ganttChartModule.targetElement;\n        // Closed edited cell before opening context menu\n        // eslint-disable-next-line\n        if (!isNullOrUndefined(this.parent.editModule) && this.parent.editModule.cellEditModule && this.parent.editModule.cellEditModule.isCellEdit && target.parentElement.classList.contains('e-row')) {\n            this.parent.treeGrid.closeEdit();\n        }\n        if (!isNullOrUndefined(args.element) && args.element.id === this.parent.element.id + '_contextmenu') {\n            this.clickedPosition = getValue('event', args).clientX;\n        }\n        var targetElement = closest(target, '.e-gantt-child-taskbar');\n        if (targetElement) {\n            this.targetElement = args.target = targetElement;\n        }\n        args.gridRow = closest(target, '.e-row');\n        args.chartRow = closest(target, '.e-chart-row');\n        var menuElement = closest(target, '.e-gantt');\n        var editForm = closest(target, cons.editForm);\n        if (!editForm && this.parent.editModule && this.parent.editModule.cellEditModule\n            && this.parent.editModule.cellEditModule.isCellEdit && this.parent.editModule.dialogModule.dialogObj\n            && !this.parent.editModule.dialogModule.dialogObj.open) {\n            this.parent.treeGrid.grid.saveCell();\n            this.parent.editModule.cellEditModule.isCellEdit = false;\n        }\n        if (this.parent.readOnly) {\n            this.contextMenu.enableItems(['Add', 'Save', 'Convert', 'Delete Dependency', 'Delete Task', 'TaskMode', 'Indent', 'Outdent', 'SplitTask', 'MergeTask'], false);\n        }\n        if ((isNullOrUndefined(args.gridRow) && isNullOrUndefined(args.chartRow)) || this.contentMenuItems.length === 0) {\n            if (!isNullOrUndefined(args.parentItem) && !isNullOrUndefined(menuElement)) {\n                args.cancel = false;\n            }\n            else {\n                args.cancel = true;\n            }\n        }\n        if (!args.cancel) {\n            var rowIndex = -1;\n            if (args.gridRow) {\n                // eslint-disable-next-line\n                rowIndex = parseInt(args.gridRow.getAttribute('aria-rowindex'), 0);\n            }\n            else if (args.chartRow) {\n                // eslint-disable-next-line\n                rowIndex = parseInt(args.chartRow.getAttribute('aria-rowindex'), 0);\n            }\n            if (this.parent.selectionModule && this.parent.allowSelection && !args.parentItem && !isNullOrUndefined(args.chartRow)) {\n                this.parent.selectionModule.selectRow(rowIndex);\n            }\n            if (!args.parentItem) {\n                this.rowData = this.parent.updatedRecords[rowIndex];\n            }\n            for (var _i = 0, _a = args.items; _i < _a.length; _i++) {\n                var item = _a[_i];\n                // let target: EventTarget = target;\n                if (!item.separator) {\n                    this.updateItemStatus(item, target, rowIndex);\n                }\n            }\n            args.rowData = this.rowData;\n            args.type = 'Content';\n            args.disableItems = this.disableItems;\n            args.hideItems = this.hideItems;\n            args.hideChildItems = [];\n            if (args.rowData.level === 0 && this.parent.viewType === 'ResourceView') {\n                args.cancel = true;\n                return;\n            }\n            var callBackPromise_1 = new Deferred();\n            this.parent.trigger('contextMenuOpen', args, function (arg) {\n                callBackPromise_1.resolve(arg);\n                _this.hideItems = arg.hideItems;\n                _this.disableItems = arg.disableItems;\n                if (!arg.parentItem && arg.hideItems.length === arg.items.length) {\n                    _this.revertItemStatus();\n                    arg.cancel = true;\n                }\n                if (_this.hideItems.length > 0) {\n                    _this.contextMenu.hideItems(_this.hideItems);\n                }\n                if (_this.disableItems.length > 0) {\n                    _this.contextMenu.enableItems(_this.disableItems, false);\n                }\n                if (args.hideChildItems.length > 0) {\n                    _this.contextMenu.hideItems(args.hideChildItems);\n                }\n            });\n            return callBackPromise_1;\n        }\n    };\n    ContextMenu.prototype.updateItemStatus = function (item, target, rowIndex) {\n        var key = this.getKeyFromId(item.id);\n        var editForm = closest(target, cons.editForm);\n        var subMenu = [];\n        var taskbarElement = closest(target, '.e-gantt-child-taskbar');\n        if (editForm) {\n            if (!(key === 'Save' || key === 'Cancel')) {\n                this.hideItems.push(item.text);\n            }\n        }\n        else {\n            switch (key) {\n                case 'TaskInformation':\n                    if (!this.parent.editSettings.allowEditing || !this.parent.editModule) {\n                        this.updateItemVisibility(item.text);\n                    }\n                    break;\n                case 'Add':\n                    if (!this.parent.editSettings.allowAdding || !this.parent.editModule) {\n                        this.updateItemVisibility(item.text);\n                    }\n                    break;\n                case 'Save':\n                case 'Cancel':\n                    this.hideItems.push(item.text);\n                    break;\n                case 'Convert':\n                    if (this.rowData.hasChildRecords) {\n                        this.hideItems.push(item.text);\n                    }\n                    else if (!this.parent.editSettings.allowEditing || !this.parent.editModule) {\n                        this.updateItemVisibility(item.text);\n                    }\n                    else {\n                        if (!this.rowData.ganttProperties.isMilestone) {\n                            subMenu.push(this.createItemModel(cons.content, 'ToMilestone', this.getLocale('toMilestone')));\n                        }\n                        else {\n                            subMenu.push(this.createItemModel(cons.content, 'ToTask', this.getLocale('toTask')));\n                        }\n                        item.items = subMenu;\n                    }\n                    break;\n                case 'DeleteDependency':\n                    {\n                        var items = this.getPredecessorsItems();\n                        if (this.rowData.hasChildRecords) {\n                            this.hideItems.push(item.text);\n                        }\n                        else if (!this.parent.editSettings.allowDeleting || items.length === 0 || !this.parent.editModule) {\n                            this.updateItemVisibility(item.text);\n                        }\n                        else if (items.length > 0) {\n                            item.items = items;\n                        }\n                        break;\n                    }\n                case 'DeleteTask':\n                    if (!this.parent.editSettings.allowDeleting || !this.parent.editModule) {\n                        this.updateItemVisibility(item.text);\n                    }\n                    break;\n                case 'TaskMode':\n                    if (this.parent.taskMode !== 'Custom') {\n                        this.updateItemVisibility(item.text);\n                    }\n                    else {\n                        if (this.rowData.ganttProperties.isAutoSchedule) {\n                            subMenu.push(this.createItemModel(cons.content, 'Manual', this.getLocale('manual')));\n                        }\n                        else {\n                            subMenu.push(this.createItemModel(cons.content, 'Auto', this.getLocale('auto')));\n                        }\n                        item.items = subMenu;\n                    }\n                    break;\n                case 'Indent':\n                    {\n                        var index = this.parent.selectedRowIndex;\n                        var isSelected = this.parent.selectionModule ? this.parent.selectionModule.selectedRowIndexes.length === 1 ||\n                            this.parent.selectionModule.getSelectedRowCellIndexes().length === 1 ? true : false : false;\n                        var prevRecord = this.parent.updatedRecords[this.parent.selectionModule.getSelectedRowIndexes()[0] - 1];\n                        if (!this.parent.editSettings.allowEditing || index === 0 || index === -1 || !isSelected ||\n                            this.parent.viewType === 'ResourceView' || this.parent.updatedRecords[index].level - prevRecord.level === 1) {\n                            this.updateItemVisibility(item.text);\n                        }\n                        break;\n                    }\n                case 'Outdent':\n                    {\n                        var ind = this.parent.selectionModule.getSelectedRowIndexes()[0];\n                        var isSelect = this.parent.selectionModule ? this.parent.selectionModule.selectedRowIndexes.length === 1 ||\n                            this.parent.selectionModule.getSelectedRowCellIndexes().length === 1 ? true : false : false;\n                        if (!this.parent.editSettings.allowEditing || ind === -1 || ind === 0 || !isSelect ||\n                            this.parent.viewType === 'ResourceView' || this.parent.updatedRecords[ind].level === 0) {\n                            this.updateItemVisibility(item.text);\n                        }\n                        break;\n                    }\n                case 'SplitTask':\n                    {\n                        var taskSettings = this.parent.taskFields;\n                        if (this.parent.readOnly || !taskbarElement || isNullOrUndefined(taskSettings.segments) ||\n                            this.parent.currentViewData[rowIndex].hasChildRecords) {\n                            this.updateItemVisibility(item.text);\n                        }\n                        break;\n                    }\n                case 'MergeTask':\n                    if (this.parent.readOnly || !taskbarElement) {\n                        this.updateItemVisibility(item.text);\n                    }\n                    else {\n                        this.mergeItemVisiblity(target, item);\n                    }\n                    break;\n            }\n        }\n    };\n    ContextMenu.prototype.mergeItemVisiblity = function (target, item) {\n        var subMenu = [];\n        var taskfields = this.parent.taskFields;\n        var currentClickedDate = this.getClickedDate(target);\n        this.segmentIndex = this.parent.chartRowsModule.getSegmentIndex(currentClickedDate, this.rowData);\n        var segments = this.rowData.ganttProperties.segments;\n        if (!isNullOrUndefined(segments) && segments.length > 0) {\n            if (isNullOrUndefined(taskfields.segments) && this.segmentIndex === -1) {\n                this.updateItemVisibility(item.text);\n            }\n            else {\n                if (this.segmentIndex === 0) {\n                    subMenu.push(this.createItemModel(cons.content, 'Right', this.getLocale('right')));\n                }\n                else if (this.segmentIndex === segments.length - 1) {\n                    subMenu.push(this.createItemModel(cons.content, 'Left', this.getLocale('left')));\n                }\n                else {\n                    subMenu.push(this.createItemModel(cons.content, 'Right', this.getLocale('right')));\n                    subMenu.push(this.createItemModel(cons.content, 'Left', this.getLocale('left')));\n                }\n                item.items = subMenu;\n            }\n        }\n        else {\n            this.hideItems.push(item.text);\n        }\n    };\n    ContextMenu.prototype.updateItemVisibility = function (text) {\n        var isDefaultItem = !isNullOrUndefined(this.parent.contextMenuItems) ? false : true;\n        if (isDefaultItem) {\n            this.hideItems.push(text);\n        }\n        else {\n            this.disableItems.push(text);\n        }\n    };\n    ContextMenu.prototype.contextMenuOpen = function (args) {\n        this.isOpen = true;\n        var firstMenuItem = args.element.querySelectorAll('li:not(.e-menu-hide)')[0];\n        addClass([firstMenuItem], 'e-focused');\n    };\n    ContextMenu.prototype.getMenuItems = function () {\n        var menuItems = !isNullOrUndefined(this.parent.contextMenuItems) ?\n            this.parent.contextMenuItems : this.getDefaultItems();\n        for (var _i = 0, menuItems_1 = menuItems; _i < menuItems_1.length; _i++) {\n            var item = menuItems_1[_i];\n            if (typeof item === 'string' && this.getDefaultItems().indexOf(item) !== -1) {\n                this.buildDefaultItems(item);\n            }\n            else if (typeof item !== 'string') {\n                if (this.getDefaultItems().indexOf(item.text) !== -1) {\n                    this.buildDefaultItems(item.text, item.iconCss);\n                }\n                else if (item.target === cons.columnHeader) {\n                    this.headerMenuItems.push(item);\n                }\n                else {\n                    this.contentMenuItems.push(item);\n                }\n            }\n        }\n        return this.contentMenuItems;\n    };\n    ContextMenu.prototype.createItemModel = function (target, item, text, iconCss) {\n        var itemModel = {\n            text: text,\n            id: this.generateID(item),\n            target: target,\n            iconCss: iconCss ? 'e-icons ' + iconCss : null\n        };\n        return itemModel;\n    };\n    ContextMenu.prototype.getLocale = function (text) {\n        var localeText = this.parent.localeObj.getConstant(text);\n        return localeText;\n    };\n    ContextMenu.prototype.buildDefaultItems = function (item, iconCSS) {\n        var contentMenuItem;\n        switch (item) {\n            case 'AutoFitAll':\n            case 'AutoFit':\n            case 'SortAscending':\n            case 'SortDescending':\n                this.headerMenuItems.push(item);\n                break;\n            case 'TaskInformation':\n                contentMenuItem = this.createItemModel(cons.content, item, this.getLocale('taskInformation'), this.getIconCSS(cons.editIcon, iconCSS));\n                break;\n            case 'Indent':\n                contentMenuItem = this.createItemModel(cons.content, item, this.getLocale('indent'), this.getIconCSS(cons.indentIcon, iconCSS));\n                break;\n            case 'Outdent':\n                contentMenuItem = this.createItemModel(cons.content, item, this.getLocale('outdent'), this.getIconCSS(cons.outdentIcon, iconCSS));\n                break;\n            case 'Save':\n                contentMenuItem = this.createItemModel(cons.editIcon, item, this.getLocale('save'), this.getIconCSS(cons.saveIcon, iconCSS));\n                break;\n            case 'Cancel':\n                contentMenuItem = this.createItemModel(cons.editIcon, item, this.getLocale('cancel'), this.getIconCSS(cons.cancelIcon, iconCSS));\n                break;\n            case 'Add':\n                contentMenuItem = this.createItemModel(cons.content, item, this.getLocale('add'), this.getIconCSS(cons.addIcon, iconCSS));\n                //Sub item menu\n                contentMenuItem.items = [];\n                contentMenuItem.items.push(this.createItemModel(cons.content, 'Above', this.getLocale('above'), this.getIconCSS(cons.addAboveIcon, iconCSS)));\n                contentMenuItem.items.push(this.createItemModel(cons.content, 'Below', this.getLocale('below'), this.getIconCSS(cons.addBelowIcon, iconCSS)));\n                if (this.parent.viewType !== 'ResourceView') {\n                    contentMenuItem.items.push(this.createItemModel(cons.content, 'Child', this.getLocale('child')));\n                }\n                contentMenuItem.items.push(this.createItemModel(cons.content, 'Milestone', this.getLocale('milestone')));\n                break;\n            case 'DeleteTask':\n                contentMenuItem = this.createItemModel(cons.content, item, this.getLocale('deleteTask'), this.getIconCSS(cons.deleteIcon, iconCSS));\n                break;\n            case 'DeleteDependency':\n                contentMenuItem = this.createItemModel(cons.content, item, this.getLocale('deleteDependency'));\n                contentMenuItem.items = [];\n                contentMenuItem.items.push({});\n                break;\n            case 'Convert':\n                contentMenuItem = this.createItemModel(cons.content, item, this.getLocale('convert'));\n                contentMenuItem.items = [];\n                contentMenuItem.items.push({});\n                break;\n            case 'TaskMode':\n                contentMenuItem = this.createItemModel(cons.content, item, this.getLocale('changeScheduleMode'));\n                contentMenuItem.items = [];\n                contentMenuItem.items.push({});\n                break;\n            case 'SplitTask':\n                contentMenuItem = this.createItemModel(cons.content, item, this.getLocale('splitTask'));\n                break;\n            case 'MergeTask':\n                contentMenuItem = this.createItemModel(cons.content, item, this.getLocale('mergeTask'));\n                contentMenuItem.items = [];\n                contentMenuItem.items.push({});\n        }\n        if (contentMenuItem) {\n            this.contentMenuItems.push(contentMenuItem);\n        }\n    };\n    ContextMenu.prototype.getIconCSS = function (menuClass, iconString) {\n        return isNullOrUndefined(iconString) ? menuClass : iconString;\n    };\n    ContextMenu.prototype.getPredecessorsItems = function () {\n        this.predecessors = this.parent.predecessorModule.getValidPredecessor(this.rowData);\n        var items = [];\n        var itemModel;\n        var increment = 0;\n        for (var _i = 0, _a = this.predecessors; _i < _a.length; _i++) {\n            var predecessor = _a[_i];\n            var ganttData = this.parent.getRecordByID(predecessor.from);\n            var ganttProp = ganttData.ganttProperties;\n            var text = ganttProp.rowUniqueID + ' - ' + ganttProp.taskName;\n            var id = 'Dependency' + increment++;\n            itemModel = this.createItemModel(cons.content, id, text);\n            items.push(itemModel);\n        }\n        return items;\n    };\n    ContextMenu.prototype.getDefaultItems = function () {\n        return ['AutoFitAll', 'AutoFit',\n            'TaskInformation', 'DeleteTask', 'Save', 'Cancel',\n            'SortAscending', 'SortDescending', 'Add',\n            'DeleteDependency', 'Convert', 'TaskMode', 'Indent', 'Outdent', 'SplitTask', 'MergeTask'\n        ];\n    };\n    /**\n     * To get ContextMenu module name.\n     *\n     * @returns {string} .\n     */\n    ContextMenu.prototype.getModuleName = function () {\n        return 'contextMenu';\n    };\n    ContextMenu.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off('initiate-contextMenu', this.render);\n        this.parent.off('reRender-contextMenu', this.reRenderContextMenu);\n        this.parent.off('contextMenuClick', this.contextMenuItemClick);\n        this.parent.off('contextMenuOpen', this.contextMenuOpen);\n    };\n    ContextMenu.prototype.contextMenuOnClose = function (args) {\n        var parent = 'parentObj';\n        if (args.items.length > 0 && args.items[0][parent] instanceof Menu) {\n            this.revertItemStatus();\n        }\n    };\n    ContextMenu.prototype.revertItemStatus = function () {\n        this.contextMenu.showItems(this.hideItems);\n        this.contextMenu.enableItems(this.disableItems);\n        this.hideItems = [];\n        this.disableItems = [];\n        this.isOpen = false;\n    };\n    ContextMenu.prototype.resetItems = function () {\n        this.hideItems = [];\n        this.disableItems = [];\n        this.headerMenuItems = [];\n        this.contentMenuItems = [];\n        this.item = null;\n    };\n    ContextMenu.prototype.generateID = function (item) {\n        return this.ganttID + '_contextMenu_' + item;\n    };\n    ContextMenu.prototype.getKeyFromId = function (id) {\n        var idPrefix = this.ganttID + '_contextMenu_';\n        if (id.indexOf(idPrefix) > -1) {\n            return id.replace(idPrefix, '');\n        }\n        else {\n            return 'Custom';\n        }\n    };\n    /**\n     * To destroy the contextmenu module.\n     *\n     * @returns {void} .\n     * @private\n     */\n    ContextMenu.prototype.destroy = function () {\n        this.contextMenu.destroy();\n        remove(this.element);\n        this.removeEventListener();\n        this.contextMenu = null;\n        this.element = null;\n    };\n    return ContextMenu;\n}());\nexport { ContextMenu };\n"]},"metadata":{},"sourceType":"module"}