{"ast":null,"code":"import { isNullOrUndefined, removeClass } from '@syncfusion/ej2-base';\nimport { createCheckBox } from '@syncfusion/ej2-buttons';\nimport { parentsUntil, getObject } from '@syncfusion/ej2-grids';\nimport * as events from '../base/constant';\nimport { getParentData, isRemoteData, isCheckboxcolumn, findChildrenRecords } from '../utils';\n/**\n * TreeGrid Selection module\n *\n * @hidden\n */\n\nvar Selection =\n/** @class */\nfunction () {\n  /**\n   * Constructor for Selection module\n   *\n   * @param {TreeGrid} parent - Tree Grid instance\n   */\n  function Selection(parent) {\n    this.parent = parent;\n    this.selectedItems = [];\n    this.selectedIndexes = [];\n    this.filteredList = [];\n    this.addEventListener();\n  }\n  /**\n   * For internal use only - Get the module name.\n   *\n   * @private\n   * @returns {string} Returns Selection module name\n   */\n\n\n  Selection.prototype.getModuleName = function () {\n    return 'selection';\n  };\n\n  Selection.prototype.addEventListener = function () {\n    this.parent.on('dataBoundArg', this.headerCheckbox, this);\n    this.parent.on('columnCheckbox', this.columnCheckbox, this);\n    this.parent.on('updateGridActions', this.updateGridActions, this);\n    this.parent.grid.on('colgroup-refresh', this.headerCheckbox, this);\n    this.parent.on('checkboxSelection', this.checkboxSelection, this);\n  };\n\n  Selection.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.off('dataBoundArg', this.headerCheckbox);\n    this.parent.off('columnCheckbox', this.columnCheckbox);\n    this.parent.grid.off('colgroup-refresh', this.headerCheckbox);\n    this.parent.off('checkboxSelection', this.checkboxSelection);\n    this.parent.off('updateGridActions', this.updateGridActions);\n  };\n  /**\n   * To destroy the Selection\n   *\n   * @returns {void}\n   * @hidden\n   */\n\n\n  Selection.prototype.destroy = function () {\n    this.removeEventListener();\n  };\n\n  Selection.prototype.checkboxSelection = function (args) {\n    var target = getObject('target', args);\n    var checkWrap = parentsUntil(target, 'e-checkbox-wrapper');\n    var checkBox;\n\n    if (checkWrap && checkWrap.querySelectorAll('.e-treecheckselect').length > 0) {\n      checkBox = checkWrap.querySelector('input[type=\"checkbox\"]');\n      var rowIndex = [];\n      rowIndex.push(target.closest('tr').rowIndex);\n      this.selectCheckboxes(rowIndex);\n      this.triggerChkChangeEvent(checkBox, checkBox.nextElementSibling.classList.contains('e-check'), target.closest('tr'));\n    } else if (checkWrap && checkWrap.querySelectorAll('.e-treeselectall').length > 0 && this.parent.autoCheckHierarchy) {\n      var checkBoxvalue = !checkWrap.querySelector('.e-frame').classList.contains('e-check') && !checkWrap.querySelector('.e-frame').classList.contains('e-stop');\n      this.headerSelection(checkBoxvalue);\n      checkBox = checkWrap.querySelector('input[type=\"checkbox\"]');\n      this.triggerChkChangeEvent(checkBox, checkBoxvalue, target.closest('tr'));\n    }\n  };\n\n  Selection.prototype.triggerChkChangeEvent = function (checkBox, checkState, rowElement) {\n    var data = this.parent.getCurrentViewRecords()[rowElement.rowIndex];\n    var args = {\n      checked: checkState,\n      target: checkBox,\n      rowElement: rowElement,\n      rowData: checkBox.classList.contains('e-treeselectall') ? this.parent.getCheckedRecords() : data\n    };\n    this.parent.trigger(events.checkboxChange, args);\n  };\n\n  Selection.prototype.getCheckboxcolumnIndex = function () {\n    var mappingUid;\n    var columnIndex;\n    var columns = this.parent.columns;\n\n    for (var col = 0; col < columns.length; col++) {\n      if (columns[col].showCheckbox) {\n        mappingUid = this.parent.columns[col].uid;\n      }\n    }\n\n    var headerCelllength = this.parent.getHeaderContent().querySelectorAll('.e-headercelldiv').length;\n\n    for (var j = 0; j < headerCelllength; j++) {\n      var headercell = this.parent.getHeaderContent().querySelectorAll('.e-headercelldiv')[j];\n\n      if (headercell.getAttribute('e-mappinguid') === mappingUid) {\n        columnIndex = j;\n      }\n    }\n\n    return columnIndex;\n  };\n\n  Selection.prototype.headerCheckbox = function () {\n    this.columnIndex = this.getCheckboxcolumnIndex();\n\n    if (this.columnIndex > -1 && this.parent.getHeaderContent().querySelectorAll('.e-treeselectall').length === 0) {\n      var headerElement = this.parent.getHeaderContent().querySelectorAll('.e-headercelldiv')[this.columnIndex];\n      var value = false;\n      var rowChkBox = this.parent.createElement('input', {\n        className: 'e-treeselectall',\n        attrs: {\n          'type': 'checkbox'\n        }\n      });\n      var checkWrap = createCheckBox(this.parent.createElement, false, {\n        checked: value,\n        label: ' '\n      });\n      checkWrap.classList.add('e-hierarchycheckbox');\n      checkWrap.insertBefore(rowChkBox.cloneNode(), checkWrap.firstChild);\n\n      if (!isNullOrUndefined(headerElement)) {\n        headerElement.insertBefore(checkWrap, headerElement.firstChild);\n      }\n\n      if (this.parent.autoCheckHierarchy) {\n        this.headerSelection();\n      }\n    } else if (this.columnIndex > -1 && this.parent.getHeaderContent().querySelectorAll('.e-treeselectall').length > 0) {\n      var checkWrap = this.parent.getHeaderContent().querySelectorAll('.e-checkbox-wrapper')[0];\n      var checkBoxvalue = checkWrap.querySelector('.e-frame').classList.contains('e-check');\n\n      if (this.parent.autoCheckHierarchy && checkBoxvalue) {\n        this.headerSelection(checkBoxvalue);\n      }\n    }\n  };\n\n  Selection.prototype.renderColumnCheckbox = function (args) {\n    var rowChkBox = this.parent.createElement('input', {\n      className: 'e-treecheckselect',\n      attrs: {\n        'type': 'checkbox'\n      }\n    });\n    var data = args.data;\n    args.cell.classList.add('e-treegridcheckbox');\n    args.cell.setAttribute('aria-label', 'checkbox');\n    var value = isNullOrUndefined(data.checkboxState) || data.checkboxState === 'uncheck' ? false : true;\n    var checkWrap = createCheckBox(this.parent.createElement, false, {\n      checked: value,\n      label: ' '\n    });\n    checkWrap.classList.add('e-hierarchycheckbox');\n\n    if (this.parent.allowTextWrap) {\n      checkWrap.querySelector('.e-frame').style.width = '18px';\n    }\n\n    if (data.checkboxState === 'indeterminate') {\n      var checkbox = checkWrap.querySelectorAll('.e-frame')[0];\n      removeClass([checkbox], ['e-check', 'e-stop', 'e-uncheck']);\n      checkWrap.querySelector('.e-frame').classList.add('e-stop');\n    }\n\n    checkWrap.insertBefore(rowChkBox.cloneNode(), checkWrap.firstChild);\n    return checkWrap;\n  };\n\n  Selection.prototype.columnCheckbox = function (container) {\n    var checkWrap = this.renderColumnCheckbox(container);\n    var containerELe = container.cell.querySelector('.e-treecolumn-container');\n\n    if (!isNullOrUndefined(containerELe)) {\n      if (!container.cell.querySelector('.e-hierarchycheckbox')) {\n        containerELe.insertBefore(checkWrap, containerELe.querySelectorAll('.e-treecell')[0]);\n      }\n    } else {\n      var spanEle = this.parent.createElement('span', {\n        className: 'e-treecheckbox'\n      });\n      var data = container.cell.innerHTML;\n      container.cell.innerHTML = '';\n      spanEle.innerHTML = data;\n      var divEle = this.parent.createElement('div', {\n        className: 'e-treecheckbox-container'\n      });\n      divEle.appendChild(checkWrap);\n      divEle.appendChild(spanEle);\n      container.cell.appendChild(divEle);\n    }\n  };\n\n  Selection.prototype.selectCheckboxes = function (rowIndexes) {\n    for (var i = 0; i < rowIndexes.length; i++) {\n      var record = this.parent.getCurrentViewRecords()[rowIndexes[i]];\n      var flatRecord = getParentData(this.parent, record.uniqueID);\n      record = flatRecord;\n      var checkboxState = record.checkboxState === 'uncheck' ? 'check' : 'uncheck';\n      record.checkboxState = checkboxState;\n      var keys = Object.keys(record);\n\n      for (var j = 0; j < keys.length; j++) {\n        if (Object.prototype.hasOwnProperty.call(flatRecord, keys[j])) {\n          flatRecord[keys[j]] = record[keys[j]];\n        }\n      }\n\n      this.traverSelection(record, checkboxState, false);\n\n      if (this.parent.autoCheckHierarchy) {\n        this.headerSelection();\n      }\n    }\n  };\n\n  Selection.prototype.traverSelection = function (record, checkboxState, ischildItem) {\n    var length = 0;\n    this.updateSelectedItems(record, checkboxState);\n\n    if (!ischildItem && record.parentItem && this.parent.autoCheckHierarchy) {\n      this.updateParentSelection(record.parentItem);\n    }\n\n    if (record.childRecords && this.parent.autoCheckHierarchy) {\n      var childRecords = record.childRecords;\n\n      if (!isNullOrUndefined(this.parent.filterModule) && this.parent.filterModule.filteredResult.length > 0 && this.parent.autoCheckHierarchy) {\n        childRecords = this.getFilteredChildRecords(childRecords);\n      }\n\n      length = childRecords.length;\n\n      for (var count = 0; count < length; count++) {\n        if (!childRecords[count].isSummaryRow) {\n          if (childRecords[count].hasChildRecords) {\n            this.traverSelection(childRecords[count], checkboxState, true);\n          } else {\n            this.updateSelectedItems(childRecords[count], checkboxState);\n          }\n        }\n      }\n    }\n  };\n\n  Selection.prototype.getFilteredChildRecords = function (childRecords) {\n    var _this = this;\n\n    var filteredChildRecords = childRecords.filter(function (e) {\n      return _this.parent.filterModule.filteredResult.indexOf(e) > -1;\n    });\n    return filteredChildRecords;\n  };\n\n  Selection.prototype.updateParentSelection = function (parentRecord) {\n    var length = 0;\n    var childRecords = [];\n    var record = getParentData(this.parent, parentRecord.uniqueID);\n\n    if (record && record.childRecords) {\n      childRecords = record.childRecords;\n    }\n\n    if (!isNullOrUndefined(this.parent.filterModule) && this.parent.filterModule.filteredResult.length > 0 && this.parent.autoCheckHierarchy) {\n      childRecords = this.getFilteredChildRecords(childRecords);\n    }\n\n    length = childRecords && childRecords.length;\n    var indeter = 0;\n    var checkChildRecords = 0;\n\n    if (!isNullOrUndefined(record)) {\n      for (var i = 0; i < childRecords.length; i++) {\n        var currentRecord = getParentData(this.parent, childRecords[i].uniqueID);\n        var checkBoxRecord = currentRecord;\n\n        if (!isNullOrUndefined(checkBoxRecord)) {\n          if (checkBoxRecord.checkboxState === 'indeterminate') {\n            indeter++;\n          } else if (checkBoxRecord.checkboxState === 'check') {\n            checkChildRecords++;\n          }\n        }\n      }\n\n      if (indeter > 0 || checkChildRecords > 0 && checkChildRecords !== length) {\n        record.checkboxState = 'indeterminate';\n      } else if (checkChildRecords === 0 && indeter === 0) {\n        record.checkboxState = 'uncheck';\n      } else {\n        record.checkboxState = 'check';\n      }\n\n      this.updateSelectedItems(record, record.checkboxState);\n\n      if (record.parentItem) {\n        this.updateParentSelection(record.parentItem);\n      }\n    }\n  };\n\n  Selection.prototype.headerSelection = function (checkAll) {\n    var _this = this;\n\n    var index = -1;\n    var length = 0;\n\n    if (!isNullOrUndefined(this.parent.filterModule) && this.parent.filterModule.filteredResult.length > 0) {\n      var filterResult = this.parent.filterModule.filteredResult;\n\n      if (this.filteredList.length === 0) {\n        this.filteredList = filterResult;\n      } else {\n        if (this.filteredList !== filterResult) {\n          this.filteredList = filterResult;\n        }\n      }\n    }\n\n    if (this.filteredList.length > 0) {\n      if (!this.parent.filterSettings.columns.length && this.filteredList.length) {\n        this.filteredList = [];\n      }\n    }\n\n    var data = !isNullOrUndefined(this.parent.filterModule) && this.filteredList.length > 0 ? this.filteredList : this.parent.flatData;\n    data = isRemoteData(this.parent) ? this.parent.getCurrentViewRecords() : data;\n\n    if (!isNullOrUndefined(checkAll)) {\n      for (var i = 0; i < data.length; i++) {\n        if (checkAll) {\n          if (data[i].checkboxState === 'check') {\n            continue;\n          }\n\n          data[i].checkboxState = 'check';\n          this.updateSelectedItems(data[i], data[i].checkboxState);\n        } else {\n          index = this.selectedItems.indexOf(data[i]);\n\n          if (index > -1) {\n            data[i].checkboxState = 'uncheck';\n            this.updateSelectedItems(data[i], data[i].checkboxState);\n\n            if (this.parent.autoCheckHierarchy) {\n              this.updateParentSelection(data[i]);\n            }\n          }\n        }\n      }\n    }\n\n    if (checkAll === false && this.parent.enableVirtualization) {\n      this.selectedItems = [];\n      this.selectedIndexes = [];\n      data.filter(function (rec) {\n        rec.checkboxState = 'uncheck';\n\n        _this.updateSelectedItems(rec, rec.checkboxState);\n      });\n    }\n\n    length = this.selectedItems.length;\n    var checkbox = this.parent.getHeaderContent().querySelectorAll('.e-frame')[0];\n\n    if (length > 0 && data.length > 0) {\n      if (length !== data.length && !checkAll) {\n        removeClass([checkbox], ['e-check']);\n        checkbox.classList.add('e-stop');\n      } else {\n        removeClass([checkbox], ['e-stop']);\n        checkbox.classList.add('e-check');\n      }\n    } else {\n      removeClass([checkbox], ['e-check', 'e-stop']);\n    }\n  };\n\n  Selection.prototype.updateSelectedItems = function (currentRecord, checkState) {\n    var record = this.parent.getCurrentViewRecords().filter(function (e) {\n      return e.uniqueID === currentRecord.uniqueID;\n    });\n    var checkedRecord;\n    var recordIndex = this.parent.getCurrentViewRecords().indexOf(record[0]);\n    var checkboxRecord = getParentData(this.parent, currentRecord.uniqueID);\n    var checkbox;\n\n    if (recordIndex > -1) {\n      var tr = this.parent.getRows()[recordIndex];\n      var movableTr = void 0;\n\n      if (this.parent.frozenRows || this.parent.getFrozenColumns()) {\n        movableTr = this.parent.getMovableDataRows()[recordIndex];\n      }\n\n      checkbox = tr.querySelectorAll('.e-frame')[0] ? tr.querySelectorAll('.e-frame')[0] : movableTr.querySelectorAll('.e-frame')[0];\n\n      if (!isNullOrUndefined(checkbox)) {\n        removeClass([checkbox], ['e-check', 'e-stop', 'e-uncheck']);\n      }\n    }\n\n    checkedRecord = checkboxRecord;\n\n    if (isNullOrUndefined(checkedRecord)) {\n      checkedRecord = currentRecord;\n    }\n\n    checkedRecord.checkboxState = checkState;\n\n    if (checkState === 'check' && isNullOrUndefined(currentRecord.isSummaryRow)) {\n      if (recordIndex !== -1 && this.selectedIndexes.indexOf(recordIndex) === -1) {\n        this.selectedIndexes.push(recordIndex);\n      }\n\n      if (this.selectedItems.indexOf(checkedRecord) === -1 && recordIndex !== -1 && !isNullOrUndefined(this.parent.filterModule) && this.parent.filterModule.filteredResult.length > 0) {\n        this.selectedItems.push(checkedRecord);\n      }\n\n      if (this.selectedItems.indexOf(checkedRecord) === -1 && this.parent.enableVirtualization && !isNullOrUndefined(this.parent.filterModule) && this.parent.filterModule.filteredResult.length > 0) {\n        this.selectedItems.push(checkedRecord);\n      }\n\n      if (this.selectedItems.indexOf(checkedRecord) === -1 && !isNullOrUndefined(this.parent.filterModule) && this.parent.filterModule.filteredResult.length === 0) {\n        this.selectedItems.push(checkedRecord);\n      }\n\n      if (this.selectedItems.indexOf(checkedRecord) === -1 && isNullOrUndefined(this.parent.filterModule)) {\n        this.selectedItems.push(checkedRecord);\n      }\n    } else if ((checkState === 'uncheck' || checkState === 'indeterminate') && isNullOrUndefined(currentRecord.isSummaryRow)) {\n      var index = this.selectedItems.indexOf(checkedRecord);\n\n      if (index !== -1) {\n        this.selectedItems.splice(index, 1);\n      }\n\n      if (this.selectedIndexes.indexOf(recordIndex) !== -1) {\n        var checkedIndex = this.selectedIndexes.indexOf(recordIndex);\n        this.selectedIndexes.splice(checkedIndex, 1);\n      }\n    }\n\n    var checkBoxclass = checkState === 'indeterminate' ? 'e-stop' : 'e-' + checkState;\n\n    if (recordIndex > -1) {\n      if (!isNullOrUndefined(checkbox)) {\n        checkbox.classList.add(checkBoxclass);\n      }\n    }\n  };\n\n  Selection.prototype.updateGridActions = function (args) {\n    var _this = this;\n\n    var requestType = args.requestType;\n    var childData;\n    var childLength;\n\n    if (isCheckboxcolumn(this.parent)) {\n      if (this.parent.autoCheckHierarchy) {\n        if (requestType === 'sorting' || requestType === 'paging') {\n          var rows = this.parent.grid.getRows();\n          childData = this.parent.getCurrentViewRecords();\n          childLength = childData.length;\n          this.selectedIndexes = [];\n\n          for (var i = 0; i < childLength; i++) {\n            if (!rows[i].classList.contains('e-summaryrow')) {\n              this.updateSelectedItems(childData[i], childData[i].checkboxState);\n            }\n          }\n        } else if (requestType === 'delete' || args.action === 'add') {\n          var updatedData = [];\n\n          if (requestType === 'delete') {\n            updatedData = args.data;\n          } else {\n            updatedData.push(args.data);\n          }\n\n          for (var i = 0; i < updatedData.length; i++) {\n            if (requestType === 'delete') {\n              var index = this.parent.flatData.indexOf(updatedData[i]);\n              var checkedIndex = this.selectedIndexes.indexOf(index);\n              this.selectedIndexes.splice(checkedIndex, 1);\n              this.updateSelectedItems(updatedData[i], 'uncheck');\n            }\n\n            if (!isNullOrUndefined(updatedData[i].parentItem)) {\n              this.updateParentSelection(updatedData[i].parentItem);\n            }\n          }\n        } else if (args.requestType === 'add' && this.parent.autoCheckHierarchy) {\n          args.data.checkboxState = 'uncheck';\n        } else if (requestType === 'filtering' || requestType === 'searching' || requestType === 'refresh' && !isRemoteData(this.parent)) {\n          this.selectedItems = [];\n          this.selectedIndexes = [];\n          childData = !isNullOrUndefined(this.parent.filterModule) && this.parent.filterModule.filteredResult.length > 0 ? this.parent.getCurrentViewRecords() : this.parent.flatData;\n          childData.forEach(function (record) {\n            if (_this.parent.enableVirtualization) {\n              if (record.hasChildRecords) {\n                _this.updateParentSelection(record);\n              } else {\n                _this.updateSelectedItems(record, record.checkboxState);\n              }\n\n              var child = findChildrenRecords(record);\n              child = _this.getFilteredChildRecords(child);\n\n              for (var i = 0; i < child.length; i++) {\n                if (child[i].hasChildRecords) {\n                  _this.updateParentSelection(child[i]);\n                } else if (!child[i].hasChildRecords && !isNullOrUndefined(child[i])) {\n                  _this.updateSelectedItems(child[i], child[i].checkboxState);\n                }\n              }\n            } else {\n              if (record.hasChildRecords) {\n                _this.updateParentSelection(record);\n              } else {\n                _this.updateSelectedItems(record, record.checkboxState);\n              }\n            }\n          });\n          this.headerSelection();\n        }\n      }\n    }\n  };\n\n  Selection.prototype.getCheckedrecords = function () {\n    return this.selectedItems;\n  };\n\n  Selection.prototype.getCheckedRowIndexes = function () {\n    return this.selectedIndexes;\n  };\n\n  return Selection;\n}();\n\nexport { Selection };","map":{"version":3,"sources":["/Users/tristanbilot/Desktop/Design4green/design4green/node_modules/@syncfusion/ej2-treegrid/src/treegrid/actions/selection.js"],"names":["isNullOrUndefined","removeClass","createCheckBox","parentsUntil","getObject","events","getParentData","isRemoteData","isCheckboxcolumn","findChildrenRecords","Selection","parent","selectedItems","selectedIndexes","filteredList","addEventListener","prototype","getModuleName","on","headerCheckbox","columnCheckbox","updateGridActions","grid","checkboxSelection","removeEventListener","isDestroyed","off","destroy","args","target","checkWrap","checkBox","querySelectorAll","length","querySelector","rowIndex","push","closest","selectCheckboxes","triggerChkChangeEvent","nextElementSibling","classList","contains","autoCheckHierarchy","checkBoxvalue","headerSelection","checkState","rowElement","data","getCurrentViewRecords","checked","rowData","getCheckedRecords","trigger","checkboxChange","getCheckboxcolumnIndex","mappingUid","columnIndex","columns","col","showCheckbox","uid","headerCelllength","getHeaderContent","j","headercell","getAttribute","headerElement","value","rowChkBox","createElement","className","attrs","label","add","insertBefore","cloneNode","firstChild","renderColumnCheckbox","cell","setAttribute","checkboxState","allowTextWrap","style","width","checkbox","container","containerELe","spanEle","innerHTML","divEle","appendChild","rowIndexes","i","record","flatRecord","uniqueID","keys","Object","hasOwnProperty","call","traverSelection","ischildItem","updateSelectedItems","parentItem","updateParentSelection","childRecords","filterModule","filteredResult","getFilteredChildRecords","count","isSummaryRow","hasChildRecords","_this","filteredChildRecords","filter","e","indexOf","parentRecord","indeter","checkChildRecords","currentRecord","checkBoxRecord","checkAll","index","filterResult","filterSettings","flatData","enableVirtualization","rec","checkedRecord","recordIndex","checkboxRecord","tr","getRows","movableTr","frozenRows","getFrozenColumns","getMovableDataRows","splice","checkedIndex","checkBoxclass","requestType","childData","childLength","rows","action","updatedData","forEach","child","getCheckedrecords","getCheckedRowIndexes"],"mappings":"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","sourcesContent":["import { isNullOrUndefined, removeClass } from '@syncfusion/ej2-base';\nimport { createCheckBox } from '@syncfusion/ej2-buttons';\nimport { parentsUntil, getObject } from '@syncfusion/ej2-grids';\nimport * as events from '../base/constant';\nimport { getParentData, isRemoteData, isCheckboxcolumn, findChildrenRecords } from '../utils';\n/**\n * TreeGrid Selection module\n *\n * @hidden\n */\nvar Selection = /** @class */ (function () {\n    /**\n     * Constructor for Selection module\n     *\n     * @param {TreeGrid} parent - Tree Grid instance\n     */\n    function Selection(parent) {\n        this.parent = parent;\n        this.selectedItems = [];\n        this.selectedIndexes = [];\n        this.filteredList = [];\n        this.addEventListener();\n    }\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @private\n     * @returns {string} Returns Selection module name\n     */\n    Selection.prototype.getModuleName = function () {\n        return 'selection';\n    };\n    Selection.prototype.addEventListener = function () {\n        this.parent.on('dataBoundArg', this.headerCheckbox, this);\n        this.parent.on('columnCheckbox', this.columnCheckbox, this);\n        this.parent.on('updateGridActions', this.updateGridActions, this);\n        this.parent.grid.on('colgroup-refresh', this.headerCheckbox, this);\n        this.parent.on('checkboxSelection', this.checkboxSelection, this);\n    };\n    Selection.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off('dataBoundArg', this.headerCheckbox);\n        this.parent.off('columnCheckbox', this.columnCheckbox);\n        this.parent.grid.off('colgroup-refresh', this.headerCheckbox);\n        this.parent.off('checkboxSelection', this.checkboxSelection);\n        this.parent.off('updateGridActions', this.updateGridActions);\n    };\n    /**\n     * To destroy the Selection\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Selection.prototype.destroy = function () {\n        this.removeEventListener();\n    };\n    Selection.prototype.checkboxSelection = function (args) {\n        var target = getObject('target', args);\n        var checkWrap = parentsUntil(target, 'e-checkbox-wrapper');\n        var checkBox;\n        if (checkWrap && checkWrap.querySelectorAll('.e-treecheckselect').length > 0) {\n            checkBox = checkWrap.querySelector('input[type=\"checkbox\"]');\n            var rowIndex = [];\n            rowIndex.push(target.closest('tr').rowIndex);\n            this.selectCheckboxes(rowIndex);\n            this.triggerChkChangeEvent(checkBox, checkBox.nextElementSibling.classList.contains('e-check'), target.closest('tr'));\n        }\n        else if (checkWrap && checkWrap.querySelectorAll('.e-treeselectall').length > 0 && this.parent.autoCheckHierarchy) {\n            var checkBoxvalue = !checkWrap.querySelector('.e-frame').classList.contains('e-check')\n                && !checkWrap.querySelector('.e-frame').classList.contains('e-stop');\n            this.headerSelection(checkBoxvalue);\n            checkBox = checkWrap.querySelector('input[type=\"checkbox\"]');\n            this.triggerChkChangeEvent(checkBox, checkBoxvalue, target.closest('tr'));\n        }\n    };\n    Selection.prototype.triggerChkChangeEvent = function (checkBox, checkState, rowElement) {\n        var data = this.parent.getCurrentViewRecords()[rowElement.rowIndex];\n        var args = { checked: checkState, target: checkBox, rowElement: rowElement,\n            rowData: checkBox.classList.contains('e-treeselectall')\n                ? this.parent.getCheckedRecords() : data };\n        this.parent.trigger(events.checkboxChange, args);\n    };\n    Selection.prototype.getCheckboxcolumnIndex = function () {\n        var mappingUid;\n        var columnIndex;\n        var columns = (this.parent.columns);\n        for (var col = 0; col < columns.length; col++) {\n            if (columns[col].showCheckbox) {\n                mappingUid = this.parent.columns[col].uid;\n            }\n        }\n        var headerCelllength = this.parent.getHeaderContent().querySelectorAll('.e-headercelldiv').length;\n        for (var j = 0; j < headerCelllength; j++) {\n            var headercell = this.parent.getHeaderContent().querySelectorAll('.e-headercelldiv')[j];\n            if (headercell.getAttribute('e-mappinguid') === mappingUid) {\n                columnIndex = j;\n            }\n        }\n        return columnIndex;\n    };\n    Selection.prototype.headerCheckbox = function () {\n        this.columnIndex = this.getCheckboxcolumnIndex();\n        if (this.columnIndex > -1 && this.parent.getHeaderContent().querySelectorAll('.e-treeselectall').length === 0) {\n            var headerElement = this.parent.getHeaderContent().querySelectorAll('.e-headercelldiv')[this.columnIndex];\n            var value = false;\n            var rowChkBox = this.parent.createElement('input', { className: 'e-treeselectall', attrs: { 'type': 'checkbox' } });\n            var checkWrap = createCheckBox(this.parent.createElement, false, { checked: value, label: ' ' });\n            checkWrap.classList.add('e-hierarchycheckbox');\n            checkWrap.insertBefore(rowChkBox.cloneNode(), checkWrap.firstChild);\n            if (!isNullOrUndefined(headerElement)) {\n                headerElement.insertBefore(checkWrap, headerElement.firstChild);\n            }\n            if (this.parent.autoCheckHierarchy) {\n                this.headerSelection();\n            }\n        }\n        else if (this.columnIndex > -1 && this.parent.getHeaderContent().querySelectorAll('.e-treeselectall').length > 0) {\n            var checkWrap = this.parent.getHeaderContent().querySelectorAll('.e-checkbox-wrapper')[0];\n            var checkBoxvalue = checkWrap.querySelector('.e-frame').classList.contains('e-check');\n            if (this.parent.autoCheckHierarchy && checkBoxvalue) {\n                this.headerSelection(checkBoxvalue);\n            }\n        }\n    };\n    Selection.prototype.renderColumnCheckbox = function (args) {\n        var rowChkBox = this.parent.createElement('input', { className: 'e-treecheckselect', attrs: { 'type': 'checkbox' } });\n        var data = args.data;\n        args.cell.classList.add('e-treegridcheckbox');\n        args.cell.setAttribute('aria-label', 'checkbox');\n        var value = (isNullOrUndefined(data.checkboxState) || data.checkboxState === 'uncheck') ? false : true;\n        var checkWrap = createCheckBox(this.parent.createElement, false, { checked: value, label: ' ' });\n        checkWrap.classList.add('e-hierarchycheckbox');\n        if (this.parent.allowTextWrap) {\n            checkWrap.querySelector('.e-frame').style.width = '18px';\n        }\n        if (data.checkboxState === 'indeterminate') {\n            var checkbox = checkWrap.querySelectorAll('.e-frame')[0];\n            removeClass([checkbox], ['e-check', 'e-stop', 'e-uncheck']);\n            checkWrap.querySelector('.e-frame').classList.add('e-stop');\n        }\n        checkWrap.insertBefore(rowChkBox.cloneNode(), checkWrap.firstChild);\n        return checkWrap;\n    };\n    Selection.prototype.columnCheckbox = function (container) {\n        var checkWrap = this.renderColumnCheckbox(container);\n        var containerELe = container.cell.querySelector('.e-treecolumn-container');\n        if (!isNullOrUndefined(containerELe)) {\n            if (!container.cell.querySelector('.e-hierarchycheckbox')) {\n                containerELe.insertBefore(checkWrap, containerELe.querySelectorAll('.e-treecell')[0]);\n            }\n        }\n        else {\n            var spanEle = this.parent.createElement('span', { className: 'e-treecheckbox' });\n            var data = container.cell.innerHTML;\n            container.cell.innerHTML = '';\n            spanEle.innerHTML = data;\n            var divEle = this.parent.createElement('div', { className: 'e-treecheckbox-container' });\n            divEle.appendChild(checkWrap);\n            divEle.appendChild(spanEle);\n            container.cell.appendChild(divEle);\n        }\n    };\n    Selection.prototype.selectCheckboxes = function (rowIndexes) {\n        for (var i = 0; i < rowIndexes.length; i++) {\n            var record = this.parent.getCurrentViewRecords()[rowIndexes[i]];\n            var flatRecord = getParentData(this.parent, record.uniqueID);\n            record = flatRecord;\n            var checkboxState = (record.checkboxState === 'uncheck') ? 'check' : 'uncheck';\n            record.checkboxState = checkboxState;\n            var keys = Object.keys(record);\n            for (var j = 0; j < keys.length; j++) {\n                if (Object.prototype.hasOwnProperty.call(flatRecord, keys[j])) {\n                    flatRecord[keys[j]] = record[keys[j]];\n                }\n            }\n            this.traverSelection(record, checkboxState, false);\n            if (this.parent.autoCheckHierarchy) {\n                this.headerSelection();\n            }\n        }\n    };\n    Selection.prototype.traverSelection = function (record, checkboxState, ischildItem) {\n        var length = 0;\n        this.updateSelectedItems(record, checkboxState);\n        if (!ischildItem && record.parentItem && this.parent.autoCheckHierarchy) {\n            this.updateParentSelection(record.parentItem);\n        }\n        if (record.childRecords && this.parent.autoCheckHierarchy) {\n            var childRecords = record.childRecords;\n            if (!isNullOrUndefined(this.parent.filterModule) &&\n                this.parent.filterModule.filteredResult.length > 0 && this.parent.autoCheckHierarchy) {\n                childRecords = this.getFilteredChildRecords(childRecords);\n            }\n            length = childRecords.length;\n            for (var count = 0; count < length; count++) {\n                if (!childRecords[count].isSummaryRow) {\n                    if (childRecords[count].hasChildRecords) {\n                        this.traverSelection(childRecords[count], checkboxState, true);\n                    }\n                    else {\n                        this.updateSelectedItems(childRecords[count], checkboxState);\n                    }\n                }\n            }\n        }\n    };\n    Selection.prototype.getFilteredChildRecords = function (childRecords) {\n        var _this = this;\n        var filteredChildRecords = childRecords.filter(function (e) {\n            return _this.parent.filterModule.filteredResult.indexOf(e) > -1;\n        });\n        return filteredChildRecords;\n    };\n    Selection.prototype.updateParentSelection = function (parentRecord) {\n        var length = 0;\n        var childRecords = [];\n        var record = getParentData(this.parent, parentRecord.uniqueID);\n        if (record && record.childRecords) {\n            childRecords = record.childRecords;\n        }\n        if (!isNullOrUndefined(this.parent.filterModule) &&\n            this.parent.filterModule.filteredResult.length > 0 && this.parent.autoCheckHierarchy) {\n            childRecords = this.getFilteredChildRecords(childRecords);\n        }\n        length = childRecords && childRecords.length;\n        var indeter = 0;\n        var checkChildRecords = 0;\n        if (!isNullOrUndefined(record)) {\n            for (var i = 0; i < childRecords.length; i++) {\n                var currentRecord = getParentData(this.parent, childRecords[i].uniqueID);\n                var checkBoxRecord = currentRecord;\n                if (!isNullOrUndefined(checkBoxRecord)) {\n                    if (checkBoxRecord.checkboxState === 'indeterminate') {\n                        indeter++;\n                    }\n                    else if (checkBoxRecord.checkboxState === 'check') {\n                        checkChildRecords++;\n                    }\n                }\n            }\n            if (indeter > 0 || (checkChildRecords > 0 && checkChildRecords !== length)) {\n                record.checkboxState = 'indeterminate';\n            }\n            else if (checkChildRecords === 0 && indeter === 0) {\n                record.checkboxState = 'uncheck';\n            }\n            else {\n                record.checkboxState = 'check';\n            }\n            this.updateSelectedItems(record, record.checkboxState);\n            if (record.parentItem) {\n                this.updateParentSelection(record.parentItem);\n            }\n        }\n    };\n    Selection.prototype.headerSelection = function (checkAll) {\n        var _this = this;\n        var index = -1;\n        var length = 0;\n        if (!isNullOrUndefined(this.parent.filterModule) && this.parent.filterModule.filteredResult.length > 0) {\n            var filterResult = this.parent.filterModule.filteredResult;\n            if (this.filteredList.length === 0) {\n                this.filteredList = filterResult;\n            }\n            else {\n                if (this.filteredList !== filterResult) {\n                    this.filteredList = filterResult;\n                }\n            }\n        }\n        if (this.filteredList.length > 0) {\n            if (!this.parent.filterSettings.columns.length && this.filteredList.length) {\n                this.filteredList = [];\n            }\n        }\n        var data = (!isNullOrUndefined(this.parent.filterModule) &&\n            (this.filteredList.length > 0)) ? this.filteredList :\n            this.parent.flatData;\n        data = isRemoteData(this.parent) ? this.parent.getCurrentViewRecords() : data;\n        if (!isNullOrUndefined(checkAll)) {\n            for (var i = 0; i < data.length; i++) {\n                if (checkAll) {\n                    if (data[i].checkboxState === 'check') {\n                        continue;\n                    }\n                    data[i].checkboxState = 'check';\n                    this.updateSelectedItems(data[i], data[i].checkboxState);\n                }\n                else {\n                    index = this.selectedItems.indexOf(data[i]);\n                    if (index > -1) {\n                        data[i].checkboxState = 'uncheck';\n                        this.updateSelectedItems(data[i], data[i].checkboxState);\n                        if (this.parent.autoCheckHierarchy) {\n                            this.updateParentSelection(data[i]);\n                        }\n                    }\n                }\n            }\n        }\n        if (checkAll === false && this.parent.enableVirtualization) {\n            this.selectedItems = [];\n            this.selectedIndexes = [];\n            data.filter(function (rec) {\n                rec.checkboxState = 'uncheck';\n                _this.updateSelectedItems(rec, rec.checkboxState);\n            });\n        }\n        length = this.selectedItems.length;\n        var checkbox = this.parent.getHeaderContent().querySelectorAll('.e-frame')[0];\n        if (length > 0 && data.length > 0) {\n            if (length !== data.length && !checkAll) {\n                removeClass([checkbox], ['e-check']);\n                checkbox.classList.add('e-stop');\n            }\n            else {\n                removeClass([checkbox], ['e-stop']);\n                checkbox.classList.add('e-check');\n            }\n        }\n        else {\n            removeClass([checkbox], ['e-check', 'e-stop']);\n        }\n    };\n    Selection.prototype.updateSelectedItems = function (currentRecord, checkState) {\n        var record = this.parent.getCurrentViewRecords().filter(function (e) {\n            return e.uniqueID === currentRecord.uniqueID;\n        });\n        var checkedRecord;\n        var recordIndex = this.parent.getCurrentViewRecords().indexOf(record[0]);\n        var checkboxRecord = getParentData(this.parent, currentRecord.uniqueID);\n        var checkbox;\n        if (recordIndex > -1) {\n            var tr = this.parent.getRows()[recordIndex];\n            var movableTr = void 0;\n            if (this.parent.frozenRows || this.parent.getFrozenColumns()) {\n                movableTr = this.parent.getMovableDataRows()[recordIndex];\n            }\n            checkbox = tr.querySelectorAll('.e-frame')[0] ? tr.querySelectorAll('.e-frame')[0]\n                : movableTr.querySelectorAll('.e-frame')[0];\n            if (!isNullOrUndefined(checkbox)) {\n                removeClass([checkbox], ['e-check', 'e-stop', 'e-uncheck']);\n            }\n        }\n        checkedRecord = checkboxRecord;\n        if (isNullOrUndefined(checkedRecord)) {\n            checkedRecord = currentRecord;\n        }\n        checkedRecord.checkboxState = checkState;\n        if (checkState === 'check' && isNullOrUndefined(currentRecord.isSummaryRow)) {\n            if (recordIndex !== -1 && this.selectedIndexes.indexOf(recordIndex) === -1) {\n                this.selectedIndexes.push(recordIndex);\n            }\n            if (this.selectedItems.indexOf(checkedRecord) === -1 && (recordIndex !== -1 &&\n                (!isNullOrUndefined(this.parent.filterModule) && this.parent.filterModule.filteredResult.length > 0))) {\n                this.selectedItems.push(checkedRecord);\n            }\n            if (this.selectedItems.indexOf(checkedRecord) === -1 && this.parent.enableVirtualization && ((!isNullOrUndefined(this.parent.filterModule) && this.parent.filterModule.filteredResult.length > 0))) {\n                this.selectedItems.push(checkedRecord);\n            }\n            if (this.selectedItems.indexOf(checkedRecord) === -1 && (!isNullOrUndefined(this.parent.filterModule) &&\n                this.parent.filterModule.filteredResult.length === 0)) {\n                this.selectedItems.push(checkedRecord);\n            }\n            if (this.selectedItems.indexOf(checkedRecord) === -1 && isNullOrUndefined(this.parent.filterModule)) {\n                this.selectedItems.push(checkedRecord);\n            }\n        }\n        else if ((checkState === 'uncheck' || checkState === 'indeterminate') && isNullOrUndefined(currentRecord.isSummaryRow)) {\n            var index = this.selectedItems.indexOf(checkedRecord);\n            if (index !== -1) {\n                this.selectedItems.splice(index, 1);\n            }\n            if (this.selectedIndexes.indexOf(recordIndex) !== -1) {\n                var checkedIndex = this.selectedIndexes.indexOf(recordIndex);\n                this.selectedIndexes.splice(checkedIndex, 1);\n            }\n        }\n        var checkBoxclass = checkState === 'indeterminate' ? 'e-stop' : 'e-' + checkState;\n        if (recordIndex > -1) {\n            if (!isNullOrUndefined(checkbox)) {\n                checkbox.classList.add(checkBoxclass);\n            }\n        }\n    };\n    Selection.prototype.updateGridActions = function (args) {\n        var _this = this;\n        var requestType = args.requestType;\n        var childData;\n        var childLength;\n        if (isCheckboxcolumn(this.parent)) {\n            if (this.parent.autoCheckHierarchy) {\n                if ((requestType === 'sorting' || requestType === 'paging')) {\n                    var rows = this.parent.grid.getRows();\n                    childData = this.parent.getCurrentViewRecords();\n                    childLength = childData.length;\n                    this.selectedIndexes = [];\n                    for (var i = 0; i < childLength; i++) {\n                        if (!rows[i].classList.contains('e-summaryrow')) {\n                            this.updateSelectedItems(childData[i], childData[i].checkboxState);\n                        }\n                    }\n                }\n                else if (requestType === 'delete' || args.action === 'add') {\n                    var updatedData = [];\n                    if (requestType === 'delete') {\n                        updatedData = args.data;\n                    }\n                    else {\n                        updatedData.push(args.data);\n                    }\n                    for (var i = 0; i < updatedData.length; i++) {\n                        if (requestType === 'delete') {\n                            var index = this.parent.flatData.indexOf(updatedData[i]);\n                            var checkedIndex = this.selectedIndexes.indexOf(index);\n                            this.selectedIndexes.splice(checkedIndex, 1);\n                            this.updateSelectedItems(updatedData[i], 'uncheck');\n                        }\n                        if (!isNullOrUndefined(updatedData[i].parentItem)) {\n                            this.updateParentSelection(updatedData[i].parentItem);\n                        }\n                    }\n                }\n                else if (args.requestType === 'add' && this.parent.autoCheckHierarchy) {\n                    args.data.checkboxState = 'uncheck';\n                }\n                else if (requestType === 'filtering' || requestType === 'searching' || requestType === 'refresh'\n                    && !isRemoteData(this.parent)) {\n                    this.selectedItems = [];\n                    this.selectedIndexes = [];\n                    childData = (!isNullOrUndefined(this.parent.filterModule) && this.parent.filterModule.filteredResult.length > 0) ?\n                        this.parent.getCurrentViewRecords() : this.parent.flatData;\n                    childData.forEach(function (record) {\n                        if (_this.parent.enableVirtualization) {\n                            if (record.hasChildRecords) {\n                                _this.updateParentSelection(record);\n                            }\n                            else {\n                                _this.updateSelectedItems(record, record.checkboxState);\n                            }\n                            var child = findChildrenRecords(record);\n                            child = _this.getFilteredChildRecords(child);\n                            for (var i = 0; i < child.length; i++) {\n                                if (child[i].hasChildRecords) {\n                                    _this.updateParentSelection(child[i]);\n                                }\n                                else if (!(child[i].hasChildRecords) && !isNullOrUndefined(child[i])) {\n                                    _this.updateSelectedItems(child[i], child[i].checkboxState);\n                                }\n                            }\n                        }\n                        else {\n                            if (record.hasChildRecords) {\n                                _this.updateParentSelection(record);\n                            }\n                            else {\n                                _this.updateSelectedItems(record, record.checkboxState);\n                            }\n                        }\n                    });\n                    this.headerSelection();\n                }\n            }\n        }\n    };\n    Selection.prototype.getCheckedrecords = function () {\n        return this.selectedItems;\n    };\n    Selection.prototype.getCheckedRowIndexes = function () {\n        return this.selectedIndexes;\n    };\n    return Selection;\n}());\nexport { Selection };\n"]},"metadata":{},"sourceType":"module"}