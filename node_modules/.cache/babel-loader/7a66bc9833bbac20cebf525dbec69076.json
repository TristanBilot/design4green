{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport { createElement, isNullOrUndefined, getValue, addClass, removeClass, extend } from '@syncfusion/ej2-base';\nimport * as cls from '../base/css-constants';\nimport { DataUtil } from '@syncfusion/ej2-data';\n/**\n * Configures the `Timeline` of the gantt.\n */\n\nvar Timeline =\n/** @class */\nfunction () {\n  function Timeline(ganttObj) {\n    this.isZoomIn = false;\n    this.isZooming = false;\n    this.isZoomToFit = false;\n    this.topTierCollection = [];\n    this.bottomTierCollection = [];\n    this.parent = ganttObj;\n    this.initProperties();\n  }\n  /**\n   * To initialize the public property.\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  Timeline.prototype.initProperties = function () {\n    this.timelineStartDate = null;\n    this.timelineEndDate = null;\n    this.totalTimelineWidth = 0;\n    this.customTimelineSettings = null;\n    this.parent.isTimelineRoundOff = this.isZoomToFit ? false : isNullOrUndefined(this.parent.projectStartDate) ? true : false;\n  };\n  /**\n   * To render timeline header series.\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  Timeline.prototype.validateTimelineProp = function () {\n    this.roundOffDays();\n    this.processTimelineProperty();\n    this.timelineWidthCalculation();\n  };\n  /**\n   * Function used to refresh Gantt rows.\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  Timeline.prototype.refreshTimeline = function () {\n    this.initProperties();\n    this.processTimelineUnit();\n    this.parent.dataOperation.calculateProjectDates();\n\n    if (!this.parent.isFromOnPropertyChange) {\n      this.parent.updateProjectDates(this.parent.cloneProjectStartDate, this.parent.cloneProjectEndDate, this.parent.isTimelineRoundOff);\n    }\n  };\n  /**\n   * Function used to refresh Gantt rows.\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  Timeline.prototype.refreshTimelineByTimeSpan = function () {\n    this.validateTimelineProp();\n    this.parent.ganttChartModule.chartTimelineContainer.innerHTML = '';\n    this.createTimelineSeries();\n  };\n  /**\n   * Function used to refresh Gantt rows.\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  Timeline.prototype.updateChartByNewTimeline = function () {\n    this.parent.chartRowsModule.refreshChartByTimeline();\n    this.parent.notify('refreshDayMarkers', {});\n  };\n  /**\n   * Function used to perform Zoomin and Zoomout actions in Gantt control.\n   *\n   * @param {boolean} isZoomIn .\n   * @private\n   * @returns {void}\n   */\n\n\n  Timeline.prototype.processZooming = function (isZoomIn) {\n    this.isZoomToFit = false;\n\n    if (!isNullOrUndefined(this.parent.zoomingProjectStartDate)) {\n      this.parent.cloneProjectStartDate = this.parent.cloneProjectStartDate.getTime() < this.parent.zoomingProjectStartDate.getTime() ? this.parent.cloneProjectStartDate : this.parent.zoomingProjectStartDate;\n      this.parent.cloneProjectEndDate = this.parent.cloneProjectEndDate.getTime() > this.parent.zoomingProjectEndDate.getTime() ? this.parent.cloneProjectEndDate : this.parent.zoomingProjectEndDate;\n    }\n\n    this.parent.zoomingProjectStartDate = null;\n    this.parent.zoomingProjectEndDate = null;\n    var currentZoomingLevel = this.checkCurrentZoomingLevel();\n    this.isZoomIn = isZoomIn;\n    this.isZooming = true;\n    var currentLevel = isZoomIn ? currentZoomingLevel + 1 : currentZoomingLevel - 1;\n\n    if (this.parent.toolbarModule) {\n      if (isZoomIn) {\n        if (currentLevel === this.parent.zoomingLevels[this.parent.zoomingLevels.length - 1].level) {\n          this.parent.toolbarModule.enableItems([this.parent.controlId + '_zoomin'], false); // disable toolbar items.\n        } else {\n          this.parent.toolbarModule.enableItems([this.parent.controlId + '_zoomout'], true); // disable toolbar items.\n        }\n      } else {\n        if (currentLevel === this.parent.zoomingLevels[0].level) {\n          this.parent.toolbarModule.enableItems([this.parent.controlId + '_zoomout'], false); // disable toolbar items.\n        } else {\n          this.parent.toolbarModule.enableItems([this.parent.controlId + '_zoomin'], true); // enable toolbar items.\n        }\n      }\n    }\n\n    var newTimeline = this.parent.zoomingLevels[currentLevel];\n    var args = {\n      requestType: isZoomIn ? 'beforeZoomIn' : 'beforeZoomOut',\n      timeline: newTimeline,\n      cancel: false\n    };\n    this.parent.trigger('actionBegin', args);\n\n    if (!args.cancel) {\n      newTimeline = args.timeline;\n      this.changeTimelineSettings(newTimeline);\n    }\n  };\n  /**\n   * To change the timeline settings property values based upon the Zooming levels.\n   *\n   * @param {ZoomTimelineSettings} newTimeline .\n   * @returns {void}\n   * @private\n   */\n\n\n  Timeline.prototype.changeTimelineSettings = function (newTimeline) {\n    var _this = this;\n\n    var skipProperty = this.isSingleTier ? this.customTimelineSettings.topTier.unit === 'None' ? 'topTier' : 'bottomTier' : null;\n    Object.keys(this.customTimelineSettings).forEach(function (property) {\n      if (property !== skipProperty) {\n        _this.customTimelineSettings[property] = typeof newTimeline[property] === 'object' && !isNullOrUndefined(newTimeline[property]) ? __assign({}, newTimeline[property]) : newTimeline[property];\n      } else {\n        var value = property === 'topTier' ? 'bottomTier' : 'topTier';\n        var assignValue = 'bottomTier';\n        _this.customTimelineSettings[value] = __assign({}, newTimeline[assignValue]);\n      }\n    });\n    this.parent.isTimelineRoundOff = this.isZoomToFit ? false : isNullOrUndefined(this.parent.projectStartDate) ? true : false;\n    this.processTimelineUnit();\n    this.parent.updateProjectDates(this.parent.cloneProjectStartDate, this.parent.cloneProjectEndDate, this.parent.isTimelineRoundOff);\n\n    if (this.isZooming || this.isZoomToFit) {\n      var args = {\n        requestType: this.isZoomIn ? 'AfterZoomIn' : this.isZoomToFit ? 'AfterZoomToProject' : 'AfterZoomOut',\n        timeline: this.parent.currentZoomingLevel\n      };\n      this.parent.trigger('actionComplete', args);\n    }\n  };\n  /**\n   * To perform the zoom to fit operation in Gantt.\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  Timeline.prototype.processZoomToFit = function () {\n    this.isZoomToFit = true;\n    this.isZooming = false;\n\n    if (!this.parent.zoomingProjectStartDate) {\n      this.parent.zoomingProjectStartDate = this.parent.cloneProjectStartDate;\n      this.parent.zoomingProjectEndDate = this.parent.cloneProjectEndDate;\n    }\n\n    this.parent.dataOperation.calculateProjectDates();\n    var timeDifference = this.parent.cloneProjectEndDate.getTime() - this.parent.cloneProjectStartDate.getTime();\n    var totalDays = timeDifference / (1000 * 3600 * 24);\n    var chartWidth = this.parent.ganttChartModule.chartElement.offsetWidth;\n    var perDayWidth = chartWidth / totalDays;\n    var zoomingLevel;\n    var firstValue;\n    var secondValue;\n    var zoomingCollections = this.parent.zoomingLevels.slice();\n    var sortedCollectons = zoomingCollections.sort(function (a, b) {\n      return a.perDayWidth < b.perDayWidth ? 1 : -1;\n    });\n\n    if (perDayWidth === 0) {\n      // return when the Gantt chart is not in viewable state.\n      return;\n    }\n\n    for (var i = 0; i < sortedCollectons.length; i++) {\n      firstValue = sortedCollectons[i];\n\n      if (i === sortedCollectons.length - 1) {\n        zoomingLevel = sortedCollectons[i];\n        break;\n      } else {\n        secondValue = sortedCollectons[i + 1];\n      }\n\n      if (perDayWidth >= firstValue.perDayWidth) {\n        zoomingLevel = sortedCollectons[i];\n        break;\n      }\n\n      if (perDayWidth < firstValue.perDayWidth && perDayWidth > secondValue.perDayWidth) {\n        zoomingLevel = sortedCollectons[i + 1];\n        break;\n      }\n    }\n\n    var newTimeline = extend({}, {}, zoomingLevel, true);\n    this.roundOffDateToZoom(this.parent.cloneProjectStartDate, true, perDayWidth, newTimeline.bottomTier.unit);\n    this.roundOffDateToZoom(this.parent.cloneProjectEndDate, false, perDayWidth, newTimeline.bottomTier.unit);\n    var numberOfCells = this.calculateNumberOfTimelineCells(newTimeline);\n    var scrollHeight = this.parent.ganttChartModule.scrollElement.offsetHeight - 17; //17 is horizontal scrollbar width\n\n    var contentHeight = this.parent.ganttChartModule.chartBodyContent.offsetHeight;\n    var emptySpace = contentHeight <= scrollHeight ? 0 : 17;\n    newTimeline.timelineUnitSize = Math.abs(chartWidth - emptySpace) / numberOfCells;\n    var args = {\n      requestType: 'beforeZoomToProject',\n      timeline: newTimeline\n    };\n\n    if (this.parent.toolbarModule) {\n      this.parent.toolbarModule.enableItems([this.parent.controlId + '_zoomin', this.parent.controlId + '_zoomout'], true);\n    }\n\n    this.parent.trigger('actionBegin', args);\n    this.changeTimelineSettings(newTimeline);\n  };\n\n  Timeline.prototype.roundOffDateToZoom = function (date, isStartDate, perDayWidth, tierMode) {\n    var width = tierMode === 'Month' || tierMode === 'Year' ? 60 : 20;\n    var roundOffTime = width / perDayWidth * (24 * 60 * 60 * 1000);\n\n    if (isStartDate) {\n      date.setTime(date.getTime() - roundOffTime);\n    } else {\n      date.setTime(date.getTime() + roundOffTime);\n    }\n\n    if (tierMode === 'Hour') {\n      date.setMinutes(isStartDate ? -120 : 120);\n    } else if (tierMode === 'Minutes') {\n      date.setSeconds(isStartDate ? -120 : 120);\n    } else {\n      date.setHours(isStartDate ? -48 : 48, 0, 0, 0);\n    }\n  };\n\n  Timeline.prototype.calculateNumberOfTimelineCells = function (newTimeline) {\n    var numberOfDays = Math.abs((this.parent.cloneProjectEndDate.getTime() - this.parent.cloneProjectStartDate.getTime()) / (24 * 60 * 60 * 1000));\n    var count = newTimeline.bottomTier.count;\n    var unit = newTimeline.bottomTier.unit;\n\n    if (unit === 'Day') {\n      return numberOfDays / count;\n    } else if (unit === 'Week') {\n      return numberOfDays / count / 7;\n    } else if (unit === 'Month') {\n      return numberOfDays / count / 28;\n    } else if (unit === 'Year') {\n      return numberOfDays / count / (12 * 28);\n    } else if (unit === 'Hour') {\n      return numberOfDays * (24 / count);\n    } else {\n      return numberOfDays * (60 * 24 / count);\n    }\n  };\n  /**\n   * To validate time line unit.\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  Timeline.prototype.processTimelineUnit = function () {\n    var directProperty = ['timelineViewMode', 'timelineUnitSize', 'weekStartDay', 'weekendBackground'];\n    var innerProperty = {\n      'topTier': ['unit', 'format', 'count', 'formatter'],\n      'bottomTier': ['unit', 'format', 'count', 'formatter']\n    };\n    var tierUnits = ['Year', 'Month', 'Week', 'Day', 'Hour', 'Minutes'];\n    this.customTimelineSettings = this.customTimelineSettings ? this.customTimelineSettings : this.extendFunction(this.parent.timelineSettings, directProperty, innerProperty);\n\n    if (tierUnits.indexOf(this.customTimelineSettings.topTier.unit) === -1 && tierUnits.indexOf(this.customTimelineSettings.bottomTier.unit) === -1) {\n      this.customTimelineSettings.topTier.unit = tierUnits.indexOf(this.customTimelineSettings.timelineViewMode) !== -1 ? this.customTimelineSettings.timelineViewMode : 'Week';\n      this.customTimelineSettings.bottomTier.unit = tierUnits.indexOf(this.customTimelineSettings.topTier.unit) !== 5 ? tierUnits[tierUnits.indexOf(this.customTimelineSettings.topTier.unit) + 1] : 'None';\n    } else if (tierUnits.indexOf(this.customTimelineSettings.topTier.unit) !== -1 && tierUnits.indexOf(this.customTimelineSettings.bottomTier.unit) !== -1 && tierUnits.indexOf(this.customTimelineSettings.topTier.unit) > tierUnits.indexOf(this.customTimelineSettings.bottomTier.unit)) {\n      this.customTimelineSettings.bottomTier.unit = this.customTimelineSettings.topTier.unit;\n    } else {\n      this.customTimelineSettings.topTier.unit = tierUnits.indexOf(this.customTimelineSettings.topTier.unit) === -1 ? 'None' : this.customTimelineSettings.topTier.unit;\n      this.customTimelineSettings.bottomTier.unit = tierUnits.indexOf(this.customTimelineSettings.bottomTier.unit) === -1 ? 'None' : this.customTimelineSettings.bottomTier.unit;\n    }\n\n    this.topTier = this.customTimelineSettings.topTier.unit;\n    this.bottomTier = this.customTimelineSettings.bottomTier.unit;\n    this.previousIsSingleTier = this.isSingleTier;\n    this.isSingleTier = this.topTier === 'None' || this.bottomTier === 'None' ? true : false;\n  };\n  /**\n   * To validate timeline properties.\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  Timeline.prototype.processTimelineProperty = function () {\n    this.customTimelineSettings.topTier.count = this.topTier === 'None' ? 1 : this.validateCount(this.customTimelineSettings.topTier.unit, this.customTimelineSettings.topTier.count, 'topTier');\n    this.customTimelineSettings.bottomTier.count = this.customTimelineSettings.bottomTier.unit === 'None' ? 1 : this.validateCount(this.customTimelineSettings.bottomTier.unit, this.customTimelineSettings.bottomTier.count, 'bottomTier');\n    this.customTimelineSettings.bottomTier.format = this.validateFormat(this.customTimelineSettings.bottomTier.unit, this.customTimelineSettings.bottomTier.format);\n    this.customTimelineSettings.topTier.format = this.validateFormat(this.topTier, this.customTimelineSettings.topTier.format);\n    this.customTimelineSettings.weekStartDay = this.customTimelineSettings.weekStartDay >= 0 && this.customTimelineSettings.weekStartDay <= 6 ? this.customTimelineSettings.weekStartDay : 0;\n    this.checkCurrentZoomingLevel();\n  };\n  /**\n   * To find the current zooming level of the Gantt control.\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  Timeline.prototype.calculateZoomingLevelsPerDayWidth = function () {\n    var collections = this.parent.zoomingLevels;\n\n    for (var i = 0; i < collections.length; i++) {\n      var perDayWidth = this.getPerDayWidth(collections[i].timelineUnitSize, collections[i].bottomTier.count, collections[i].bottomTier.unit);\n      collections[i].perDayWidth = perDayWidth;\n    }\n  };\n  /**\n   * To find the current zooming level of the Gantt control.\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  Timeline.prototype.checkCurrentZoomingLevel = function () {\n    var count = this.customTimelineSettings.bottomTier.unit !== 'None' ? this.customTimelineSettings.bottomTier.count : this.customTimelineSettings.topTier.count;\n    var unit = this.customTimelineSettings.bottomTier.unit !== 'None' ? this.customTimelineSettings.bottomTier.unit : this.customTimelineSettings.topTier.unit;\n    var zoomLevel = this.getCurrentZoomingLevel(unit, count);\n\n    if (this.parent.toolbarModule) {\n      if (zoomLevel === this.parent.zoomingLevels[this.parent.zoomingLevels.length - 1].level) {\n        this.parent.toolbarModule.enableItems([this.parent.controlId + '_zoomin'], false);\n      } else if (zoomLevel === this.parent.zoomingLevels[0].level) {\n        this.parent.toolbarModule.enableItems([this.parent.controlId + '_zoomout'], false);\n      }\n    }\n\n    this.parent.currentZoomingLevel = this.parent.zoomingLevels[zoomLevel];\n    return zoomLevel;\n  };\n  /**\n   * @param {string} unit .\n   * @param {number} count .\n   * @returns {number} .\n   * @private\n   */\n\n\n  Timeline.prototype.getCurrentZoomingLevel = function (unit, count) {\n    var level;\n    var currentZoomCollection;\n    var checkSameCountLevels;\n    var secondValue;\n    var firstValue;\n\n    if (!this.parent.zoomingLevels.length) {\n      this.parent.zoomingLevels = this.parent.getZoomingLevels();\n    }\n\n    var sameUnitLevels = this.parent.zoomingLevels.filter(function (tempLevel) {\n      return tempLevel.bottomTier.unit === unit;\n    });\n\n    if (sameUnitLevels.length === 0) {\n      var closestUnit_1 = this.getClosestUnit(unit, '', false);\n      sameUnitLevels = this.parent.zoomingLevels.filter(function (tempLevel) {\n        return tempLevel.bottomTier.unit === closestUnit_1;\n      });\n    }\n\n    var sortedUnitLevels = sameUnitLevels.sort(function (a, b) {\n      return a.bottomTier.count < b.bottomTier.count ? 1 : -1;\n    });\n\n    for (var i = 0; i < sortedUnitLevels.length; i++) {\n      firstValue = sortedUnitLevels[i];\n\n      if (i === sortedUnitLevels.length - 1) {\n        level = sortedUnitLevels[i].level;\n        break;\n      } else {\n        secondValue = sortedUnitLevels[i + 1];\n      }\n\n      if (count >= firstValue.bottomTier.count) {\n        currentZoomCollection = sortedUnitLevels[i];\n        checkSameCountLevels = sortedUnitLevels.filter(function (tempLevel) {\n          return tempLevel.bottomTier.count === currentZoomCollection.bottomTier.count;\n        });\n\n        if (checkSameCountLevels.length > 1) {\n          level = this.checkCollectionsWidth(checkSameCountLevels);\n        } else {\n          level = checkSameCountLevels[0].level;\n        }\n\n        break;\n      } else if (count < firstValue.bottomTier.count && count > secondValue.bottomTier.count) {\n        currentZoomCollection = sortedUnitLevels[i + 1];\n        checkSameCountLevels = sortedUnitLevels.filter(function (tempLevel) {\n          return tempLevel.bottomTier.count === currentZoomCollection.bottomTier.count;\n        });\n\n        if (checkSameCountLevels.length > 1) {\n          level = this.checkCollectionsWidth(checkSameCountLevels);\n        } else {\n          level = checkSameCountLevels[0].level;\n        }\n\n        break;\n      }\n    }\n\n    return level;\n  };\n  /**\n   * Getting closest zooimg level.\n   *\n   * @param {string} unit .\n   * @param {string} closetUnit .\n   * @param {boolean} isCont .\n   * @returns {string} .\n   * @private\n   */\n\n\n  Timeline.prototype.getClosestUnit = function (unit, closetUnit, isCont) {\n    var bottomTierUnits = ['Year', 'Month', 'Week', 'Day', 'Hour', 'Minutes'];\n    var index = bottomTierUnits.indexOf(unit);\n\n    if (index === 0) {\n      isCont = true;\n    }\n\n    if (this.isZoomIn || isCont) {\n      unit = bottomTierUnits[index + 1];\n    } else {\n      unit = bottomTierUnits[index - 1];\n    }\n\n    var sameUnitLevels = this.parent.zoomingLevels.filter(function (tempLevel) {\n      return tempLevel.bottomTier.unit === unit;\n    });\n\n    if (sameUnitLevels.length === 0) {\n      if (unit === 'Year') {\n        isCont = true;\n      }\n\n      closetUnit = unit;\n      return this.getClosestUnit(unit, closetUnit, isCont);\n    } else {\n      return unit;\n    }\n  };\n\n  Timeline.prototype.checkCollectionsWidth = function (checkSameLevels) {\n    var zoomLevels = checkSameLevels;\n    var width = this.customTimelineSettings.timelineUnitSize;\n    var level;\n    var secondValue;\n    var firstValue;\n    var sortedZoomLevels = zoomLevels.sort(function (a, b) {\n      return a.timelineUnitSize < b.timelineUnitSize ? 1 : -1;\n    });\n\n    for (var i = 0; i < sortedZoomLevels.length; i++) {\n      firstValue = sortedZoomLevels[i];\n\n      if (i === sortedZoomLevels.length - 1) {\n        level = sortedZoomLevels[i].level;\n        break;\n      } else {\n        secondValue = sortedZoomLevels[i + 1];\n      }\n\n      if (width >= firstValue.timelineUnitSize) {\n        level = sortedZoomLevels[i].level;\n        break;\n      } else if (width < firstValue.timelineUnitSize && width > secondValue.timelineUnitSize) {\n        level = sortedZoomLevels[i + 1].level;\n        break;\n      }\n    }\n\n    return level;\n  };\n  /**\n   * To create timeline header template.\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  Timeline.prototype.updateTimelineHeaderHeight = function () {\n    if (this.parent.timelineModule.isSingleTier) {\n      addClass([this.parent.ganttChartModule.chartTimelineContainer], cls.timelineSingleHeaderOuterDiv);\n\n      if (this.parent.treeGrid.element) {\n        addClass(this.parent.treeGrid.element.querySelectorAll('.e-headercell'), cls.timelineSingleHeaderOuterDiv);\n        addClass(this.parent.treeGrid.element.querySelectorAll('.e-columnheader'), cls.timelineSingleHeaderOuterDiv);\n      }\n    } else {\n      removeClass([this.parent.ganttChartModule.chartTimelineContainer], cls.timelineSingleHeaderOuterDiv);\n\n      if (this.parent.treeGrid.element) {\n        removeClass(this.parent.treeGrid.element.querySelectorAll('.e-headercell'), cls.timelineSingleHeaderOuterDiv);\n        removeClass(this.parent.treeGrid.element.querySelectorAll('.e-columnheader'), cls.timelineSingleHeaderOuterDiv);\n      }\n    }\n\n    if (this.previousIsSingleTier !== this.isSingleTier) {\n      var toolbarHeight = 0;\n\n      if (!isNullOrUndefined(this.parent.toolbarModule) && !isNullOrUndefined(this.parent.toolbarModule.element)) {\n        toolbarHeight = this.parent.toolbarModule.element.offsetHeight;\n      }\n\n      this.parent.ganttChartModule.scrollObject.setHeight(this.parent.ganttHeight - this.parent.ganttChartModule.chartTimelineContainer.offsetHeight - toolbarHeight);\n      this.parent.treeGrid.height = this.parent.ganttHeight - toolbarHeight - this.parent.ganttChartModule.chartTimelineContainer.offsetHeight;\n    }\n  };\n  /**\n   * To create timeline header template.\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  Timeline.prototype.createTimelineSeries = function () {\n    var tr;\n    var td;\n    var div;\n    var table;\n    var thead;\n    var loopCount = this.isSingleTier ? 1 : 2;\n    var tier = this.topTier === 'None' ? 'bottomTier' : 'topTier';\n    this.updateTimelineHeaderHeight();\n    this.topTierCollection = [];\n    this.bottomTierCollection = [];\n\n    for (var count = 0; count < loopCount; count++) {\n      table = createElement('table', {\n        className: cls.timelineHeaderTableContainer,\n        styles: 'display: block;'\n      });\n      thead = createElement('thead', {\n        className: cls.timelineHeaderTableBody,\n        styles: 'display:block; border-collapse:collapse'\n      });\n      tr = createElement('tr', {\n        innerHTML: this.createTimelineTemplate(tier)\n      });\n      td = createElement('th');\n      div = createElement('div', {\n        styles: 'width: 20px'\n      });\n      td.appendChild(div);\n      tr.appendChild(td);\n      thead.appendChild(tr);\n      table.appendChild(thead);\n      this.parent.ganttChartModule.chartTimelineContainer.appendChild(table);\n      tier = 'bottomTier';\n      tr = null;\n    }\n  };\n  /**\n   * To validate timeline tier count.\n   *\n   * @param {string} mode .\n   * @param {number} count .\n   * @param {string} tier .\n   * @returns {number} .\n   * @private\n   */\n\n\n  Timeline.prototype.validateCount = function (mode, count, tier) {\n    var tierCount = !isNullOrUndefined(count) && parseInt(count.toString(), 10) > 0 ? parseInt(count.toString(), 10) : 1;\n    var timeDifference = Math.abs(this.timelineRoundOffEndDate.getTime() - this.timelineStartDate.getTime());\n    var difference;\n\n    switch (mode) {\n      case 'Year':\n        difference = Math.round(timeDifference / (1000 * 3600 * 24) / (12 * 28));\n        tierCount = tierCount <= difference ? tierCount : difference > 0 ? difference : 1;\n\n        if (this.topTier !== 'None' && tier === 'bottomTier') {\n          tierCount = this.validateBottomTierCount(mode, tierCount);\n        }\n\n        break;\n\n      case 'Month':\n        difference = Math.round(timeDifference / (1000 * 3600 * 24) / 28);\n        tierCount = tierCount <= difference ? tierCount : difference > 0 ? difference : 1;\n\n        if (this.topTier !== 'None' && tier === 'bottomTier') {\n          tierCount = this.validateBottomTierCount(mode, tierCount);\n        }\n\n        break;\n\n      case 'Week':\n        difference = Math.round(timeDifference / (1000 * 3600 * 24) / 7);\n        tierCount = tierCount <= difference ? tierCount : difference > 0 ? difference : 1;\n\n        if (this.topTier !== 'None' && tier === 'bottomTier') {\n          tierCount = this.validateBottomTierCount(mode, tierCount);\n        }\n\n        break;\n\n      case 'Day':\n        difference = Math.round(timeDifference / (1000 * 3600 * 24));\n        tierCount = tierCount <= difference ? tierCount : difference > 0 ? difference : 1;\n\n        if (this.topTier !== 'None' && tier === 'bottomTier') {\n          tierCount = this.validateBottomTierCount(mode, tierCount);\n        }\n\n        break;\n\n      case 'Hour':\n        difference = Math.round(timeDifference / (1000 * 3600));\n        tierCount = tierCount <= difference ? tierCount : difference > 0 ? difference : 1;\n\n        if (this.topTier !== 'None' && tier === 'bottomTier') {\n          tierCount = this.validateBottomTierCount(mode, tierCount);\n        }\n\n        break;\n\n      case 'Minutes':\n        difference = Math.round(timeDifference / (1000 * 60));\n        tierCount = tierCount <= difference ? tierCount : difference > 0 ? difference : 1;\n\n        if (this.topTier !== 'None' && tier === 'bottomTier') {\n          tierCount = this.validateBottomTierCount(mode, tierCount);\n        }\n\n        break;\n    }\n\n    if (count !== tierCount && this.isZooming && this.parent.toolbarModule && (tier === 'bottomTier' || this.isSingleTier)) {\n      if (this.isZoomIn) {\n        this.parent.toolbarModule.enableItems([this.parent.controlId + '_zoomin'], false);\n      } else {\n        this.parent.toolbarModule.enableItems([this.parent.controlId + '_zoomout'], false);\n      }\n    }\n\n    return tierCount;\n  };\n  /**\n   * To validate bottom tier count.\n   *\n   * @param {string} mode .\n   * @param {number} tierCount .\n   * @returns {number} .\n   * @private\n   */\n\n\n  Timeline.prototype.validateBottomTierCount = function (mode, tierCount) {\n    var count;\n\n    switch (mode) {\n      case 'Year':\n        count = tierCount <= this.customTimelineSettings.topTier.count ? tierCount : this.customTimelineSettings.topTier.count;\n        break;\n\n      case 'Month':\n        count = this.topTier === 'Year' ? tierCount <= this.customTimelineSettings.topTier.count * 12 ? tierCount : this.customTimelineSettings.topTier.count * 12 : tierCount <= this.customTimelineSettings.topTier.count ? tierCount : this.customTimelineSettings.topTier.count;\n        break;\n\n      case 'Week':\n        count = this.topTier === 'Year' ? tierCount <= this.customTimelineSettings.topTier.count * (12 * 4) ? tierCount : this.customTimelineSettings.topTier.count * (12 * 4) : this.topTier === 'Month' ? tierCount <= this.customTimelineSettings.topTier.count * 4 ? tierCount : this.customTimelineSettings.topTier.count * 4 : tierCount <= this.customTimelineSettings.topTier.count ? tierCount : this.customTimelineSettings.topTier.count;\n        break;\n\n      case 'Day':\n        count = this.topTier === 'Year' ? tierCount <= this.customTimelineSettings.topTier.count * (12 * 28) ? tierCount : this.customTimelineSettings.topTier.count * (12 * 28) : this.topTier === 'Month' ? tierCount <= this.customTimelineSettings.topTier.count * 28 ? tierCount : this.customTimelineSettings.topTier.count * 28 : this.topTier === 'Week' ? tierCount <= this.customTimelineSettings.topTier.count * 7 ? tierCount : this.customTimelineSettings.topTier.count * 7 : tierCount <= this.customTimelineSettings.topTier.count ? tierCount : this.customTimelineSettings.topTier.count;\n        break;\n\n      case 'Hour':\n        count = this.topTier === 'Year' ? tierCount <= this.customTimelineSettings.topTier.count * (12 * 28 * 24) ? tierCount : this.customTimelineSettings.topTier.count * (12 * 28 * 24) : this.topTier === 'Month' ? tierCount <= this.customTimelineSettings.topTier.count * (28 * 24) ? tierCount : this.customTimelineSettings.topTier.count * (28 * 24) : this.topTier === 'Week' ? tierCount <= this.customTimelineSettings.topTier.count * 7 * 24 ? tierCount : this.customTimelineSettings.topTier.count * 7 * 24 : this.topTier === 'Day' ? tierCount <= this.customTimelineSettings.topTier.count * 24 ? tierCount : this.customTimelineSettings.topTier.count * 24 : tierCount <= this.customTimelineSettings.topTier.count ? tierCount : this.customTimelineSettings.topTier.count;\n        break;\n\n      case 'Minutes':\n        count = this.topTier === 'Year' ? tierCount <= this.customTimelineSettings.topTier.count * (12 * 28 * 24 * 60) ? tierCount : this.customTimelineSettings.topTier.count * (12 * 28 * 24 * 60) : this.topTier === 'Month' ? tierCount <= this.customTimelineSettings.topTier.count * (28 * 24 * 60) ? tierCount : this.customTimelineSettings.topTier.count * (28 * 24 * 60) : this.topTier === 'Week' ? tierCount <= this.customTimelineSettings.topTier.count * 7 * 24 * 60 ? tierCount : this.customTimelineSettings.topTier.count * 7 * 24 * 60 : this.topTier === 'Day' ? tierCount <= this.customTimelineSettings.topTier.count * 24 * 60 ? tierCount : this.customTimelineSettings.topTier.count * 24 * 60 : this.topTier === 'Hour' ? tierCount <= this.customTimelineSettings.topTier.count * 60 ? tierCount : this.customTimelineSettings.topTier.count * 60 : tierCount <= this.customTimelineSettings.topTier.count ? tierCount : this.customTimelineSettings.topTier.count;\n        break;\n    }\n\n    return count;\n  };\n  /**\n   * To validate timeline tier format.\n   *\n   * @param {string} mode .\n   * @param {string} format .\n   * @returns {string} .\n   * @private\n   */\n\n\n  Timeline.prototype.validateFormat = function (mode, format) {\n    var tierFormat;\n\n    switch (mode) {\n      case 'Week':\n        tierFormat = !format ? 'MMM dd, yyyy' : format;\n        break;\n\n      case 'Day':\n      case 'None':\n        tierFormat = !format ? '' : format;\n        break;\n\n      case 'Hour':\n        tierFormat = !format ? 'H' : format;\n        break;\n\n      case 'Month':\n        tierFormat = !format ? 'MMM yyyy' : format;\n        break;\n\n      case 'Year':\n        tierFormat = !format ? 'yyyy' : format;\n        break;\n\n      case 'Minutes':\n        tierFormat = !format ? 'm' : format;\n        break;\n    }\n\n    return tierFormat;\n  };\n  /**\n   * To perform extend operation.\n   *\n   * @param {object} cloneObj .\n   * @param {string[]} propertyCollection .\n   * @param {object} innerProperty .\n   * @returns {object} .\n   * @private\n   */\n\n\n  Timeline.prototype.extendFunction = function (cloneObj, propertyCollection, innerProperty) {\n    var _this = this;\n\n    var tempObj = {};\n\n    for (var index = 0; index < propertyCollection.length; index++) {\n      tempObj[propertyCollection[index]] = cloneObj[propertyCollection[index]];\n    }\n\n    if (innerProperty) {\n      Object.keys(innerProperty).forEach(function (key) {\n        tempObj[key] = _this.extendFunction(cloneObj[key], innerProperty[key], null);\n      });\n    }\n\n    return tempObj;\n  };\n  /**\n   * To format date.\n   *\n   * @param {string} dayFormat .\n   * @param {Date} data .\n   * @returns {string} .\n   * @private\n   */\n\n\n  Timeline.prototype.formatDateHeader = function (dayFormat, data) {\n    var date = new Date(data.getTime());\n    var dateString;\n\n    if (dayFormat === '') {\n      dateString = this.parent.globalize.formatDate(date, {\n        format: 'E'\n      });\n\n      if (this.parent.locale === 'zh') {\n        dateString = dateString.slice(1);\n      } else {\n        dateString = dateString.slice(0, 1);\n      }\n    } else {\n      dateString = this.parent.globalize.formatDate(date, {\n        format: dayFormat\n      });\n    }\n\n    return dateString;\n  };\n  /**\n   * Custom Formatting.\n   *\n   * @param {Date} date .\n   * @param {string} format .\n   * @param {string} tier .\n   * @param {string} mode .\n   * @param {string | ITimelineFormatter} formatter .\n   * @returns {string} .\n   * @private\n   */\n\n\n  Timeline.prototype.customFormat = function (date, format, tier, mode, formatter) {\n    formatter = typeof formatter === 'string' ? getValue(formatter, window) : formatter;\n    return formatter(date, format, tier, mode);\n  };\n  /**\n   * To create timeline template .\n   *\n   * @param {string} tier .\n   * @returns {string} .\n   * @private\n   */\n\n\n  Timeline.prototype.createTimelineTemplate = function (tier) {\n    var parent = this.parent;\n    var parentTh = '';\n    var parentTr = '';\n    var mode = tier === 'topTier' ? parent.timelineModule.customTimelineSettings.topTier.unit : parent.timelineModule.customTimelineSettings.bottomTier.unit;\n    var count = tier === 'topTier' ? parent.timelineModule.customTimelineSettings.topTier.count : parent.timelineModule.customTimelineSettings.bottomTier.count;\n    var increment;\n    var newTime;\n    var startDate = new Date(this.parent.timelineModule.timelineStartDate.toString());\n    var endDate = new Date(this.timelineRoundOffEndDate.toString());\n    var scheduleDateCollection = [];\n\n    do {\n      // PDf export collection\n      var timelineCell = {};\n      timelineCell.startDate = new Date(startDate.getTime());\n      parentTr = this.getHeaterTemplateString(new Date(startDate.toString()), mode, tier, false, count, timelineCell);\n      scheduleDateCollection.push(new Date(startDate.toString()));\n      increment = this.getIncrement(startDate, count, mode);\n      newTime = startDate.getTime() + increment;\n      startDate.setTime(newTime);\n\n      if (startDate >= endDate) {\n        /* eslint-disable-next-line */\n        parentTr = this.getHeaterTemplateString(scheduleDateCollection[scheduleDateCollection.length - 1], mode, tier, true, count, timelineCell);\n      }\n\n      parentTh = parentTh + parentTr;\n      var tierCollection = tier === 'topTier' ? this.topTierCollection : this.bottomTierCollection;\n      timelineCell.endDate = new Date(startDate.getTime());\n      tierCollection.push(timelineCell);\n    } while (startDate < endDate);\n\n    return parentTh;\n  };\n\n  Timeline.prototype.getTimelineRoundOffEndDate = function (date) {\n    var tierMode = this.topTier === 'None' ? this.bottomTier : this.topTier;\n    var endDate = new Date(date.toString());\n\n    if (this.parent.isTimelineRoundOff) {\n      if (tierMode === 'Hour') {\n        endDate.setMinutes(60);\n      } else if (tierMode === 'Minutes') {\n        endDate.setSeconds(60);\n      } else {\n        endDate.setHours(24, 0, 0, 0);\n      }\n    }\n\n    return endDate;\n  };\n  /**\n   *\n   * @param {Date} startDate .\n   * @param {number} count .\n   * @param {string} mode .\n   * @returns {number} .\n   * @private\n   */\n\n\n  Timeline.prototype.getIncrement = function (startDate, count, mode) {\n    var firstDay = new Date(startDate.getTime());\n    var lastDay = new Date(startDate.getTime());\n    var increment;\n\n    switch (mode) {\n      case 'Year':\n        firstDay = startDate;\n        lastDay = new Date(startDate.getFullYear() + (count - 1), 11, 31);\n        increment = lastDay.getTime() - firstDay.getTime() + 1000 * 60 * 60 * 24;\n        break;\n\n      case 'Month':\n        firstDay = startDate;\n        lastDay = new Date(startDate.getFullYear(), startDate.getMonth() + count, 1);\n        increment = lastDay.getTime() - firstDay.getTime();\n        break;\n\n      case 'Week':\n        {\n          var dayIndex = this.parent.timelineModule.customTimelineSettings.weekStartDay;\n          var dayIntervel = startDate.getDay() < dayIndex ? dayIndex - startDate.getDay() : 6 - startDate.getDay() + dayIndex;\n          count = dayIntervel > 0 ? count - 1 : 0;\n          lastDay.setHours(24, 0, 0, 0);\n          dayIntervel = startDate.getDay() < dayIndex ? dayIntervel > 0 ? dayIntervel - 1 : dayIntervel : dayIntervel;\n          lastDay.setDate(lastDay.getDate() + (dayIntervel + 7 * count));\n          increment = lastDay.getTime() - firstDay.getTime();\n          break;\n        }\n\n      case 'Day':\n        lastDay.setHours(24, 0, 0, 0);\n        increment = lastDay.getTime() - firstDay.getTime() + 1000 * 60 * 60 * 24 * (count - 1);\n        break;\n\n      case 'Hour':\n        lastDay.setMinutes(60);\n        lastDay.setSeconds(0);\n        increment = lastDay.getTime() - firstDay.getTime() + 1000 * 60 * 60 * (count - 1);\n        break;\n\n      case 'Minutes':\n        lastDay.setSeconds(60);\n        increment = lastDay.getTime() - firstDay.getTime() + 1000 * 60 * (count - 1);\n        break;\n    }\n\n    return increment;\n  };\n  /**\n   * Method to find header cell was weekend or not\n   *\n   * @param {string} mode .\n   * @param {string} tier .\n   * @param {Date} day .\n   * @returns {boolean} .\n   */\n\n\n  Timeline.prototype.isWeekendHeaderCell = function (mode, tier, day) {\n    return (mode === 'Day' || mode === 'Hour' || mode === 'Minutes') && (this.customTimelineSettings[tier].count === 1 || mode === 'Hour' || mode === 'Minutes') && this.parent.nonWorkingDayIndex.indexOf(day.getDay()) !== -1;\n  };\n  /**\n   * To construct template string.\n   *\n   * @param {Date} scheduleWeeks .\n   * @param {string} mode .\n   * @param {string} tier .\n   * @param {boolean} isLast .\n   * @param {number} count .\n   * @param {TimelineFormat} timelineCell .\n   * @returns {string} .\n   * @private\n   */\n\n  /* eslint-disable-next-line */\n\n\n  Timeline.prototype.getHeaterTemplateString = function (scheduleWeeks, mode, tier, isLast, count, timelineCell) {\n    var parentTr = '';\n    var td = '';\n    var format = tier === 'topTier' ? this.parent.timelineModule.customTimelineSettings.topTier.format : this.parent.timelineModule.customTimelineSettings.bottomTier.format;\n    var formatter = tier === 'topTier' ? this.parent.timelineModule.customTimelineSettings.topTier.formatter : this.parent.timelineModule.customTimelineSettings.bottomTier.formatter;\n    var thWidth;\n    var date = isNullOrUndefined(formatter) ? this.parent.globalize.formatDate(scheduleWeeks, {\n      format: this.parent.getDateFormat()\n    }) : this.customFormat(scheduleWeeks, format, tier, mode, formatter);\n    thWidth = this.getIncrement(scheduleWeeks, count, mode) / (1000 * 60 * 60 * 24) * this.parent.perDayWidth;\n    var cellWidth = thWidth;\n    thWidth = isLast ? this.calculateWidthBetweenTwoDate(mode, scheduleWeeks, this.timelineRoundOffEndDate) : thWidth;\n    var isWeekendCell = this.isWeekendHeaderCell(mode, tier, scheduleWeeks);\n    var textClassName = tier === 'topTier' ? ' e-gantt-top-cell-text' : '';\n    var value = isNullOrUndefined(formatter) ? this.formatDateHeader(format, scheduleWeeks) : this.customFormat(scheduleWeeks, format, tier, mode, formatter);\n    td += this.parent.timelineModule.isSingleTier ? '<th class=\"' + cls.timelineSingleHeaderCell + ' ' : '<th class=\"' + cls.timelineTopHeaderCell;\n    td += isWeekendCell ? ' ' + cls.weekendHeaderCell : '';\n    td += '\" tabindex=\"-1\" aria-label= \"' + this.parent.localeObj.getConstant('timelineCell') + ' ' + date;\n    td += '\" style=\"width:' + thWidth + 'px;';\n    td += isWeekendCell && this.customTimelineSettings.weekendBackground ? 'background-color:' + this.customTimelineSettings.weekendBackground + ';' : '';\n    td += '\"><div class=\"' + cls.timelineHeaderCellLabel + textClassName + '\" style=\"width:' + (thWidth - 1) + 'px;' + (this.parent.timelineSettings.showTooltip ? '\"title=\"' + date : '');\n    td += '\">' + value + '</div>';\n    parentTr += td;\n    parentTr += '</th>';\n\n    if ((this.isSingleTier || tier === 'topTier') && !isLast) {\n      this.totalTimelineWidth = this.totalTimelineWidth + thWidth;\n    } else if ((this.isSingleTier || tier === 'topTier') && isLast) {\n      this.totalTimelineWidth = this.totalTimelineWidth - cellWidth + thWidth;\n    } // PDf export collection\n\n\n    timelineCell.value = value;\n    timelineCell.isWeekend = isWeekendCell;\n    timelineCell.width = cellWidth;\n    return parentTr;\n  };\n  /**\n   * To calculate last 'th' width.\n   *\n   * @param {string} mode .\n   * @param {Date} scheduleWeeks .\n   * @param {Date} endDate .\n   * @returns {number} .\n   * @private\n   */\n\n\n  Timeline.prototype.calculateWidthBetweenTwoDate = function (mode, scheduleWeeks, endDate) {\n    var balanceDay = (endDate.getTime() - scheduleWeeks.getTime()) / (1000 * 60 * 60 * 24);\n    return balanceDay * this.parent.perDayWidth;\n  };\n  /**\n   * To calculate timeline width.\n   *\n   * @returns {void} .\n   * @private\n   */\n\n\n  Timeline.prototype.timelineWidthCalculation = function () {\n    var timelineUnitSize = this.customTimelineSettings.timelineUnitSize;\n    var bottomTierCount = this.customTimelineSettings.bottomTier.count;\n    var topTierCount = this.customTimelineSettings.topTier.count;\n    this.bottomTierCellWidth = timelineUnitSize;\n\n    if (this.bottomTier === 'None') {\n      this.parent.perDayWidth = this.getPerDayWidth(timelineUnitSize, topTierCount, this.topTier);\n    } else {\n      this.parent.perDayWidth = this.getPerDayWidth(timelineUnitSize, bottomTierCount, this.bottomTier);\n    }\n\n    this.topTierCellWidth = this.bottomTier !== 'None' ? this.topTier === 'Week' ? this.parent.perDayWidth * 7 : this.topTier === 'Hour' ? this.parent.perDayWidth / 24 : this.topTier === 'Minutes' ? this.parent.perDayWidth / (24 * 60) : this.parent.perDayWidth : timelineUnitSize;\n    this.topTierCellWidth = this.isSingleTier ? this.topTierCellWidth : this.topTierCellWidth * topTierCount;\n  };\n  /**\n   * To validate per day width.\n   *\n   * @param {number} timelineUnitSize .\n   * @param {number} bottomTierCount .\n   * @param {string} mode .\n   * @returns {number} .\n   * @private\n   */\n\n\n  Timeline.prototype.getPerDayWidth = function (timelineUnitSize, bottomTierCount, mode) {\n    var perDayWidth;\n\n    switch (mode) {\n      case 'Year':\n        perDayWidth = timelineUnitSize / bottomTierCount / (12 * 28);\n        break;\n\n      case 'Month':\n        perDayWidth = timelineUnitSize / bottomTierCount / 28;\n        break;\n\n      case 'Week':\n        perDayWidth = timelineUnitSize / bottomTierCount / 7;\n        break;\n\n      case 'Day':\n        perDayWidth = timelineUnitSize / bottomTierCount;\n        break;\n\n      case 'Hour':\n        perDayWidth = 24 / bottomTierCount * timelineUnitSize;\n        break;\n\n      case 'Minutes':\n        perDayWidth = 60 * 24 / bottomTierCount * timelineUnitSize;\n        break;\n    }\n\n    return perDayWidth;\n  };\n  /**\n   * To validate project start date and end date.\n   *\n   * @returns {void} .\n   * @private\n   */\n\n\n  Timeline.prototype.roundOffDays = function () {\n    var startDate = this.parent.cloneProjectStartDate;\n    var endDate = this.parent.cloneProjectEndDate;\n    var tierMode = this.topTier === 'None' ? this.bottomTier : this.topTier;\n\n    if (this.parent.isTimelineRoundOff) {\n      if (tierMode === 'Year') {\n        startDate = new Date(startDate.getFullYear(), 0, 1);\n        endDate = new Date(endDate.getFullYear(), 11, 31);\n      } else if (tierMode === 'Month') {\n        startDate = new Date(startDate.getFullYear(), startDate.getMonth(), 1);\n        endDate = new Date(endDate.getFullYear(), endDate.getMonth() + 1, 0);\n      } else if (tierMode === 'Week') {\n        var dayIndex = this.parent.timelineModule.customTimelineSettings.weekStartDay;\n        var roundOffStartDate = startDate.getDay() < dayIndex ? startDate.getDate() - (7 - dayIndex + startDate.getDay()) : startDate.getDate() - startDate.getDay() + dayIndex;\n        startDate.setDate(roundOffStartDate);\n        var first = endDate.getDate() - endDate.getDay();\n        var last = first + 6 + dayIndex;\n        endDate.setDate(last);\n      }\n\n      if (tierMode === 'Hour') {\n        startDate.setMinutes(0);\n      } else if (tierMode === 'Minutes') {\n        startDate.setSeconds(0);\n      } else {\n        startDate.setHours(0, 0, 0, 0);\n      }\n    }\n\n    this.timelineStartDate = startDate;\n    this.timelineEndDate = endDate;\n    this.timelineRoundOffEndDate = this.getTimelineRoundOffEndDate(this.timelineEndDate);\n  };\n  /**\n   * To validate project start date and end date.\n   *\n   * @param {string} mode .\n   * @param {string} span .\n   * @param {Date} startDate .\n   * @param {Date} endDate .\n   * @returns {void} .\n   * @private\n   */\n\n\n  Timeline.prototype.updateScheduleDatesByToolBar = function (mode, span, startDate, endDate) {\n    if (mode === 'Year') {\n      if (span === 'prevTimeSpan') {\n        if (startDate.getMonth() === 0) {\n          startDate = new Date(startDate.getFullYear() - 1, 0, 1);\n        } else {\n          startDate = new Date(startDate.getFullYear(), 0, 1);\n        }\n      } else {\n        if (endDate.getMonth() === 11) {\n          endDate = new Date(endDate.getFullYear() + 1, 0, 1);\n        } else {\n          endDate = new Date(endDate.getFullYear(), 12, 1);\n        }\n      }\n    }\n\n    if (mode === 'Month') {\n      if (span === 'prevTimeSpan') {\n        if (startDate.getDate() === 1) {\n          startDate = new Date(startDate.getFullYear(), startDate.getMonth() - 1, 1);\n        } else {\n          startDate = new Date(startDate.getFullYear(), startDate.getMonth(), 1);\n        }\n      } else {\n        endDate = new Date(endDate.getFullYear(), endDate.getMonth() + 1, 1);\n      }\n    }\n\n    if (mode === 'Week') {\n      var dayIndex = this.parent.timelineModule.customTimelineSettings.weekStartDay;\n      var dayIntervel = void 0;\n\n      if (span === 'prevTimeSpan') {\n        dayIntervel = startDate.getDay() < dayIndex ? 7 - (dayIndex - startDate.getDay()) : startDate.getDay() - dayIndex;\n        startDate.setHours(0, 0, 0, 0);\n\n        if (dayIntervel === 0) {\n          startDate.setDate(startDate.getDate() - 7);\n        } else {\n          startDate.setDate(startDate.getDate() - dayIntervel);\n        }\n      } else {\n        dayIntervel = endDate.getDay() < dayIndex ? dayIndex - endDate.getDay() : 7 - endDate.getDay() + dayIndex;\n        endDate.setHours(0, 0, 0, 0);\n\n        if (dayIntervel === 0) {\n          endDate.setDate(endDate.getDate() + 6);\n        } else {\n          endDate.setDate(endDate.getDate() + dayIntervel);\n        }\n      }\n    }\n\n    if (mode === 'Day') {\n      if (span === 'prevTimeSpan') {\n        if (startDate.getHours() === 0) {\n          startDate.setTime(startDate.getTime() - 1000 * 60 * 60 * 24);\n        } else {\n          startDate.setHours(0);\n        }\n      } else {\n        if (endDate.getHours() === 0) {\n          endDate.setTime(endDate.getTime() + 1000 * 60 * 60 * 24);\n        } else {\n          endDate.setHours(24);\n        }\n      }\n    }\n\n    if (mode === 'Hour') {\n      if (span === 'prevTimeSpan') {\n        if (startDate.getMinutes() === 0) {\n          startDate.setTime(startDate.getTime() - 1000 * 60 * 60);\n        } else {\n          startDate.setMinutes(0);\n        }\n      } else {\n        if (endDate.getMinutes() === 0) {\n          endDate.setTime(endDate.getTime() + 1000 * 60 * 60);\n        } else {\n          endDate.setMinutes(60);\n        }\n      }\n    }\n\n    if (mode === 'Minutes') {\n      if (span === 'prevTimeSpan') {\n        if (startDate.getSeconds() === 0) {\n          startDate.setTime(startDate.getTime() - 1000 * 60);\n        } else {\n          startDate.setSeconds(0);\n        }\n      } else {\n        if (endDate.getSeconds() === 0) {\n          endDate.setTime(endDate.getTime() + 1000 * 60);\n        } else {\n          endDate.setSeconds(60);\n        }\n      }\n    }\n\n    this.parent.cloneProjectStartDate = startDate;\n    this.parent.cloneProjectEndDate = endDate;\n  };\n  /**\n   * To validate project start date and end date.\n   *\n   * @param {IGanttData[]} tempArray .\n   * @param {string} action .\n   * @returns {void} .\n   * @private\n   */\n\n\n  Timeline.prototype.updateTimeLineOnEditing = function (tempArray, action) {\n    if (tempArray[0].length >= 1) {\n      for (var i = 0; i < tempArray.length; i++) {\n        /* eslint-disable-next-line */\n        var temp = tempArray[i];\n        var filteredStartDateRecord = temp.filter(function (pdc) {\n          return !isNullOrUndefined(pdc.ganttProperties.startDate);\n        });\n        var filteredEndDateRecord = temp.filter(function (pdc) {\n          return !isNullOrUndefined(pdc.ganttProperties.endDate);\n        });\n        var minStartDate = filteredStartDateRecord.length > 0 ? new Date(DataUtil.aggregates.min(filteredStartDateRecord, 'ganttProperties.startDate')) : null;\n        var maxEndDate = filteredEndDateRecord.length > 0 ? new Date(DataUtil.aggregates.max(filteredEndDateRecord, 'ganttProperties.endDate')) : null;\n        var validStartDate = new Date(this.parent.dataOperation.checkStartDate(this.timelineStartDate).getTime());\n        var validEndDate = new Date(this.parent.dataOperation.checkEndDate(this.timelineEndDate).getTime());\n        var maxStartLeft = isNullOrUndefined(minStartDate) ? null : this.parent.dataOperation.getTaskLeft(minStartDate, false);\n        var maxEndLeft = isNullOrUndefined(maxEndDate) ? null : this.parent.dataOperation.getTaskLeft(maxEndDate, false);\n        var validStartLeft = this.parent.dataOperation.getTaskLeft(validStartDate, false);\n        var validEndLeft = this.parent.dataOperation.getTaskLeft(validEndDate, false);\n        var isChanged = void 0;\n\n        if (!isNullOrUndefined(maxStartLeft) && (maxStartLeft <= this.bottomTierCellWidth || maxStartLeft <= validStartLeft)) {\n          isChanged = 'prevTimeSpan';\n          minStartDate = minStartDate > this.timelineStartDate ? this.timelineStartDate : minStartDate;\n        } else {\n          minStartDate = this.timelineStartDate;\n        }\n\n        if (!isNullOrUndefined(maxEndLeft) && (maxEndLeft >= this.totalTimelineWidth - this.bottomTierCellWidth || maxEndLeft >= validEndLeft)) {\n          isChanged = isChanged === 'prevTimeSpan' ? 'both' : 'nextTimeSpan';\n          maxEndDate = maxEndDate < this.timelineEndDate ? this.timelineEndDate : maxEndDate;\n        } else {\n          maxEndDate = this.timelineEndDate;\n        }\n\n        if (isChanged) {\n          this.performTimeSpanAction(isChanged, action, minStartDate, maxEndDate);\n        } else if (!isNullOrUndefined(temp[0].ganttProperties.segments)) {\n          this.parent.dataOperation.updateWidthLeft(temp[0]);\n        }\n\n        break;\n      }\n    }\n  };\n  /**\n   * To validate project start date and end date on editing action\n   *\n   * @param {string} type .\n   * @param {string} isFrom .\n   * @param {Date} startDate .\n   * @param {Date} endDate .\n   * @param {string} mode .\n   * @returns {void} .\n   * @private\n   */\n\n\n  Timeline.prototype.performTimeSpanAction = function (type, isFrom, startDate, endDate, mode) {\n    mode = !isNullOrUndefined(mode) ? mode : this.parent.timelineModule.topTier === 'None' ? this.parent.timelineModule.bottomTier : this.parent.timelineModule.topTier;\n    var projectStartDate = new Date(this.parent.cloneProjectStartDate.getTime());\n    var projectEndDate = new Date(this.parent.cloneProjectEndDate.getTime());\n\n    if (isFrom !== 'publicMethod' && type === 'both') {\n      this.updateScheduleDatesByToolBar(mode, 'prevTimeSpan', startDate, endDate);\n      this.updateScheduleDatesByToolBar(mode, 'nextTimeSpan', new Date(this.parent.cloneProjectStartDate.getTime()), endDate);\n    } else {\n      this.updateScheduleDatesByToolBar(mode, type, startDate, endDate);\n    }\n\n    var args = this.timeSpanActionEvent('actionBegin', type, isFrom);\n\n    if (!args.cancel) {\n      this.parent.updateProjectDates(args.projectStartDate, args.ProjectEndDate, args.isTimelineRoundOff, isFrom);\n\n      if (type === 'prevTimeSpan' && isFrom === 'publicMethod') {\n        this.parent.ganttChartModule.updateScrollLeft(0);\n      } else if (type === 'nextTimeSpan' && isFrom === 'publicMethod') {\n        this.parent.ganttChartModule.updateScrollLeft(this.parent.timelineModule.totalTimelineWidth);\n      }\n\n      this.parent.timelineModule.timeSpanActionEvent('actionComplete', type, isFrom);\n    } else {\n      this.parent.cloneProjectStartDate = projectStartDate;\n      this.parent.cloneProjectEndDate = projectEndDate;\n    }\n  };\n  /**\n   * To validate project start date and end date.\n   *\n   * @param {string} eventType .\n   * @param {string} requestType .\n   * @param {string} isFrom .\n   * @returns {void}\n   * @private\n   */\n\n\n  Timeline.prototype.timeSpanActionEvent = function (eventType, requestType, isFrom) {\n    var args = {};\n    args.projectStartDate = new Date(this.parent.cloneProjectStartDate.getTime());\n    args.ProjectEndDate = new Date(this.parent.cloneProjectEndDate.getTime());\n    args.requestType = isFrom === 'publicMethod' ? requestType : isFrom === 'beforeAdd' ? 'TimelineRefreshOnAdd' : isFrom === 'TaskbarEditing' ? 'TimelineRefreshOnEdit' : requestType;\n\n    if (eventType === 'actionBegin') {\n      args.isTimelineRoundOff = this.parent.isTimelineRoundOff;\n      args.cancel = false;\n    }\n\n    args.action = 'TimescaleUpdate';\n    this.parent.trigger(eventType, args);\n    return args;\n  };\n\n  return Timeline;\n}();\n\nexport { Timeline };","map":{"version":3,"sources":["/Users/tristanbilot/Desktop/Design4green/design4green/node_modules/@syncfusion/ej2-gantt/src/gantt/renderer/timeline.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","createElement","isNullOrUndefined","getValue","addClass","removeClass","extend","cls","DataUtil","Timeline","ganttObj","isZoomIn","isZooming","isZoomToFit","topTierCollection","bottomTierCollection","parent","initProperties","timelineStartDate","timelineEndDate","totalTimelineWidth","customTimelineSettings","isTimelineRoundOff","projectStartDate","validateTimelineProp","roundOffDays","processTimelineProperty","timelineWidthCalculation","refreshTimeline","processTimelineUnit","dataOperation","calculateProjectDates","isFromOnPropertyChange","updateProjectDates","cloneProjectStartDate","cloneProjectEndDate","refreshTimelineByTimeSpan","ganttChartModule","chartTimelineContainer","innerHTML","createTimelineSeries","updateChartByNewTimeline","chartRowsModule","refreshChartByTimeline","notify","processZooming","zoomingProjectStartDate","getTime","zoomingProjectEndDate","currentZoomingLevel","checkCurrentZoomingLevel","currentLevel","toolbarModule","zoomingLevels","level","enableItems","controlId","newTimeline","args","requestType","timeline","cancel","trigger","changeTimelineSettings","_this","skipProperty","isSingleTier","topTier","unit","keys","forEach","property","value","assignValue","processZoomToFit","timeDifference","totalDays","chartWidth","chartElement","offsetWidth","perDayWidth","zoomingLevel","firstValue","secondValue","zoomingCollections","slice","sortedCollectons","sort","a","b","roundOffDateToZoom","bottomTier","numberOfCells","calculateNumberOfTimelineCells","scrollHeight","scrollElement","offsetHeight","contentHeight","chartBodyContent","emptySpace","timelineUnitSize","Math","abs","date","isStartDate","tierMode","width","roundOffTime","setTime","setMinutes","setSeconds","setHours","numberOfDays","count","directProperty","innerProperty","tierUnits","extendFunction","timelineSettings","indexOf","timelineViewMode","previousIsSingleTier","validateCount","format","validateFormat","weekStartDay","calculateZoomingLevelsPerDayWidth","collections","getPerDayWidth","zoomLevel","getCurrentZoomingLevel","currentZoomCollection","checkSameCountLevels","getZoomingLevels","sameUnitLevels","filter","tempLevel","closestUnit_1","getClosestUnit","sortedUnitLevels","checkCollectionsWidth","closetUnit","isCont","bottomTierUnits","index","checkSameLevels","zoomLevels","sortedZoomLevels","updateTimelineHeaderHeight","timelineModule","timelineSingleHeaderOuterDiv","treeGrid","element","querySelectorAll","toolbarHeight","scrollObject","setHeight","ganttHeight","height","tr","td","div","table","thead","loopCount","tier","className","timelineHeaderTableContainer","styles","timelineHeaderTableBody","createTimelineTemplate","appendChild","mode","tierCount","parseInt","toString","timelineRoundOffEndDate","difference","round","validateBottomTierCount","tierFormat","cloneObj","propertyCollection","tempObj","key","formatDateHeader","dayFormat","data","Date","dateString","globalize","formatDate","locale","customFormat","formatter","window","parentTh","parentTr","increment","newTime","startDate","endDate","scheduleDateCollection","timelineCell","getHeaterTemplateString","push","getIncrement","tierCollection","getTimelineRoundOffEndDate","firstDay","lastDay","getFullYear","getMonth","dayIndex","dayIntervel","getDay","setDate","getDate","isWeekendHeaderCell","day","nonWorkingDayIndex","scheduleWeeks","isLast","thWidth","getDateFormat","cellWidth","calculateWidthBetweenTwoDate","isWeekendCell","textClassName","timelineSingleHeaderCell","timelineTopHeaderCell","weekendHeaderCell","localeObj","getConstant","weekendBackground","timelineHeaderCellLabel","showTooltip","isWeekend","balanceDay","bottomTierCount","topTierCount","bottomTierCellWidth","topTierCellWidth","roundOffStartDate","first","last","updateScheduleDatesByToolBar","span","getHours","getMinutes","getSeconds","updateTimeLineOnEditing","tempArray","action","temp","filteredStartDateRecord","pdc","ganttProperties","filteredEndDateRecord","minStartDate","aggregates","min","maxEndDate","max","validStartDate","checkStartDate","validEndDate","checkEndDate","maxStartLeft","getTaskLeft","maxEndLeft","validStartLeft","validEndLeft","isChanged","performTimeSpanAction","segments","updateWidthLeft","type","isFrom","projectEndDate","timeSpanActionEvent","ProjectEndDate","updateScrollLeft","eventType"],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { createElement, isNullOrUndefined, getValue, addClass, removeClass, extend } from '@syncfusion/ej2-base';\nimport * as cls from '../base/css-constants';\nimport { DataUtil } from '@syncfusion/ej2-data';\n/**\n * Configures the `Timeline` of the gantt.\n */\nvar Timeline = /** @class */ (function () {\n    function Timeline(ganttObj) {\n        this.isZoomIn = false;\n        this.isZooming = false;\n        this.isZoomToFit = false;\n        this.topTierCollection = [];\n        this.bottomTierCollection = [];\n        this.parent = ganttObj;\n        this.initProperties();\n    }\n    /**\n     * To initialize the public property.\n     *\n     * @returns {void}\n     * @private\n     */\n    Timeline.prototype.initProperties = function () {\n        this.timelineStartDate = null;\n        this.timelineEndDate = null;\n        this.totalTimelineWidth = 0;\n        this.customTimelineSettings = null;\n        this.parent.isTimelineRoundOff = this.isZoomToFit ? false : isNullOrUndefined(this.parent.projectStartDate) ? true : false;\n    };\n    /**\n     * To render timeline header series.\n     *\n     * @returns {void}\n     * @private\n     */\n    Timeline.prototype.validateTimelineProp = function () {\n        this.roundOffDays();\n        this.processTimelineProperty();\n        this.timelineWidthCalculation();\n    };\n    /**\n     * Function used to refresh Gantt rows.\n     *\n     * @returns {void}\n     * @private\n     */\n    Timeline.prototype.refreshTimeline = function () {\n        this.initProperties();\n        this.processTimelineUnit();\n        this.parent.dataOperation.calculateProjectDates();\n        if (!this.parent.isFromOnPropertyChange) {\n            this.parent.updateProjectDates(this.parent.cloneProjectStartDate, this.parent.cloneProjectEndDate, this.parent.isTimelineRoundOff);\n        }\n    };\n    /**\n     * Function used to refresh Gantt rows.\n     *\n     * @returns {void}\n     * @private\n     */\n    Timeline.prototype.refreshTimelineByTimeSpan = function () {\n        this.validateTimelineProp();\n        this.parent.ganttChartModule.chartTimelineContainer.innerHTML = '';\n        this.createTimelineSeries();\n    };\n    /**\n     * Function used to refresh Gantt rows.\n     *\n     * @returns {void}\n     * @private\n     */\n    Timeline.prototype.updateChartByNewTimeline = function () {\n        this.parent.chartRowsModule.refreshChartByTimeline();\n        this.parent.notify('refreshDayMarkers', {});\n    };\n    /**\n     * Function used to perform Zoomin and Zoomout actions in Gantt control.\n     *\n     * @param {boolean} isZoomIn .\n     * @private\n     * @returns {void}\n     */\n    Timeline.prototype.processZooming = function (isZoomIn) {\n        this.isZoomToFit = false;\n        if (!isNullOrUndefined(this.parent.zoomingProjectStartDate)) {\n            this.parent.cloneProjectStartDate = this.parent.cloneProjectStartDate.getTime() < this.parent.zoomingProjectStartDate.getTime()\n                ? this.parent.cloneProjectStartDate : this.parent.zoomingProjectStartDate;\n            this.parent.cloneProjectEndDate = this.parent.cloneProjectEndDate.getTime() > this.parent.zoomingProjectEndDate.getTime()\n                ? this.parent.cloneProjectEndDate : this.parent.zoomingProjectEndDate;\n        }\n        this.parent.zoomingProjectStartDate = null;\n        this.parent.zoomingProjectEndDate = null;\n        var currentZoomingLevel = this.checkCurrentZoomingLevel();\n        this.isZoomIn = isZoomIn;\n        this.isZooming = true;\n        var currentLevel = isZoomIn ? currentZoomingLevel + 1 : currentZoomingLevel - 1;\n        if (this.parent.toolbarModule) {\n            if (isZoomIn) {\n                if (currentLevel === this.parent.zoomingLevels[this.parent.zoomingLevels.length - 1].level) {\n                    this.parent.toolbarModule.enableItems([this.parent.controlId + '_zoomin'], false); // disable toolbar items.\n                }\n                else {\n                    this.parent.toolbarModule.enableItems([this.parent.controlId + '_zoomout'], true); // disable toolbar items.\n                }\n            }\n            else {\n                if (currentLevel === this.parent.zoomingLevels[0].level) {\n                    this.parent.toolbarModule.enableItems([this.parent.controlId + '_zoomout'], false); // disable toolbar items.\n                }\n                else {\n                    this.parent.toolbarModule.enableItems([this.parent.controlId + '_zoomin'], true); // enable toolbar items.\n                }\n            }\n        }\n        var newTimeline = this.parent.zoomingLevels[currentLevel];\n        var args = {\n            requestType: isZoomIn ? 'beforeZoomIn' : 'beforeZoomOut',\n            timeline: newTimeline,\n            cancel: false\n        };\n        this.parent.trigger('actionBegin', args);\n        if (!args.cancel) {\n            newTimeline = args.timeline;\n            this.changeTimelineSettings(newTimeline);\n        }\n    };\n    /**\n     * To change the timeline settings property values based upon the Zooming levels.\n     *\n     * @param {ZoomTimelineSettings} newTimeline .\n     * @returns {void}\n     * @private\n     */\n    Timeline.prototype.changeTimelineSettings = function (newTimeline) {\n        var _this = this;\n        var skipProperty = this.isSingleTier ?\n            this.customTimelineSettings.topTier.unit === 'None' ?\n                'topTier' : 'bottomTier' : null;\n        Object.keys(this.customTimelineSettings).forEach(function (property) {\n            if (property !== skipProperty) {\n                _this.customTimelineSettings[property] = (typeof newTimeline[property] === 'object'\n                    && !isNullOrUndefined(newTimeline[property])) ? __assign({}, newTimeline[property]) : newTimeline[property];\n            }\n            else {\n                var value = property === 'topTier' ? 'bottomTier' : 'topTier';\n                var assignValue = 'bottomTier';\n                _this.customTimelineSettings[value] = __assign({}, newTimeline[assignValue]);\n            }\n        });\n        this.parent.isTimelineRoundOff = this.isZoomToFit ? false : isNullOrUndefined(this.parent.projectStartDate) ? true : false;\n        this.processTimelineUnit();\n        this.parent.updateProjectDates(this.parent.cloneProjectStartDate, this.parent.cloneProjectEndDate, this.parent.isTimelineRoundOff);\n        if (this.isZooming || this.isZoomToFit) {\n            var args = {\n                requestType: this.isZoomIn ? 'AfterZoomIn' : this.isZoomToFit ? 'AfterZoomToProject' : 'AfterZoomOut',\n                timeline: this.parent.currentZoomingLevel\n            };\n            this.parent.trigger('actionComplete', args);\n        }\n    };\n    /**\n     * To perform the zoom to fit operation in Gantt.\n     *\n     * @returns {void}\n     * @private\n     */\n    Timeline.prototype.processZoomToFit = function () {\n        this.isZoomToFit = true;\n        this.isZooming = false;\n        if (!this.parent.zoomingProjectStartDate) {\n            this.parent.zoomingProjectStartDate = this.parent.cloneProjectStartDate;\n            this.parent.zoomingProjectEndDate = this.parent.cloneProjectEndDate;\n        }\n        this.parent.dataOperation.calculateProjectDates();\n        var timeDifference = (this.parent.cloneProjectEndDate.getTime() - this.parent.cloneProjectStartDate.getTime());\n        var totalDays = (timeDifference / (1000 * 3600 * 24));\n        var chartWidth = this.parent.ganttChartModule.chartElement.offsetWidth;\n        var perDayWidth = chartWidth / totalDays;\n        var zoomingLevel;\n        var firstValue;\n        var secondValue;\n        var zoomingCollections = this.parent.zoomingLevels.slice();\n        var sortedCollectons = zoomingCollections.sort(function (a, b) {\n            return (a.perDayWidth < b.perDayWidth) ? 1 : -1;\n        });\n        if (perDayWidth === 0) { // return when the Gantt chart is not in viewable state.\n            return;\n        }\n        for (var i = 0; i < sortedCollectons.length; i++) {\n            firstValue = sortedCollectons[i];\n            if (i === sortedCollectons.length - 1) {\n                zoomingLevel = sortedCollectons[i];\n                break;\n            }\n            else {\n                secondValue = sortedCollectons[i + 1];\n            }\n            if (perDayWidth >= firstValue.perDayWidth) {\n                zoomingLevel = sortedCollectons[i];\n                break;\n            }\n            if (perDayWidth < firstValue.perDayWidth && perDayWidth > secondValue.perDayWidth) {\n                zoomingLevel = sortedCollectons[i + 1];\n                break;\n            }\n        }\n        var newTimeline = extend({}, {}, zoomingLevel, true);\n        this.roundOffDateToZoom(this.parent.cloneProjectStartDate, true, perDayWidth, newTimeline.bottomTier.unit);\n        this.roundOffDateToZoom(this.parent.cloneProjectEndDate, false, perDayWidth, newTimeline.bottomTier.unit);\n        var numberOfCells = this.calculateNumberOfTimelineCells(newTimeline);\n        var scrollHeight = this.parent.ganttChartModule.scrollElement.offsetHeight - 17; //17 is horizontal scrollbar width\n        var contentHeight = this.parent.ganttChartModule.chartBodyContent.offsetHeight;\n        var emptySpace = contentHeight <= scrollHeight ? 0 : 17;\n        newTimeline.timelineUnitSize = Math.abs((chartWidth - emptySpace)) / numberOfCells;\n        var args = {\n            requestType: 'beforeZoomToProject',\n            timeline: newTimeline\n        };\n        if (this.parent.toolbarModule) {\n            this.parent.toolbarModule.enableItems([this.parent.controlId + '_zoomin', this.parent.controlId + '_zoomout'], true);\n        }\n        this.parent.trigger('actionBegin', args);\n        this.changeTimelineSettings(newTimeline);\n    };\n    Timeline.prototype.roundOffDateToZoom = function (date, isStartDate, perDayWidth, tierMode) {\n        var width = tierMode === 'Month' || tierMode === 'Year' ? 60 : 20;\n        var roundOffTime = (width / perDayWidth) * (24 * 60 * 60 * 1000);\n        if (isStartDate) {\n            date.setTime(date.getTime() - roundOffTime);\n        }\n        else {\n            date.setTime(date.getTime() + roundOffTime);\n        }\n        if (tierMode === 'Hour') {\n            date.setMinutes(isStartDate ? -120 : 120);\n        }\n        else if (tierMode === 'Minutes') {\n            date.setSeconds(isStartDate ? -120 : 120);\n        }\n        else {\n            date.setHours(isStartDate ? -48 : 48, 0, 0, 0);\n        }\n    };\n    Timeline.prototype.calculateNumberOfTimelineCells = function (newTimeline) {\n        var numberOfDays = Math.abs((this.parent.cloneProjectEndDate.getTime() -\n            this.parent.cloneProjectStartDate.getTime()) / (24 * 60 * 60 * 1000));\n        var count = newTimeline.bottomTier.count;\n        var unit = newTimeline.bottomTier.unit;\n        if (unit === 'Day') {\n            return numberOfDays / count;\n        }\n        else if (unit === 'Week') {\n            return (numberOfDays / count) / 7;\n        }\n        else if (unit === 'Month') {\n            return (numberOfDays / count) / 28;\n        }\n        else if (unit === 'Year') {\n            return (numberOfDays / count) / (12 * 28);\n        }\n        else if (unit === 'Hour') {\n            return numberOfDays * (24 / count);\n        }\n        else {\n            return numberOfDays * ((60 * 24) / count);\n        }\n    };\n    /**\n     * To validate time line unit.\n     *\n     * @returns {void}\n     * @private\n     */\n    Timeline.prototype.processTimelineUnit = function () {\n        var directProperty = ['timelineViewMode', 'timelineUnitSize', 'weekStartDay', 'weekendBackground'];\n        var innerProperty = {\n            'topTier': ['unit', 'format', 'count', 'formatter'],\n            'bottomTier': ['unit', 'format', 'count', 'formatter']\n        };\n        var tierUnits = ['Year', 'Month', 'Week', 'Day', 'Hour', 'Minutes'];\n        this.customTimelineSettings = this.customTimelineSettings ? this.customTimelineSettings :\n            this.extendFunction(this.parent.timelineSettings, directProperty, innerProperty);\n        if ((tierUnits.indexOf(this.customTimelineSettings.topTier.unit) === -1) &&\n            (tierUnits.indexOf(this.customTimelineSettings.bottomTier.unit) === -1)) {\n            this.customTimelineSettings.topTier.unit = tierUnits.indexOf(this.customTimelineSettings.timelineViewMode) !== -1 ?\n                this.customTimelineSettings.timelineViewMode : 'Week';\n            this.customTimelineSettings.bottomTier.unit = tierUnits.indexOf(this.customTimelineSettings.topTier.unit) !== 5 ?\n                tierUnits[tierUnits.indexOf(this.customTimelineSettings.topTier.unit) + 1] : 'None';\n        }\n        else if ((tierUnits.indexOf(this.customTimelineSettings.topTier.unit) !== -1 &&\n            tierUnits.indexOf(this.customTimelineSettings.bottomTier.unit) !== -1)\n            && (tierUnits.indexOf(this.customTimelineSettings.topTier.unit) >\n                tierUnits.indexOf(this.customTimelineSettings.bottomTier.unit))) {\n            this.customTimelineSettings.bottomTier.unit = this.customTimelineSettings.topTier.unit;\n        }\n        else {\n            this.customTimelineSettings.topTier.unit = tierUnits.indexOf(this.customTimelineSettings.topTier.unit) === -1 ?\n                'None' : this.customTimelineSettings.topTier.unit;\n            this.customTimelineSettings.bottomTier.unit = tierUnits.indexOf(this.customTimelineSettings.bottomTier.unit) === -1 ?\n                'None' : this.customTimelineSettings.bottomTier.unit;\n        }\n        this.topTier = this.customTimelineSettings.topTier.unit;\n        this.bottomTier = this.customTimelineSettings.bottomTier.unit;\n        this.previousIsSingleTier = this.isSingleTier;\n        this.isSingleTier = this.topTier === 'None' || this.bottomTier === 'None' ? true : false;\n    };\n    /**\n     * To validate timeline properties.\n     *\n     * @returns {void}\n     * @private\n     */\n    Timeline.prototype.processTimelineProperty = function () {\n        this.customTimelineSettings.topTier.count = (this.topTier === 'None') ?\n            1 : this.validateCount(this.customTimelineSettings.topTier.unit, this.customTimelineSettings.topTier.count, 'topTier');\n        this.customTimelineSettings.bottomTier.count = this.customTimelineSettings.bottomTier.unit === 'None' ?\n            1 : this.validateCount(this.customTimelineSettings.bottomTier.unit, this.customTimelineSettings.bottomTier.count, 'bottomTier');\n        this.customTimelineSettings.bottomTier.format = this.validateFormat(this.customTimelineSettings.bottomTier.unit, this.customTimelineSettings.bottomTier.format);\n        this.customTimelineSettings.topTier.format = this.validateFormat(this.topTier, this.customTimelineSettings.topTier.format);\n        this.customTimelineSettings.weekStartDay = this.customTimelineSettings.weekStartDay >= 0 &&\n            this.customTimelineSettings.weekStartDay <= 6 ? this.customTimelineSettings.weekStartDay : 0;\n        this.checkCurrentZoomingLevel();\n    };\n    /**\n     * To find the current zooming level of the Gantt control.\n     *\n     * @returns {void}\n     * @private\n     */\n    Timeline.prototype.calculateZoomingLevelsPerDayWidth = function () {\n        var collections = this.parent.zoomingLevels;\n        for (var i = 0; i < collections.length; i++) {\n            var perDayWidth = this.getPerDayWidth(collections[i].timelineUnitSize, collections[i].bottomTier.count, collections[i].bottomTier.unit);\n            collections[i].perDayWidth = perDayWidth;\n        }\n    };\n    /**\n     * To find the current zooming level of the Gantt control.\n     *\n     * @returns {void}\n     * @private\n     */\n    Timeline.prototype.checkCurrentZoomingLevel = function () {\n        var count = this.customTimelineSettings.bottomTier.unit !== 'None' ?\n            this.customTimelineSettings.bottomTier.count : this.customTimelineSettings.topTier.count;\n        var unit = this.customTimelineSettings.bottomTier.unit !== 'None' ?\n            this.customTimelineSettings.bottomTier.unit : this.customTimelineSettings.topTier.unit;\n        var zoomLevel = this.getCurrentZoomingLevel(unit, count);\n        if (this.parent.toolbarModule) {\n            if (zoomLevel === this.parent.zoomingLevels[this.parent.zoomingLevels.length - 1].level) {\n                this.parent.toolbarModule.enableItems([this.parent.controlId + '_zoomin'], false);\n            }\n            else if (zoomLevel === this.parent.zoomingLevels[0].level) {\n                this.parent.toolbarModule.enableItems([this.parent.controlId + '_zoomout'], false);\n            }\n        }\n        this.parent.currentZoomingLevel = this.parent.zoomingLevels[zoomLevel];\n        return zoomLevel;\n    };\n    /**\n     * @param {string} unit .\n     * @param {number} count .\n     * @returns {number} .\n     * @private\n     */\n    Timeline.prototype.getCurrentZoomingLevel = function (unit, count) {\n        var level;\n        var currentZoomCollection;\n        var checkSameCountLevels;\n        var secondValue;\n        var firstValue;\n        if (!this.parent.zoomingLevels.length) {\n            this.parent.zoomingLevels = this.parent.getZoomingLevels();\n        }\n        var sameUnitLevels = this.parent.zoomingLevels.filter(function (tempLevel) {\n            return tempLevel.bottomTier.unit === unit;\n        });\n        if (sameUnitLevels.length === 0) {\n            var closestUnit_1 = this.getClosestUnit(unit, '', false);\n            sameUnitLevels = this.parent.zoomingLevels.filter(function (tempLevel) {\n                return tempLevel.bottomTier.unit === closestUnit_1;\n            });\n        }\n        var sortedUnitLevels = sameUnitLevels.sort(function (a, b) {\n            return (a.bottomTier.count < b.bottomTier.count) ? 1 : -1;\n        });\n        for (var i = 0; i < sortedUnitLevels.length; i++) {\n            firstValue = sortedUnitLevels[i];\n            if (i === sortedUnitLevels.length - 1) {\n                level = sortedUnitLevels[i].level;\n                break;\n            }\n            else {\n                secondValue = sortedUnitLevels[i + 1];\n            }\n            if (count >= firstValue.bottomTier.count) {\n                currentZoomCollection = sortedUnitLevels[i];\n                checkSameCountLevels = sortedUnitLevels.filter(function (tempLevel) {\n                    return tempLevel.bottomTier.count === currentZoomCollection.bottomTier.count;\n                });\n                if (checkSameCountLevels.length > 1) {\n                    level = this.checkCollectionsWidth(checkSameCountLevels);\n                }\n                else {\n                    level = checkSameCountLevels[0].level;\n                }\n                break;\n            }\n            else if (count < firstValue.bottomTier.count && count > secondValue.bottomTier.count) {\n                currentZoomCollection = sortedUnitLevels[i + 1];\n                checkSameCountLevels = sortedUnitLevels.filter(function (tempLevel) {\n                    return tempLevel.bottomTier.count === currentZoomCollection.bottomTier.count;\n                });\n                if (checkSameCountLevels.length > 1) {\n                    level = this.checkCollectionsWidth(checkSameCountLevels);\n                }\n                else {\n                    level = checkSameCountLevels[0].level;\n                }\n                break;\n            }\n        }\n        return level;\n    };\n    /**\n     * Getting closest zooimg level.\n     *\n     * @param {string} unit .\n     * @param {string} closetUnit .\n     * @param {boolean} isCont .\n     * @returns {string} .\n     * @private\n     */\n    Timeline.prototype.getClosestUnit = function (unit, closetUnit, isCont) {\n        var bottomTierUnits = ['Year', 'Month', 'Week', 'Day', 'Hour', 'Minutes'];\n        var index = bottomTierUnits.indexOf(unit);\n        if (index === 0) {\n            isCont = true;\n        }\n        if (this.isZoomIn || isCont) {\n            unit = bottomTierUnits[index + 1];\n        }\n        else {\n            unit = bottomTierUnits[index - 1];\n        }\n        var sameUnitLevels = this.parent.zoomingLevels.filter(function (tempLevel) {\n            return tempLevel.bottomTier.unit === unit;\n        });\n        if (sameUnitLevels.length === 0) {\n            if (unit === 'Year') {\n                isCont = true;\n            }\n            closetUnit = unit;\n            return this.getClosestUnit(unit, closetUnit, isCont);\n        }\n        else {\n            return unit;\n        }\n    };\n    Timeline.prototype.checkCollectionsWidth = function (checkSameLevels) {\n        var zoomLevels = checkSameLevels;\n        var width = this.customTimelineSettings.timelineUnitSize;\n        var level;\n        var secondValue;\n        var firstValue;\n        var sortedZoomLevels = zoomLevels.sort(function (a, b) {\n            return (a.timelineUnitSize < b.timelineUnitSize) ? 1 : -1;\n        });\n        for (var i = 0; i < sortedZoomLevels.length; i++) {\n            firstValue = sortedZoomLevels[i];\n            if (i === sortedZoomLevels.length - 1) {\n                level = sortedZoomLevels[i].level;\n                break;\n            }\n            else {\n                secondValue = sortedZoomLevels[i + 1];\n            }\n            if (width >= firstValue.timelineUnitSize) {\n                level = sortedZoomLevels[i].level;\n                break;\n            }\n            else if (width < firstValue.timelineUnitSize && width > secondValue.timelineUnitSize) {\n                level = sortedZoomLevels[i + 1].level;\n                break;\n            }\n        }\n        return level;\n    };\n    /**\n     * To create timeline header template.\n     *\n     * @returns {void}\n     * @private\n     */\n    Timeline.prototype.updateTimelineHeaderHeight = function () {\n        if (this.parent.timelineModule.isSingleTier) {\n            addClass([this.parent.ganttChartModule.chartTimelineContainer], cls.timelineSingleHeaderOuterDiv);\n            if (this.parent.treeGrid.element) {\n                addClass(this.parent.treeGrid.element.querySelectorAll('.e-headercell'), cls.timelineSingleHeaderOuterDiv);\n                addClass(this.parent.treeGrid.element.querySelectorAll('.e-columnheader'), cls.timelineSingleHeaderOuterDiv);\n            }\n        }\n        else {\n            removeClass([this.parent.ganttChartModule.chartTimelineContainer], cls.timelineSingleHeaderOuterDiv);\n            if (this.parent.treeGrid.element) {\n                removeClass(this.parent.treeGrid.element.querySelectorAll('.e-headercell'), cls.timelineSingleHeaderOuterDiv);\n                removeClass(this.parent.treeGrid.element.querySelectorAll('.e-columnheader'), cls.timelineSingleHeaderOuterDiv);\n            }\n        }\n        if (this.previousIsSingleTier !== this.isSingleTier) {\n            var toolbarHeight = 0;\n            if (!isNullOrUndefined(this.parent.toolbarModule) && !isNullOrUndefined(this.parent.toolbarModule.element)) {\n                toolbarHeight = this.parent.toolbarModule.element.offsetHeight;\n            }\n            this.parent.ganttChartModule.scrollObject.\n                setHeight(this.parent.ganttHeight - this.parent.ganttChartModule.chartTimelineContainer.offsetHeight - toolbarHeight);\n            this.parent.treeGrid.height = this.parent.ganttHeight - toolbarHeight -\n                this.parent.ganttChartModule.chartTimelineContainer.offsetHeight;\n        }\n    };\n    /**\n     * To create timeline header template.\n     *\n     * @returns {void}\n     * @private\n     */\n    Timeline.prototype.createTimelineSeries = function () {\n        var tr;\n        var td;\n        var div;\n        var table;\n        var thead;\n        var loopCount = this.isSingleTier ? 1 : 2;\n        var tier = this.topTier === 'None' ? 'bottomTier' : 'topTier';\n        this.updateTimelineHeaderHeight();\n        this.topTierCollection = [];\n        this.bottomTierCollection = [];\n        for (var count = 0; count < loopCount; count++) {\n            table = createElement('table', { className: cls.timelineHeaderTableContainer, styles: 'display: block;' });\n            thead = createElement('thead', { className: cls.timelineHeaderTableBody, styles: 'display:block; border-collapse:collapse' });\n            tr = createElement('tr', { innerHTML: this.createTimelineTemplate(tier) });\n            td = createElement('th');\n            div = createElement('div', { styles: 'width: 20px' });\n            td.appendChild(div);\n            tr.appendChild(td);\n            thead.appendChild(tr);\n            table.appendChild(thead);\n            this.parent.ganttChartModule.chartTimelineContainer.appendChild(table);\n            tier = 'bottomTier';\n            tr = null;\n        }\n    };\n    /**\n     * To validate timeline tier count.\n     *\n     * @param {string} mode .\n     * @param {number} count .\n     * @param {string} tier .\n     * @returns {number} .\n     * @private\n     */\n    Timeline.prototype.validateCount = function (mode, count, tier) {\n        var tierCount = !isNullOrUndefined(count) && parseInt(count.toString(), 10) > 0 ? parseInt(count.toString(), 10) : 1;\n        var timeDifference = Math.abs(this.timelineRoundOffEndDate.getTime() - this.timelineStartDate.getTime());\n        var difference;\n        switch (mode) {\n            case 'Year':\n                difference = Math.round((timeDifference / (1000 * 3600 * 24)) / (12 * 28));\n                tierCount = tierCount <= difference ? tierCount : difference > 0 ? difference : 1;\n                if (this.topTier !== 'None' && tier === 'bottomTier') {\n                    tierCount = this.validateBottomTierCount(mode, tierCount);\n                }\n                break;\n            case 'Month':\n                difference = Math.round((timeDifference / (1000 * 3600 * 24)) / 28);\n                tierCount = tierCount <= difference ? tierCount : difference > 0 ? difference : 1;\n                if (this.topTier !== 'None' && tier === 'bottomTier') {\n                    tierCount = this.validateBottomTierCount(mode, tierCount);\n                }\n                break;\n            case 'Week':\n                difference = Math.round((timeDifference / (1000 * 3600 * 24)) / 7);\n                tierCount = tierCount <= difference ? tierCount : difference > 0 ? difference : 1;\n                if (this.topTier !== 'None' && tier === 'bottomTier') {\n                    tierCount = this.validateBottomTierCount(mode, tierCount);\n                }\n                break;\n            case 'Day':\n                difference = Math.round(timeDifference / (1000 * 3600 * 24));\n                tierCount = tierCount <= difference ? tierCount : difference > 0 ? difference : 1;\n                if (this.topTier !== 'None' && tier === 'bottomTier') {\n                    tierCount = this.validateBottomTierCount(mode, tierCount);\n                }\n                break;\n            case 'Hour':\n                difference = Math.round(timeDifference / (1000 * 3600));\n                tierCount = tierCount <= difference ? tierCount : difference > 0 ? difference : 1;\n                if (this.topTier !== 'None' && tier === 'bottomTier') {\n                    tierCount = this.validateBottomTierCount(mode, tierCount);\n                }\n                break;\n            case 'Minutes':\n                difference = Math.round(timeDifference / (1000 * 60));\n                tierCount = tierCount <= difference ? tierCount : difference > 0 ? difference : 1;\n                if (this.topTier !== 'None' && tier === 'bottomTier') {\n                    tierCount = this.validateBottomTierCount(mode, tierCount);\n                }\n                break;\n        }\n        if (count !== tierCount && this.isZooming && this.parent.toolbarModule && (tier === 'bottomTier' || this.isSingleTier)) {\n            if (this.isZoomIn) {\n                this.parent.toolbarModule.enableItems([this.parent.controlId + '_zoomin'], false);\n            }\n            else {\n                this.parent.toolbarModule.enableItems([this.parent.controlId + '_zoomout'], false);\n            }\n        }\n        return tierCount;\n    };\n    /**\n     * To validate bottom tier count.\n     *\n     * @param {string} mode .\n     * @param {number} tierCount .\n     * @returns {number} .\n     * @private\n     */\n    Timeline.prototype.validateBottomTierCount = function (mode, tierCount) {\n        var count;\n        switch (mode) {\n            case 'Year':\n                count = tierCount <= this.customTimelineSettings.topTier.count ?\n                    tierCount : this.customTimelineSettings.topTier.count;\n                break;\n            case 'Month':\n                count = this.topTier === 'Year' ? tierCount <= (this.customTimelineSettings.topTier.count * 12) ?\n                    tierCount : (this.customTimelineSettings.topTier.count * 12) :\n                    tierCount <= this.customTimelineSettings.topTier.count ?\n                        tierCount : this.customTimelineSettings.topTier.count;\n                break;\n            case 'Week':\n                count = this.topTier === 'Year' ? tierCount <= (this.customTimelineSettings.topTier.count * (12 * 4)) ?\n                    tierCount : (this.customTimelineSettings.topTier.count * (12 * 4)) :\n                    this.topTier === 'Month' ? tierCount <= (this.customTimelineSettings.topTier.count * 4) ?\n                        tierCount : (this.customTimelineSettings.topTier.count * 4) :\n                        tierCount <= this.customTimelineSettings.topTier.count ?\n                            tierCount : this.customTimelineSettings.topTier.count;\n                break;\n            case 'Day':\n                count = this.topTier === 'Year' ? tierCount <= (this.customTimelineSettings.topTier.count * (12 * 28)) ?\n                    tierCount : (this.customTimelineSettings.topTier.count * (12 * 28)) :\n                    this.topTier === 'Month' ? tierCount <= (this.customTimelineSettings.topTier.count * 28) ?\n                        tierCount : (this.customTimelineSettings.topTier.count * 28) :\n                        this.topTier === 'Week' ? tierCount <= (this.customTimelineSettings.topTier.count * 7) ?\n                            tierCount : (this.customTimelineSettings.topTier.count * 7) :\n                            tierCount <= this.customTimelineSettings.topTier.count ? tierCount : this.customTimelineSettings.topTier.count;\n                break;\n            case 'Hour':\n                count = this.topTier === 'Year' ? tierCount <= (this.customTimelineSettings.topTier.count * (12 * 28 * 24)) ?\n                    tierCount : (this.customTimelineSettings.topTier.count * (12 * 28 * 24)) :\n                    this.topTier === 'Month' ? tierCount <= (this.customTimelineSettings.topTier.count * (28 * 24)) ?\n                        tierCount : (this.customTimelineSettings.topTier.count * (28 * 24)) :\n                        this.topTier === 'Week' ? tierCount <= (this.customTimelineSettings.topTier.count * 7 * 24) ?\n                            tierCount : (this.customTimelineSettings.topTier.count * 7 * 24) :\n                            this.topTier === 'Day' ? tierCount <= (this.customTimelineSettings.topTier.count * 24) ?\n                                tierCount : (this.customTimelineSettings.topTier.count * 24) :\n                                tierCount <= this.customTimelineSettings.topTier.count ?\n                                    tierCount : this.customTimelineSettings.topTier.count;\n                break;\n            case 'Minutes':\n                count = this.topTier === 'Year' ? tierCount <= (this.customTimelineSettings.topTier.count * (12 * 28 * 24 * 60)) ?\n                    tierCount : (this.customTimelineSettings.topTier.count * (12 * 28 * 24 * 60)) :\n                    this.topTier === 'Month' ? tierCount <= (this.customTimelineSettings.topTier.count * (28 * 24 * 60)) ?\n                        tierCount : (this.customTimelineSettings.topTier.count * (28 * 24 * 60)) :\n                        this.topTier === 'Week' ? tierCount <= (this.customTimelineSettings.topTier.count * 7 * 24 * 60) ?\n                            tierCount : (this.customTimelineSettings.topTier.count * 7 * 24 * 60) :\n                            this.topTier === 'Day' ? tierCount <= (this.customTimelineSettings.topTier.count * 24 * 60) ?\n                                tierCount : (this.customTimelineSettings.topTier.count * 24 * 60) :\n                                this.topTier === 'Hour' ? tierCount <= (this.customTimelineSettings.topTier.count * 60) ?\n                                    tierCount : (this.customTimelineSettings.topTier.count * 60) :\n                                    tierCount <= this.customTimelineSettings.topTier.count ?\n                                        tierCount : this.customTimelineSettings.topTier.count;\n                break;\n        }\n        return count;\n    };\n    /**\n     * To validate timeline tier format.\n     *\n     * @param {string} mode .\n     * @param {string} format .\n     * @returns {string} .\n     * @private\n     */\n    Timeline.prototype.validateFormat = function (mode, format) {\n        var tierFormat;\n        switch (mode) {\n            case 'Week':\n                tierFormat = !format ? 'MMM dd, yyyy' : format;\n                break;\n            case 'Day':\n            case 'None':\n                tierFormat = !format ? '' : format;\n                break;\n            case 'Hour':\n                tierFormat = !format ? 'H' : format;\n                break;\n            case 'Month':\n                tierFormat = !format ? 'MMM yyyy' : format;\n                break;\n            case 'Year':\n                tierFormat = !format ? 'yyyy' : format;\n                break;\n            case 'Minutes':\n                tierFormat = !format ? 'm' : format;\n                break;\n        }\n        return tierFormat;\n    };\n    /**\n     * To perform extend operation.\n     *\n     * @param {object} cloneObj .\n     * @param {string[]} propertyCollection .\n     * @param {object} innerProperty .\n     * @returns {object} .\n     * @private\n     */\n    Timeline.prototype.extendFunction = function (cloneObj, propertyCollection, innerProperty) {\n        var _this = this;\n        var tempObj = {};\n        for (var index = 0; index < propertyCollection.length; index++) {\n            tempObj[propertyCollection[index]] = cloneObj[propertyCollection[index]];\n        }\n        if (innerProperty) {\n            Object.keys(innerProperty).forEach(function (key) {\n                tempObj[key] = _this.extendFunction(cloneObj[key], innerProperty[key], null);\n            });\n        }\n        return tempObj;\n    };\n    /**\n     * To format date.\n     *\n     * @param {string} dayFormat .\n     * @param {Date} data .\n     * @returns {string} .\n     * @private\n     */\n    Timeline.prototype.formatDateHeader = function (dayFormat, data) {\n        var date = new Date(data.getTime());\n        var dateString;\n        if (dayFormat === '') {\n            dateString = this.parent.globalize.formatDate(date, { format: 'E' });\n            if (this.parent.locale === 'zh') {\n                dateString = dateString.slice(1);\n            }\n            else {\n                dateString = dateString.slice(0, 1);\n            }\n        }\n        else {\n            dateString = this.parent.globalize.formatDate(date, { format: dayFormat });\n        }\n        return dateString;\n    };\n    /**\n     * Custom Formatting.\n     *\n     * @param {Date} date .\n     * @param {string} format .\n     * @param {string} tier .\n     * @param {string} mode .\n     * @param {string | ITimelineFormatter} formatter .\n     * @returns {string} .\n     * @private\n     */\n    Timeline.prototype.customFormat = function (date, format, tier, mode, formatter) {\n        formatter = (typeof formatter === 'string' ? getValue(formatter, window) : formatter);\n        return formatter(date, format, tier, mode);\n    };\n    /**\n     * To create timeline template .\n     *\n     * @param {string} tier .\n     * @returns {string} .\n     * @private\n     */\n    Timeline.prototype.createTimelineTemplate = function (tier) {\n        var parent = this.parent;\n        var parentTh = '';\n        var parentTr = '';\n        var mode = tier === 'topTier' ?\n            parent.timelineModule.customTimelineSettings.topTier.unit : parent.timelineModule.customTimelineSettings.bottomTier.unit;\n        var count = tier === 'topTier' ? parent.timelineModule.customTimelineSettings.topTier.count :\n            parent.timelineModule.customTimelineSettings.bottomTier.count;\n        var increment;\n        var newTime;\n        var startDate = new Date(this.parent.timelineModule.timelineStartDate.toString());\n        var endDate = new Date(this.timelineRoundOffEndDate.toString());\n        var scheduleDateCollection = [];\n        do {\n            // PDf export collection\n            var timelineCell = {};\n            timelineCell.startDate = new Date(startDate.getTime());\n            parentTr = this.getHeaterTemplateString(new Date(startDate.toString()), mode, tier, false, count, timelineCell);\n            scheduleDateCollection.push(new Date(startDate.toString()));\n            increment = this.getIncrement(startDate, count, mode);\n            newTime = startDate.getTime() + increment;\n            startDate.setTime(newTime);\n            if (startDate >= endDate) {\n                /* eslint-disable-next-line */\n                parentTr = this.getHeaterTemplateString(scheduleDateCollection[scheduleDateCollection.length - 1], mode, tier, true, count, timelineCell);\n            }\n            parentTh = parentTh + parentTr;\n            var tierCollection = tier === 'topTier' ? this.topTierCollection : this.bottomTierCollection;\n            timelineCell.endDate = new Date(startDate.getTime());\n            tierCollection.push(timelineCell);\n        } while ((startDate < endDate));\n        return parentTh;\n    };\n    Timeline.prototype.getTimelineRoundOffEndDate = function (date) {\n        var tierMode = this.topTier === 'None' ? this.bottomTier : this.topTier;\n        var endDate = new Date(date.toString());\n        if (this.parent.isTimelineRoundOff) {\n            if (tierMode === 'Hour') {\n                endDate.setMinutes(60);\n            }\n            else if (tierMode === 'Minutes') {\n                endDate.setSeconds(60);\n            }\n            else {\n                endDate.setHours(24, 0, 0, 0);\n            }\n        }\n        return endDate;\n    };\n    /**\n     *\n     * @param {Date} startDate .\n     * @param {number} count .\n     * @param {string} mode .\n     * @returns {number} .\n     * @private\n     */\n    Timeline.prototype.getIncrement = function (startDate, count, mode) {\n        var firstDay = new Date(startDate.getTime());\n        var lastDay = new Date(startDate.getTime());\n        var increment;\n        switch (mode) {\n            case 'Year':\n                firstDay = startDate;\n                lastDay = new Date(startDate.getFullYear() + (count - 1), 11, 31);\n                increment = (lastDay.getTime() - firstDay.getTime()) + (1000 * 60 * 60 * 24);\n                break;\n            case 'Month':\n                firstDay = startDate;\n                lastDay = new Date(startDate.getFullYear(), startDate.getMonth() + count, 1);\n                increment = lastDay.getTime() - firstDay.getTime();\n                break;\n            case 'Week':\n                {\n                    var dayIndex = this.parent.timelineModule.customTimelineSettings.weekStartDay;\n                    var dayIntervel = startDate.getDay() < dayIndex ? (dayIndex - startDate.getDay()) :\n                        (6 - startDate.getDay()) + dayIndex;\n                    count = dayIntervel > 0 ? count - 1 : 0;\n                    lastDay.setHours(24, 0, 0, 0);\n                    dayIntervel = startDate.getDay() < dayIndex ? dayIntervel > 0 ?\n                        dayIntervel - 1 : dayIntervel : dayIntervel;\n                    lastDay.setDate(lastDay.getDate() + (dayIntervel + (7 * count)));\n                    increment = lastDay.getTime() - firstDay.getTime();\n                    break;\n                }\n            case 'Day':\n                lastDay.setHours(24, 0, 0, 0);\n                increment = (lastDay.getTime() - firstDay.getTime()) + (1000 * 60 * 60 * 24 * (count - 1));\n                break;\n            case 'Hour':\n                lastDay.setMinutes(60);\n                lastDay.setSeconds(0);\n                increment = (lastDay.getTime() - firstDay.getTime()) + (1000 * 60 * 60 * (count - 1));\n                break;\n            case 'Minutes':\n                lastDay.setSeconds(60);\n                increment = (lastDay.getTime() - firstDay.getTime()) + (1000 * 60 * (count - 1));\n                break;\n        }\n        return increment;\n    };\n    /**\n     * Method to find header cell was weekend or not\n     *\n     * @param {string} mode .\n     * @param {string} tier .\n     * @param {Date} day .\n     * @returns {boolean} .\n     */\n    Timeline.prototype.isWeekendHeaderCell = function (mode, tier, day) {\n        return (mode === 'Day' || mode === 'Hour' || mode === 'Minutes') && (this.customTimelineSettings[tier].count === 1 ||\n            mode === 'Hour' || mode === 'Minutes') &&\n            this.parent.nonWorkingDayIndex.indexOf(day.getDay()) !== -1;\n    };\n    /**\n     * To construct template string.\n     *\n     * @param {Date} scheduleWeeks .\n     * @param {string} mode .\n     * @param {string} tier .\n     * @param {boolean} isLast .\n     * @param {number} count .\n     * @param {TimelineFormat} timelineCell .\n     * @returns {string} .\n     * @private\n     */\n    /* eslint-disable-next-line */\n    Timeline.prototype.getHeaterTemplateString = function (scheduleWeeks, mode, tier, isLast, count, timelineCell) {\n        var parentTr = '';\n        var td = '';\n        var format = tier === 'topTier' ?\n            this.parent.timelineModule.customTimelineSettings.topTier.format :\n            this.parent.timelineModule.customTimelineSettings.bottomTier.format;\n        var formatter = tier === 'topTier' ?\n            this.parent.timelineModule.customTimelineSettings.topTier.formatter :\n            this.parent.timelineModule.customTimelineSettings.bottomTier.formatter;\n        var thWidth;\n        var date = isNullOrUndefined(formatter) ?\n            this.parent.globalize.formatDate(scheduleWeeks, { format: this.parent.getDateFormat() }) :\n            this.customFormat(scheduleWeeks, format, tier, mode, formatter);\n        thWidth = (this.getIncrement(scheduleWeeks, count, mode) / (1000 * 60 * 60 * 24)) * this.parent.perDayWidth;\n        var cellWidth = thWidth;\n        thWidth = isLast ? this.calculateWidthBetweenTwoDate(mode, scheduleWeeks, this.timelineRoundOffEndDate)\n            : thWidth;\n        var isWeekendCell = this.isWeekendHeaderCell(mode, tier, scheduleWeeks);\n        var textClassName = tier === 'topTier' ? ' e-gantt-top-cell-text' : '';\n        var value = (isNullOrUndefined(formatter) ? this.formatDateHeader(format, scheduleWeeks) :\n            this.customFormat(scheduleWeeks, format, tier, mode, formatter));\n        td += this.parent.timelineModule.isSingleTier ?\n            '<th class=\"' + cls.timelineSingleHeaderCell + ' ' : '<th class=\"' + cls.timelineTopHeaderCell;\n        td += isWeekendCell ? ' ' + cls.weekendHeaderCell : '';\n        td += '\" tabindex=\"-1\" aria-label= \"' + this.parent.localeObj.getConstant('timelineCell') + ' ' + date;\n        td += '\" style=\"width:' + thWidth + 'px;';\n        td += isWeekendCell && this.customTimelineSettings.weekendBackground ?\n            'background-color:' + this.customTimelineSettings.weekendBackground + ';' : '';\n        td += '\"><div class=\"' + cls.timelineHeaderCellLabel + textClassName + '\" style=\"width:' +\n            (thWidth - 1) + 'px;' + (this.parent.timelineSettings.showTooltip ? '\"title=\"' + date : '');\n        td += '\">' + value + '</div>';\n        parentTr += td;\n        parentTr += '</th>';\n        if ((this.isSingleTier || tier === 'topTier') && !isLast) {\n            this.totalTimelineWidth = this.totalTimelineWidth + thWidth;\n        }\n        else if ((this.isSingleTier || tier === 'topTier') && isLast) {\n            this.totalTimelineWidth = (this.totalTimelineWidth - cellWidth) + thWidth;\n        }\n        // PDf export collection\n        timelineCell.value = value;\n        timelineCell.isWeekend = isWeekendCell;\n        timelineCell.width = cellWidth;\n        return parentTr;\n    };\n    /**\n     * To calculate last 'th' width.\n     *\n     * @param {string} mode .\n     * @param {Date} scheduleWeeks .\n     * @param {Date} endDate .\n     * @returns {number} .\n     * @private\n     */\n    Timeline.prototype.calculateWidthBetweenTwoDate = function (mode, scheduleWeeks, endDate) {\n        var balanceDay = ((endDate.getTime() - scheduleWeeks.getTime()) / (1000 * 60 * 60 * 24));\n        return balanceDay * this.parent.perDayWidth;\n    };\n    /**\n     * To calculate timeline width.\n     *\n     * @returns {void} .\n     * @private\n     */\n    Timeline.prototype.timelineWidthCalculation = function () {\n        var timelineUnitSize = this.customTimelineSettings.timelineUnitSize;\n        var bottomTierCount = this.customTimelineSettings.bottomTier.count;\n        var topTierCount = this.customTimelineSettings.topTier.count;\n        this.bottomTierCellWidth = timelineUnitSize;\n        if (this.bottomTier === 'None') {\n            this.parent.perDayWidth = this.getPerDayWidth(timelineUnitSize, topTierCount, this.topTier);\n        }\n        else {\n            this.parent.perDayWidth = this.getPerDayWidth(timelineUnitSize, bottomTierCount, this.bottomTier);\n        }\n        this.topTierCellWidth = this.bottomTier !== 'None' ? this.topTier === 'Week' ?\n            this.parent.perDayWidth * 7 : this.topTier === 'Hour' ?\n            this.parent.perDayWidth / 24 : this.topTier === 'Minutes' ?\n            this.parent.perDayWidth / (24 * 60) : this.parent.perDayWidth : timelineUnitSize;\n        this.topTierCellWidth = this.isSingleTier ? this.topTierCellWidth : this.topTierCellWidth * topTierCount;\n    };\n    /**\n     * To validate per day width.\n     *\n     * @param {number} timelineUnitSize .\n     * @param {number} bottomTierCount .\n     * @param {string} mode .\n     * @returns {number} .\n     * @private\n     */\n    Timeline.prototype.getPerDayWidth = function (timelineUnitSize, bottomTierCount, mode) {\n        var perDayWidth;\n        switch (mode) {\n            case 'Year':\n                perDayWidth = (timelineUnitSize / bottomTierCount) / (12 * 28);\n                break;\n            case 'Month':\n                perDayWidth = (timelineUnitSize / bottomTierCount) / 28;\n                break;\n            case 'Week':\n                perDayWidth = (timelineUnitSize / bottomTierCount) / 7;\n                break;\n            case 'Day':\n                perDayWidth = timelineUnitSize / bottomTierCount;\n                break;\n            case 'Hour':\n                perDayWidth = (24 / bottomTierCount) * timelineUnitSize;\n                break;\n            case 'Minutes':\n                perDayWidth = ((60 * 24) / bottomTierCount) * timelineUnitSize;\n                break;\n        }\n        return perDayWidth;\n    };\n    /**\n     * To validate project start date and end date.\n     *\n     * @returns {void} .\n     * @private\n     */\n    Timeline.prototype.roundOffDays = function () {\n        var startDate = this.parent.cloneProjectStartDate;\n        var endDate = this.parent.cloneProjectEndDate;\n        var tierMode = this.topTier === 'None' ? this.bottomTier : this.topTier;\n        if (this.parent.isTimelineRoundOff) {\n            if (tierMode === 'Year') {\n                startDate = new Date(startDate.getFullYear(), 0, 1);\n                endDate = new Date(endDate.getFullYear(), 11, 31);\n            }\n            else if (tierMode === 'Month') {\n                startDate = new Date(startDate.getFullYear(), startDate.getMonth(), 1);\n                endDate = new Date(endDate.getFullYear(), endDate.getMonth() + 1, 0);\n            }\n            else if (tierMode === 'Week') {\n                var dayIndex = this.parent.timelineModule.customTimelineSettings.weekStartDay;\n                var roundOffStartDate = startDate.getDay() < dayIndex ?\n                    (startDate.getDate()) - (7 - dayIndex + startDate.getDay()) :\n                    (startDate.getDate()) - startDate.getDay() + dayIndex;\n                startDate.setDate(roundOffStartDate);\n                var first = endDate.getDate() - endDate.getDay();\n                var last = first + 6 + dayIndex;\n                endDate.setDate(last);\n            }\n            if (tierMode === 'Hour') {\n                startDate.setMinutes(0);\n            }\n            else if (tierMode === 'Minutes') {\n                startDate.setSeconds(0);\n            }\n            else {\n                startDate.setHours(0, 0, 0, 0);\n            }\n        }\n        this.timelineStartDate = startDate;\n        this.timelineEndDate = endDate;\n        this.timelineRoundOffEndDate = this.getTimelineRoundOffEndDate(this.timelineEndDate);\n    };\n    /**\n     * To validate project start date and end date.\n     *\n     * @param {string} mode .\n     * @param {string} span .\n     * @param {Date} startDate .\n     * @param {Date} endDate .\n     * @returns {void} .\n     * @private\n     */\n    Timeline.prototype.updateScheduleDatesByToolBar = function (mode, span, startDate, endDate) {\n        if (mode === 'Year') {\n            if (span === 'prevTimeSpan') {\n                if (startDate.getMonth() === 0) {\n                    startDate = new Date(startDate.getFullYear() - 1, 0, 1);\n                }\n                else {\n                    startDate = new Date(startDate.getFullYear(), 0, 1);\n                }\n            }\n            else {\n                if (endDate.getMonth() === 11) {\n                    endDate = new Date(endDate.getFullYear() + 1, 0, 1);\n                }\n                else {\n                    endDate = new Date(endDate.getFullYear(), 12, 1);\n                }\n            }\n        }\n        if (mode === 'Month') {\n            if (span === 'prevTimeSpan') {\n                if (startDate.getDate() === 1) {\n                    startDate = new Date(startDate.getFullYear(), startDate.getMonth() - 1, 1);\n                }\n                else {\n                    startDate = new Date(startDate.getFullYear(), startDate.getMonth(), 1);\n                }\n            }\n            else {\n                endDate = new Date(endDate.getFullYear(), endDate.getMonth() + 1, 1);\n            }\n        }\n        if (mode === 'Week') {\n            var dayIndex = this.parent.timelineModule.customTimelineSettings.weekStartDay;\n            var dayIntervel = void 0;\n            if (span === 'prevTimeSpan') {\n                dayIntervel = startDate.getDay() < dayIndex ? 7 - (dayIndex - startDate.getDay()) :\n                    startDate.getDay() - dayIndex;\n                startDate.setHours(0, 0, 0, 0);\n                if (dayIntervel === 0) {\n                    startDate.setDate(startDate.getDate() - 7);\n                }\n                else {\n                    startDate.setDate(startDate.getDate() - dayIntervel);\n                }\n            }\n            else {\n                dayIntervel = endDate.getDay() < dayIndex ? (dayIndex - endDate.getDay()) :\n                    (7 - endDate.getDay()) + dayIndex;\n                endDate.setHours(0, 0, 0, 0);\n                if (dayIntervel === 0) {\n                    endDate.setDate(endDate.getDate() + 6);\n                }\n                else {\n                    endDate.setDate(endDate.getDate() + dayIntervel);\n                }\n            }\n        }\n        if (mode === 'Day') {\n            if (span === 'prevTimeSpan') {\n                if (startDate.getHours() === 0) {\n                    startDate.setTime(startDate.getTime() - (1000 * 60 * 60 * 24));\n                }\n                else {\n                    startDate.setHours(0);\n                }\n            }\n            else {\n                if (endDate.getHours() === 0) {\n                    endDate.setTime(endDate.getTime() + (1000 * 60 * 60 * 24));\n                }\n                else {\n                    endDate.setHours(24);\n                }\n            }\n        }\n        if (mode === 'Hour') {\n            if (span === 'prevTimeSpan') {\n                if (startDate.getMinutes() === 0) {\n                    startDate.setTime(startDate.getTime() - (1000 * 60 * 60));\n                }\n                else {\n                    startDate.setMinutes(0);\n                }\n            }\n            else {\n                if (endDate.getMinutes() === 0) {\n                    endDate.setTime(endDate.getTime() + (1000 * 60 * 60));\n                }\n                else {\n                    endDate.setMinutes(60);\n                }\n            }\n        }\n        if (mode === 'Minutes') {\n            if (span === 'prevTimeSpan') {\n                if (startDate.getSeconds() === 0) {\n                    startDate.setTime(startDate.getTime() - (1000 * 60));\n                }\n                else {\n                    startDate.setSeconds(0);\n                }\n            }\n            else {\n                if (endDate.getSeconds() === 0) {\n                    endDate.setTime(endDate.getTime() + (1000 * 60));\n                }\n                else {\n                    endDate.setSeconds(60);\n                }\n            }\n        }\n        this.parent.cloneProjectStartDate = startDate;\n        this.parent.cloneProjectEndDate = endDate;\n    };\n    /**\n     * To validate project start date and end date.\n     *\n     * @param {IGanttData[]} tempArray .\n     * @param {string} action .\n     * @returns {void} .\n     * @private\n     */\n    Timeline.prototype.updateTimeLineOnEditing = function (tempArray, action) {\n        if (tempArray[0].length >= 1) {\n            for (var i = 0; i < tempArray.length; i++) {\n                /* eslint-disable-next-line */\n                var temp = tempArray[i];\n                var filteredStartDateRecord = temp.filter(function (pdc) { return !isNullOrUndefined(pdc.ganttProperties.startDate); });\n                var filteredEndDateRecord = temp.filter(function (pdc) { return !isNullOrUndefined(pdc.ganttProperties.endDate); });\n                var minStartDate = filteredStartDateRecord.length > 0 ?\n                    new Date(DataUtil.aggregates.min(filteredStartDateRecord, 'ganttProperties.startDate')) : null;\n                var maxEndDate = filteredEndDateRecord.length > 0 ?\n                    new Date(DataUtil.aggregates.max(filteredEndDateRecord, 'ganttProperties.endDate')) : null;\n                var validStartDate = new Date(this.parent.dataOperation.checkStartDate(this.timelineStartDate).getTime());\n                var validEndDate = new Date(this.parent.dataOperation.checkEndDate(this.timelineEndDate).getTime());\n                var maxStartLeft = isNullOrUndefined(minStartDate) ?\n                    null : this.parent.dataOperation.getTaskLeft(minStartDate, false);\n                var maxEndLeft = isNullOrUndefined(maxEndDate) ?\n                    null : this.parent.dataOperation.getTaskLeft(maxEndDate, false);\n                var validStartLeft = this.parent.dataOperation.getTaskLeft(validStartDate, false);\n                var validEndLeft = this.parent.dataOperation.getTaskLeft(validEndDate, false);\n                var isChanged = void 0;\n                if (!isNullOrUndefined(maxStartLeft) && (maxStartLeft <= this.bottomTierCellWidth || maxStartLeft <= validStartLeft)) {\n                    isChanged = 'prevTimeSpan';\n                    minStartDate = minStartDate > this.timelineStartDate ? this.timelineStartDate : minStartDate;\n                }\n                else {\n                    minStartDate = this.timelineStartDate;\n                }\n                if (!isNullOrUndefined(maxEndLeft) && (maxEndLeft >= (this.totalTimelineWidth - this.bottomTierCellWidth) ||\n                    maxEndLeft >= validEndLeft)) {\n                    isChanged = isChanged === 'prevTimeSpan' ? 'both' : 'nextTimeSpan';\n                    maxEndDate = maxEndDate < this.timelineEndDate ? this.timelineEndDate : maxEndDate;\n                }\n                else {\n                    maxEndDate = this.timelineEndDate;\n                }\n                if (isChanged) {\n                    this.performTimeSpanAction(isChanged, action, minStartDate, maxEndDate);\n                }\n                else if (!isNullOrUndefined(temp[0].ganttProperties.segments)) {\n                    this.parent.dataOperation.updateWidthLeft(temp[0]);\n                }\n                break;\n            }\n        }\n    };\n    /**\n     * To validate project start date and end date on editing action\n     *\n     * @param {string} type .\n     * @param {string} isFrom .\n     * @param {Date} startDate .\n     * @param {Date} endDate .\n     * @param {string} mode .\n     * @returns {void} .\n     * @private\n     */\n    Timeline.prototype.performTimeSpanAction = function (type, isFrom, startDate, endDate, mode) {\n        mode = !isNullOrUndefined(mode) ? mode : this.parent.timelineModule.topTier === 'None' ?\n            this.parent.timelineModule.bottomTier : this.parent.timelineModule.topTier;\n        var projectStartDate = new Date(this.parent.cloneProjectStartDate.getTime());\n        var projectEndDate = new Date(this.parent.cloneProjectEndDate.getTime());\n        if (isFrom !== 'publicMethod' && type === 'both') {\n            this.updateScheduleDatesByToolBar(mode, 'prevTimeSpan', startDate, endDate);\n            this.updateScheduleDatesByToolBar(mode, 'nextTimeSpan', new Date(this.parent.cloneProjectStartDate.getTime()), endDate);\n        }\n        else {\n            this.updateScheduleDatesByToolBar(mode, type, startDate, endDate);\n        }\n        var args = this.timeSpanActionEvent('actionBegin', type, isFrom);\n        if (!args.cancel) {\n            this.parent.updateProjectDates(args.projectStartDate, args.ProjectEndDate, args.isTimelineRoundOff, isFrom);\n            if (type === 'prevTimeSpan' && isFrom === 'publicMethod') {\n                this.parent.ganttChartModule.updateScrollLeft(0);\n            }\n            else if (type === 'nextTimeSpan' && isFrom === 'publicMethod') {\n                this.parent.ganttChartModule.updateScrollLeft(this.parent.timelineModule.totalTimelineWidth);\n            }\n            this.parent.timelineModule.timeSpanActionEvent('actionComplete', type, isFrom);\n        }\n        else {\n            this.parent.cloneProjectStartDate = projectStartDate;\n            this.parent.cloneProjectEndDate = projectEndDate;\n        }\n    };\n    /**\n     * To validate project start date and end date.\n     *\n     * @param {string} eventType .\n     * @param {string} requestType .\n     * @param {string} isFrom .\n     * @returns {void}\n     * @private\n     */\n    Timeline.prototype.timeSpanActionEvent = function (eventType, requestType, isFrom) {\n        var args = {};\n        args.projectStartDate = new Date(this.parent.cloneProjectStartDate.getTime());\n        args.ProjectEndDate = new Date(this.parent.cloneProjectEndDate.getTime());\n        args.requestType = isFrom === 'publicMethod' ? requestType : isFrom === 'beforeAdd' ?\n            'TimelineRefreshOnAdd' : isFrom === 'TaskbarEditing' ? 'TimelineRefreshOnEdit' : requestType;\n        if (eventType === 'actionBegin') {\n            args.isTimelineRoundOff = this.parent.isTimelineRoundOff;\n            args.cancel = false;\n        }\n        args.action = 'TimescaleUpdate';\n        this.parent.trigger(eventType, args);\n        return args;\n    };\n    return Timeline;\n}());\nexport { Timeline };\n"]},"metadata":{},"sourceType":"module"}