{"ast":null,"code":"import { remove, extend, isNullOrUndefined, createElement, getValue, setValue, closest } from '@syncfusion/ej2-base';\nimport { DataManager, DataUtil } from '@syncfusion/ej2-data';\nimport { Dialog } from '@syncfusion/ej2-popups';\nimport { Tab } from '@syncfusion/ej2-navigations';\nimport { Grid, Edit, Toolbar as GridToolbar, Page, getObject } from '@syncfusion/ej2-grids';\nimport { ForeignKey, getActualProperties } from '@syncfusion/ej2-grids';\nimport { RichTextEditor, Toolbar as RTEToolbar, Link, HtmlEditor, QuickToolbar, Count } from '@syncfusion/ej2-richtexteditor';\nimport { TextBox, NumericTextBox, MaskedTextBox } from '@syncfusion/ej2-inputs';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { DatePicker, DateTimePicker } from '@syncfusion/ej2-calendars';\nimport { DropDownList, ComboBox } from '@syncfusion/ej2-dropdowns';\nimport { isScheduledTask } from '../base/utils';\nimport { TreeGrid, Selection, Filter, Edit as TreeGridEdit, VirtualScroll } from '@syncfusion/ej2-treegrid';\nimport { getUid } from '../base/utils';\n/**\n *\n * @hidden\n */\n\nvar DialogEdit =\n/** @class */\nfunction () {\n  /**\n   * Constructor for render module\n   *\n   * @param {Gantt} parent .\n   * @returns {void} .\n   */\n  function DialogEdit(parent) {\n    /**\n     * @private\n     */\n    this.updatedEditFields = null;\n    this.updatedAddFields = null;\n    this.addedRecord = null;\n    this.dialogEditValidationFlag = false;\n    this.ganttResources = [];\n    /**\n     * @private\n     */\n\n    this.previousResource = [];\n    /**\n     * @private\n     */\n\n    this.isResourceUpdate = false;\n    this.parent = parent;\n    this.localeObj = this.parent.localeObj;\n    this.beforeOpenArgs = {\n      cancel: false\n    };\n    this.types = this.getPredecessorType();\n    this.rowData = {};\n    this.editedRecord = {};\n    this.inputs = {\n      booleanedit: CheckBox,\n      dropdownedit: DropDownList,\n      datepickeredit: DatePicker,\n      datetimepickeredit: DateTimePicker,\n      maskededit: MaskedTextBox,\n      numericedit: NumericTextBox,\n      stringedit: TextBox\n    };\n    this.processDialogFields();\n    this.wireEvents();\n  }\n\n  DialogEdit.prototype.wireEvents = function () {\n    this.parent.on('chartDblClick', this.dblClickHandler, this);\n  };\n\n  DialogEdit.prototype.dblClickHandler = function (e) {\n    var ganttData = this.parent.ganttChartModule.getRecordByTarget(e);\n\n    if (!isNullOrUndefined(ganttData) && this.parent.editModule && this.parent.editSettings.allowEditing) {\n      this.openEditDialog(ganttData);\n    }\n  };\n  /**\n   * Method to validate add and edit dialog fields property.\n   *\n   * @returns {void} .\n   * @private\n   */\n\n\n  DialogEdit.prototype.processDialogFields = function () {\n    if (isNullOrUndefined(this.parent.editDialogFields) || this.parent.editDialogFields && this.parent.editDialogFields.length === 0) {\n      this.updatedEditFields = this.getDefaultDialogFields();\n      this.updatedEditFields = this.validateDialogFields(this.updatedEditFields);\n    } else {\n      this.updatedEditFields = this.validateDialogFields(this.parent.editDialogFields);\n    }\n\n    if (isNullOrUndefined(this.parent.addDialogFields) || this.parent.addDialogFields && this.parent.addDialogFields.length === 0) {\n      this.updatedAddFields = this.getDefaultDialogFields();\n      this.updatedAddFields = this.validateDialogFields(this.updatedAddFields);\n    } else {\n      this.updatedAddFields = this.validateDialogFields(this.parent.addDialogFields);\n    }\n  };\n\n  DialogEdit.prototype.validateDialogFields = function (dialogFields) {\n    var newDialogFields = [];\n    var emptyCustomColumn = 0;\n\n    for (var i = 0; i < dialogFields.length; i++) {\n      var fieldItem = getActualProperties(dialogFields[i]);\n\n      if (fieldItem.type === 'General' && (isNullOrUndefined(fieldItem.fields) || fieldItem.fields.length === 0)) {\n        fieldItem.fields = this.getGeneralColumnFields();\n      }\n\n      if (fieldItem.type === 'Dependency' && isNullOrUndefined(this.parent.taskFields.dependency) || fieldItem.type === 'Resources' && isNullOrUndefined(this.parent.taskFields.resourceInfo) || fieldItem.type === 'Notes' && isNullOrUndefined(this.parent.taskFields.notes)) {\n        continue;\n      }\n\n      if (fieldItem.type === 'Custom' && (isNullOrUndefined(fieldItem.fields) || fieldItem.fields.length === 0)) {\n        emptyCustomColumn += 1;\n        fieldItem.fields = this.getCustomColumnFields();\n      }\n\n      if (emptyCustomColumn > 1) {\n        continue;\n      }\n\n      newDialogFields.push(fieldItem);\n    }\n\n    return newDialogFields;\n  };\n  /**\n   * Method to get general column fields\n   *\n   * @returns {string[]} .\n   */\n\n\n  DialogEdit.prototype.getGeneralColumnFields = function () {\n    var fields = [];\n\n    for (var _i = 0, _a = Object.keys(this.parent.columnMapping); _i < _a.length; _i++) {\n      var key = _a[_i];\n\n      if (key === 'dependency' || key === 'resourceInfo' || key === 'notes') {\n        continue;\n      }\n\n      fields.push(this.parent.columnMapping[key]);\n    }\n\n    return fields;\n  };\n  /**\n   * Method to get custom column fields\n   *\n   * @returns {void} .\n   */\n\n\n  DialogEdit.prototype.getCustomColumnFields = function () {\n    var fields = [];\n\n    for (var i = 0; i < this.parent.customColumns.length; i++) {\n      fields.push(this.parent.customColumns[i]);\n    }\n\n    return fields;\n  };\n  /**\n   * Get default dialog fields when fields are not defined for add and edit dialogs\n   *\n   * @returns {AddDialogFieldSettings} .\n   */\n\n\n  DialogEdit.prototype.getDefaultDialogFields = function () {\n    var dialogFields = [];\n    var fieldItem = {};\n    var taskFields = this.parent.taskFields;\n    var columnMapping = this.parent.columnMapping;\n\n    if (Object.keys(columnMapping).length !== 0) {\n      fieldItem.type = 'General';\n      dialogFields.push(fieldItem);\n    }\n\n    if (!isNullOrUndefined(getValue('dependency', columnMapping))) {\n      fieldItem = {};\n\n      if (this.parent.columnByField[columnMapping.dependency.valueOf()].visible !== false) {\n        fieldItem.type = 'Dependency';\n      }\n\n      dialogFields.push(fieldItem);\n    }\n\n    if (!isNullOrUndefined(getValue('resourceInfo', columnMapping))) {\n      fieldItem = {};\n\n      if (this.parent.columnByField[columnMapping.resourceInfo.valueOf()].visible !== false) {\n        fieldItem.type = 'Resources';\n      }\n\n      dialogFields.push(fieldItem);\n    }\n\n    if (!isNullOrUndefined(getValue('notes', columnMapping))) {\n      fieldItem = {};\n\n      if (this.parent.columnByField[columnMapping.notes.valueOf()].visible !== false) {\n        fieldItem.type = 'Notes';\n      }\n\n      dialogFields.push(fieldItem);\n    }\n\n    if (!isNullOrUndefined(getValue('segments', taskFields))) {\n      fieldItem = {};\n      fieldItem.type = 'Segments';\n      dialogFields.push(fieldItem);\n    }\n\n    if (this.parent.customColumns.length > 0) {\n      fieldItem = {};\n      fieldItem.type = 'Custom';\n      dialogFields.push(fieldItem);\n    }\n\n    return dialogFields;\n  };\n  /**\n   * @returns {void} .\n   * @private\n   */\n\n\n  DialogEdit.prototype.openAddDialog = function () {\n    this.isEdit = false;\n    this.editedRecord = this.composeAddRecord();\n    this.createDialog();\n  };\n  /**\n   *\n   * @returns {Date} .\n   * @private\n   */\n\n\n  DialogEdit.prototype.getMinimumStartDate = function () {\n    var minDate = DataUtil.aggregates.min(this.parent.flatData, 'ganttProperties.startDate');\n\n    if (!isNullOrUndefined(minDate)) {\n      minDate = new Date(minDate.getTime());\n    } else {\n      minDate = new Date(this.parent.timelineModule.timelineStartDate.getTime());\n    }\n\n    minDate = this.parent.dateValidationModule.checkStartDate(minDate);\n    return new Date(minDate.getTime());\n  };\n  /**\n   * @returns {IGanttData} .\n   * @private\n   */\n\n\n  DialogEdit.prototype.composeAddRecord = function () {\n    var tempData = {};\n    tempData.ganttProperties = {};\n    var columns = this.parent.ganttColumns;\n    var taskSettings = this.parent.taskFields;\n    var id = this.parent.editModule.getNewTaskId();\n\n    for (var i = 0; i < columns.length; i++) {\n      var field = columns[i].field;\n\n      if (field === taskSettings.id) {\n        tempData[field] = id;\n        tempData.ganttProperties.rowUniqueID = tempData[field];\n      } else if (columns[i].field === taskSettings.startDate) {\n        if (isNullOrUndefined(tempData[taskSettings.endDate])) {\n          tempData[field] = this.getMinimumStartDate();\n        } else {\n          tempData[field] = new Date(tempData[taskSettings.endDate]);\n        }\n\n        if (this.parent.timezone) {\n          tempData[field] = this.parent.dateValidationModule.remove(tempData[field], this.parent.timezone);\n        }\n\n        tempData.ganttProperties.startDate = new Date(tempData[field]);\n      } else if (columns[i].field === taskSettings.endDate) {\n        if (isNullOrUndefined(tempData[taskSettings.startDate])) {\n          tempData[field] = this.getMinimumStartDate();\n        } else {\n          tempData[field] = new Date(tempData[taskSettings.startDate]);\n        }\n\n        if (this.parent.timezone) {\n          tempData[field] = this.parent.dateValidationModule.remove(tempData[field], this.parent.timezone);\n        }\n\n        tempData.ganttProperties.endDate = new Date(tempData[field]);\n      } else if (columns[i].field === taskSettings.duration) {\n        tempData[field] = 1;\n        tempData.ganttProperties.duration = tempData[field];\n        tempData.ganttProperties.durationUnit = this.parent.durationUnit.toLocaleLowerCase();\n      } else if (columns[i].field === taskSettings.name) {\n        tempData[field] = 'New Task ' + id;\n        tempData.ganttProperties.taskName = tempData[field];\n      } else if (columns[i].field === taskSettings.progress) {\n        tempData[field] = 0;\n        tempData.ganttProperties.progress = tempData[field];\n      } else if (columns[i].field === taskSettings.work) {\n        tempData[field] = 0;\n        tempData.ganttProperties.work = tempData[field];\n      } else if (columns[i].field === 'taskType') {\n        tempData[field] = this.parent.taskType;\n        tempData.ganttProperties.taskType = tempData[field];\n      } else {\n        tempData[this.parent.ganttColumns[i].field] = '';\n      }\n    }\n\n    tempData.ganttProperties.isAutoSchedule = this.parent.taskMode === 'Auto' ? true : this.parent.taskMode === 'Manual' ? false : tempData[taskSettings.manual] === true ? false : true;\n    return tempData;\n  };\n  /**\n   * @returns {void} .\n   * @private\n   */\n\n\n  DialogEdit.prototype.openToolbarEditDialog = function () {\n    var gObj = this.parent;\n\n    if (gObj.editModule && gObj.editSettings.allowEditing) {\n      if (this.parent.ganttChartModule.focusedRowIndex > -1 && gObj.selectionModule) {\n        gObj.selectionModule.selectRow(this.parent.ganttChartModule.focusedRowIndex, false, false);\n      }\n\n      var selectedRowId = gObj.selectionModule ? (gObj.selectionSettings.mode === 'Row' || gObj.selectionSettings.mode === 'Both') && gObj.selectionModule.selectedRowIndexes.length === 1 ? gObj.updatedRecords[gObj.selectionModule.selectedRowIndexes[0]].ganttProperties.rowUniqueID : gObj.selectionSettings.mode === 'Cell' && gObj.selectionModule.getSelectedRowCellIndexes().length === 1 ? gObj.updatedRecords[gObj.selectionModule.getSelectedRowCellIndexes()[0].rowIndex].ganttProperties.rowUniqueID : null : null;\n\n      if (!isNullOrUndefined(selectedRowId)) {\n        this.openEditDialog(selectedRowId);\n      }\n    }\n  };\n  /**\n   * @param { number | string | object} taskId .\n   * @returns {void} .\n   * @private\n   */\n\n\n  DialogEdit.prototype.openEditDialog = function (taskId) {\n    var ganttObj = this.parent;\n\n    if (typeof taskId === 'object' && !isNullOrUndefined(taskId)) {\n      this.rowIndex = this.parent.currentViewData.indexOf(taskId);\n\n      if (this.rowIndex > -1) {\n        this.rowData = taskId;\n      }\n    } else if (!isNullOrUndefined(taskId)) {\n      this.rowIndex = ganttObj.ids.indexOf(taskId.toString());\n\n      if (this.rowIndex > -1) {\n        this.rowData = ganttObj.flatData[this.rowIndex];\n      }\n    } else if (ganttObj.selectedRowIndex > -1) {\n      this.rowData = ganttObj.currentViewData[ganttObj.selectedRowIndex];\n      this.rowIndex = ganttObj.selectedRowIndex;\n    }\n\n    this.isEdit = true;\n\n    if (this.parent.viewType === 'ResourceView' && this.rowData.level === 0) {\n      return;\n    }\n\n    if (Object.keys(this.rowData).length !== 0) {\n      this.editedRecord = extend({}, {}, this.rowData, true);\n      this.createDialog();\n    }\n  };\n\n  DialogEdit.prototype.createDialog = function () {\n    var _this = this;\n\n    var ganttObj = this.parent;\n    var dialogModel = {};\n    this.beforeOpenArgs.dialogModel = dialogModel;\n    this.beforeOpenArgs.rowData = this.editedRecord;\n    this.beforeOpenArgs.rowIndex = this.rowIndex;\n    var dialogMaxWidth = this.parent.isAdaptive ? '' : '600px';\n    var dialog = this.parent.createElement('div', {\n      id: ganttObj.element.id + '_dialog',\n      styles: 'max-width:' + dialogMaxWidth\n    });\n    ganttObj.element.appendChild(dialog);\n    dialogModel.animationSettings = {\n      effect: 'None'\n    };\n    dialogModel.header = this.localeObj.getConstant(this.isEdit ? 'editDialogTitle' : 'addDialogTitle');\n    dialogModel.isModal = true;\n    dialogModel.cssClass = 'e-gantt-dialog';\n    dialogModel.allowDragging = this.parent.isAdaptive ? false : true;\n    dialogModel.showCloseIcon = true;\n    var position = this.parent.isAdaptive ? {\n      X: 'top',\n      Y: 'left'\n    } : {\n      X: 'center',\n      Y: 'center'\n    };\n    dialogModel.position = position; //dialogModel.width = '750px';\n\n    dialogModel.height = this.parent.isAdaptive ? '100%' : 'auto';\n    dialogModel.target = document.body;\n    dialogModel.close = this.dialogClose.bind(this);\n    dialogModel.closeOnEscape = true;\n\n    dialogModel.open = function (args) {\n      var dialogElement = getValue('element', args);\n      var generalTabElement = dialogElement.querySelector('#' + _this.parent.element.id + 'GeneralTabContainer');\n\n      if (generalTabElement && generalTabElement.scrollHeight > generalTabElement.offsetHeight) {\n        generalTabElement.classList.add('e-scroll');\n      }\n\n      if (_this.tabObj.selectedItem === 0) {\n        _this.tabObj.select(0);\n      }\n\n      if (_this.parent.isAdaptive) {\n        dialogElement.style.maxHeight = 'none';\n      }\n\n      if (_this.parent.focusModule) {\n        _this.parent.focusModule.setActiveElement(dialogElement);\n      }\n    };\n\n    dialogModel.locale = this.parent.locale;\n    dialogModel.buttons = [{\n      buttonModel: {\n        content: this.localeObj.getConstant('saveButton'),\n        cssClass: 'e-primary'\n      },\n      click: this.buttonClick.bind(this)\n    }, {\n      buttonModel: {\n        cssClass: 'e-flat',\n        content: this.localeObj.getConstant('cancel')\n      },\n      click: this.buttonClick.bind(this)\n    }];\n    this.createTab(dialogModel, dialog);\n  };\n\n  DialogEdit.prototype.buttonClick = function (e) {\n    var target = e.target;\n    target.style.pointerEvents = 'none';\n\n    if (this.localeObj.getConstant('cancel').toLowerCase() === e.target.innerText.trim().toLowerCase()) {\n      if (this.dialog && !this.dialogObj.isDestroyed) {\n        this.dialogObj.hide();\n        this.dialogClose();\n      }\n    } else {\n      this.initiateDialogSave();\n      target.style.pointerEvents = 'auto';\n    }\n  };\n  /**\n   * @returns {void} .\n   * @private\n   */\n\n\n  DialogEdit.prototype.dialogClose = function () {\n    if (this.dialog) {\n      this.resetValues();\n    }\n\n    if (!isNullOrUndefined(this.parent.focusModule) && !isNullOrUndefined(this.parent.focusModule.getActiveElement(true))) {\n      this.parent.focusModule.getActiveElement(true).focus();\n    }\n  };\n\n  DialogEdit.prototype.resetValues = function () {\n    this.isEdit = false;\n    this.isAddNewResource = false;\n    this.editedRecord = {};\n    this.rowData = {};\n    this.rowIndex = -1;\n    this.addedRecord = null;\n    this.ganttResources = [];\n    this.dialogEditValidationFlag = false;\n\n    if (this.dialog && !this.dialogObj.isDestroyed) {\n      this.destroyDialogInnerElements();\n      this.dialogObj.destroy();\n      remove(this.dialog);\n    }\n  };\n\n  DialogEdit.prototype.destroyDialogInnerElements = function () {\n    var ganttObj = this.parent;\n    var tabModel = this.beforeOpenArgs.tabModel;\n    var items = tabModel.items;\n\n    for (var i = 0; i < items.length; i++) {\n      var element = items[i].content;\n      var id = element.id;\n\n      if (!isNullOrUndefined(id) || id !== '') {\n        id = id.replace(ganttObj.element.id, '');\n        id = id.replace('TabContainer', '');\n\n        if (id === 'General') {\n          this.destroyCustomField(element);\n        } else if (id === 'Dependency') {\n          var gridObj = element.ej2_instances[0];\n          gridObj.destroy();\n        } else if (id === 'Notes') {\n          var rte = element.ej2_instances[0];\n          rte.destroy();\n        } else if (id === 'Resources') {\n          var treeGridObj = element.ej2_instances[0];\n          treeGridObj.destroy();\n        } else if (id.indexOf('Custom') !== -1) {\n          this.destroyCustomField(element);\n        }\n      }\n    }\n  };\n\n  DialogEdit.prototype.destroyCustomField = function (element) {\n    var childNodes = element.childNodes;\n    var ganttObj = this.parent;\n\n    for (var i = 0; i < childNodes.length; i++) {\n      var div = childNodes[i];\n      var inputElement = div.querySelector('input[id^=\"' + ganttObj.element.id + '\"]');\n\n      if (inputElement) {\n        var fieldName = inputElement.id.replace(ganttObj.element.id, '');\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n\n        var controlObj = div.querySelector('#' + ganttObj.element.id + fieldName).ej2_instances[0];\n\n        if (!isNullOrUndefined(controlObj)) {\n          var column = ganttObj.columnByField[fieldName];\n\n          if (!isNullOrUndefined(column.edit) && isNullOrUndefined(column.edit.params)) {\n            var destroy = column.edit.destroy;\n\n            if (typeof destroy === 'string') {\n              destroy = getObject(destroy, window);\n              destroy();\n            } else {\n              column.edit.destroy();\n            }\n          } else {\n            controlObj.destroy();\n          }\n        }\n      }\n    }\n  };\n  /**\n   * @returns {void} .\n   * @private\n   */\n\n\n  DialogEdit.prototype.destroy = function () {\n    this.resetValues();\n\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.off('chartDblClick', this.dblClickHandler);\n    this.parent.editModule.dialogModule = undefined;\n  };\n  /**\n   * Method to get current edit dialog fields value\n   *\n   * @returns {AddDialogFieldSettings} .\n   */\n\n\n  DialogEdit.prototype.getEditFields = function () {\n    if (this.isEdit) {\n      return this.updatedEditFields;\n    } else {\n      return this.updatedAddFields;\n    }\n  };\n\n  DialogEdit.prototype.createTab = function (dialogModel, dialog) {\n    var _this = this;\n\n    var ganttObj = this.parent;\n    var tabModel = {};\n    var tabItems = [];\n    var dialogSettings = this.getEditFields();\n    var tabElement;\n    var tasks = ganttObj.taskFields;\n    var length = dialogSettings.length;\n    tabModel.items = tabItems;\n    tabModel.locale = this.parent.locale;\n    this.beforeOpenArgs.tabModel = tabModel;\n    var count = 0;\n    var index = 0;\n\n    if (length > 0) {\n      for (var i = 0; i < length; i++) {\n        var dialogField = dialogSettings[i];\n        var tabItem = {};\n\n        if (dialogField.type === 'General') {\n          if (Object.keys(ganttObj.columnMapping).length === 0) {\n            continue;\n          }\n\n          if (isNullOrUndefined(dialogField.headerText)) {\n            dialogField.headerText = this.localeObj.getConstant('generalTab');\n          }\n\n          tabItem.content = 'General';\n          this.beforeOpenArgs[tabItem.content] = this.getFieldsModel(dialogField.fields);\n        } else if (dialogField.type === 'Segments') {\n          if (isNullOrUndefined(tasks.segments)) {\n            continue;\n          }\n\n          if (isNullOrUndefined(dialogField.headerText)) {\n            dialogField.headerText = this.localeObj.getConstant('segments');\n          }\n\n          tabItem.content = 'Segments';\n          this.beforeOpenArgs[tabItem.content] = this.getSegmentsModel(dialogField.fields);\n        } else if (dialogField.type === 'Dependency') {\n          if (isNullOrUndefined(tasks.dependency)) {\n            continue;\n          }\n\n          if (isNullOrUndefined(dialogField.headerText)) {\n            dialogField.headerText = this.localeObj.getConstant('dependency');\n          }\n\n          tabItem.content = 'Dependency';\n          this.beforeOpenArgs[tabItem.content] = this.getPredecessorModel(dialogField.fields);\n        } else if (dialogField.type === 'Resources') {\n          if (isNullOrUndefined(tasks.resourceInfo)) {\n            continue;\n          }\n\n          if (isNullOrUndefined(dialogField.headerText)) {\n            dialogField.headerText = this.localeObj.getConstant('resourceName');\n          }\n\n          tabItem.content = 'Resources';\n          this.beforeOpenArgs[tabItem.content] = this.getResourcesModel(dialogField.fields);\n        } else if (dialogField.type === 'Notes') {\n          if (isNullOrUndefined(tasks.notes)) {\n            continue;\n          }\n\n          if (isNullOrUndefined(dialogField.headerText)) {\n            dialogField.headerText = this.localeObj.getConstant('notes');\n          }\n\n          tabItem.content = 'Notes';\n          this.beforeOpenArgs[tabItem.content] = this.getNotesModel(dialogField.fields);\n        } else {\n          if (isNullOrUndefined(dialogField.fields) || dialogField.fields.length === 0) {\n            continue;\n          }\n\n          if (isNullOrUndefined(dialogField.headerText)) {\n            dialogField.headerText = this.localeObj.getConstant('customTab'); // eslint-disable-next-line\n\n            count++;\n          }\n\n          tabItem.content = 'Custom' + '' + index++;\n          this.beforeOpenArgs[tabItem.content] = this.getFieldsModel(dialogField.fields);\n        }\n\n        tabItem.header = {\n          text: dialogField.headerText\n        };\n        tabItems.push(tabItem);\n      }\n    }\n\n    this.beforeOpenArgs.requestType = this.isEdit ? 'beforeOpenEditDialog' : 'beforeOpenAddDialog';\n    var args = {\n      rowData: this.beforeOpenArgs.rowData,\n      name: this.beforeOpenArgs.name,\n      requestType: this.beforeOpenArgs.requestType,\n      cancel: this.beforeOpenArgs.cancel\n    };\n    this.parent.trigger('actionBegin', this.beforeOpenArgs, function (arg) {\n      _this.renderTabItems();\n\n      if (!arg.cancel) {\n        tabModel.selected = _this.tabSelectedEvent.bind(_this);\n        tabModel.height = _this.parent.isAdaptive ? '100%' : 'auto';\n        tabModel.overflowMode = 'Scrollable';\n        _this.tabObj = new Tab(tabModel);\n        _this.tabObj.isStringTemplate = true;\n        tabElement = _this.parent.createElement('div', {\n          id: ganttObj.element.id + '_Tab'\n        });\n\n        _this.tabObj.appendTo(tabElement);\n\n        dialogModel.content = tabElement;\n        _this.dialog = dialog;\n        _this.dialogObj = new Dialog(dialogModel);\n        _this.dialogObj.isStringTemplate = true;\n\n        _this.dialogObj.appendTo(_this.dialog);\n\n        var actionCompleteArgs = {\n          action: 'OpenDialog',\n          requestType: _this.isEdit ? 'openEditDialog' : 'openAddDialog',\n          data: _this.beforeOpenArgs.rowData,\n          element: _this.dialog,\n          cancel: false\n        };\n\n        _this.parent.trigger('actionComplete', actionCompleteArgs, function (actionCompleteArg) {\n          if (actionCompleteArg.cancel) {\n            _this.resetValues();\n          }\n        });\n      }\n    });\n  };\n\n  DialogEdit.prototype.tabSelectedEvent = function (args) {\n    var ganttObj = this.parent;\n    var id = args.selectedContent.childNodes[0].id;\n\n    if (this.parent.isAdaptive) {\n      this.responsiveTabContent(id, ganttObj);\n    }\n\n    if (id === ganttObj.element.id + 'ResourcesTabContainer') {\n      this.resourceSelection(id);\n    } else if (id === ganttObj.element.id + 'NotesTabContainer') {\n      document.getElementById(id).ej2_instances[0].refresh();\n    } else if (id === ganttObj.element.id + 'SegmentsTabContainer') {\n      if (isNullOrUndefined(this.beforeOpenArgs.rowData.ganttProperties.startDate)) {\n        document.getElementById(id).ej2_instances[0].enableToolbarItems([this.parent.element.id + 'SegmentsTabContainer' + '_add'], false);\n      } else {\n        document.getElementById(id).ej2_instances[0].enableToolbarItems([this.parent.element.id + 'SegmentsTabContainer' + '_add'], true);\n      }\n    }\n  };\n\n  DialogEdit.prototype.responsiveTabContent = function (id, ganttObj) {\n    var dialogContent = document.getElementById(ganttObj.element.id + '_dialog_dialog-content');\n    var dialogContentHeight = dialogContent.clientHeight;\n    dialogContentHeight -= dialogContent.querySelector('.e-tab-header').offsetHeight;\n    var grid = document.querySelector('#' + id);\n\n    if (grid.classList.contains('e-grid')) {\n      dialogContentHeight -= grid.ej2_instances[0].getHeaderContent().offsetHeight;\n      var toolbar_1 = grid.querySelector('.e-toolbar');\n\n      if (toolbar_1) {\n        dialogContentHeight -= toolbar_1.offsetHeight;\n      }\n    }\n\n    grid.parentElement.style.height = dialogContentHeight + 'px';\n  };\n\n  DialogEdit.prototype.getFieldsModel = function (fields) {\n    var fieldsModel = {};\n    var columnByField = this.parent.columnByField;\n\n    for (var i = 0; i < fields.length; i++) {\n      if (fields[i] === this.parent.taskFields.dependency || fields[i] === this.parent.taskFields.resourceInfo || fields[i] === this.parent.taskFields.notes) {\n        continue;\n      }\n\n      if (!isNullOrUndefined(columnByField[fields[i]])) {\n        var fieldName = fields[i];\n        this.createInputModel(columnByField[fieldName], fieldsModel);\n      }\n    }\n\n    return fieldsModel;\n  };\n\n  DialogEdit.prototype.createInputModel = function (column, fieldsModel) {\n    var _this = this;\n\n    var ganttObj = this.parent;\n    var locale = this.parent.locale;\n    var taskSettings = this.parent.taskFields;\n    var common = {\n      placeholder: column.headerText,\n      floatLabelType: 'Auto'\n    };\n\n    switch (column.editType) {\n      case 'booleanedit':\n        {\n          var checkboxModel = {\n            label: column.headerText,\n            locale: locale\n          };\n          fieldsModel[column.field] = checkboxModel;\n          break;\n        }\n\n      case 'stringedit':\n        {\n          var textBox = common;\n\n          if (column.field === ganttObj.columnMapping.duration || column.field === ganttObj.columnMapping.startDate || column.field === ganttObj.columnMapping.endDate) {\n            textBox.change = function (args) {\n              _this.validateScheduleFields(args, column, ganttObj);\n            };\n          }\n\n          fieldsModel[column.field] = common;\n          break;\n        }\n\n      case 'numericedit':\n        {\n          var numeric = common;\n\n          if (taskSettings.progress === column.field) {\n            numeric.min = 0;\n            numeric.max = 100;\n          }\n\n          if (taskSettings.work === column.field) {\n            numeric.change = function (args) {\n              _this.validateScheduleFields(args, column, ganttObj);\n            };\n          }\n\n          fieldsModel[column.field] = numeric;\n          break;\n        }\n\n      case 'datepickeredit':\n        {\n          var datePickerObj = common;\n          datePickerObj.format = this.parent.getDateFormat();\n          datePickerObj.strictMode = true;\n          datePickerObj.firstDayOfWeek = ganttObj.timelineModule.customTimelineSettings.weekStartDay;\n\n          if (column.field === ganttObj.columnMapping.startDate || column.field === ganttObj.columnMapping.endDate) {\n            datePickerObj.renderDayCell = this.parent.renderWorkingDayCell.bind(this.parent);\n\n            datePickerObj.change = function (args) {\n              _this.validateScheduleFields(args, column, ganttObj);\n            };\n          }\n\n          fieldsModel[column.field] = datePickerObj;\n          break;\n        }\n\n      case 'datetimepickeredit':\n        {\n          var dateTimePickerObj = common;\n          dateTimePickerObj.format = this.parent.getDateFormat();\n          dateTimePickerObj.strictMode = true;\n          dateTimePickerObj.firstDayOfWeek = ganttObj.timelineModule.customTimelineSettings.weekStartDay;\n\n          if (column.field === ganttObj.columnMapping.startDate || column.field === ganttObj.columnMapping.endDate) {\n            dateTimePickerObj.renderDayCell = this.parent.renderWorkingDayCell.bind(this.parent);\n\n            dateTimePickerObj.change = function (args) {\n              _this.validateScheduleFields(args, column, ganttObj);\n            };\n          }\n\n          fieldsModel[column.field] = dateTimePickerObj;\n          break;\n        }\n\n      case 'dropdownedit':\n        if (column.field === 'taskType' || column.field === ganttObj.columnMapping.manual) {\n          var dataKey = 'dataSource';\n          var fieldsKey = 'fields';\n          var types = [{\n            'ID': 1,\n            'Value': 'FixedUnit'\n          }, {\n            'ID': 2,\n            'Value': 'FixedWork'\n          }, {\n            'ID': 3,\n            'Value': 'FixedDuration'\n          }];\n          common[dataKey] = types;\n          common[fieldsKey] = {\n            value: 'Value'\n          };\n          var dropDownListObj = common;\n\n          dropDownListObj.change = function (args) {\n            if (column.field === taskSettings.manual) {\n              _this.editedRecord.ganttProperties.isAutoSchedule = !args.value;\n            }\n\n            _this.validateScheduleFields(args, column, ganttObj);\n          };\n        }\n\n        fieldsModel[column.field] = common;\n        break;\n\n      case 'maskededit':\n        fieldsModel[column.field] = common;\n        break;\n    }\n\n    if (!isNullOrUndefined(column.edit) && !isNullOrUndefined(column.edit.params)) {\n      extend(fieldsModel[column.field], column.edit.params);\n    }\n\n    return fieldsModel;\n  };\n\n  DialogEdit.prototype.validateScheduleFields = function (args, column, ganttObj) {\n    var dialog = ganttObj.editModule.dialogModule.dialog;\n    var targetId = null;\n    var inputElement;\n    var currentData = ganttObj.editModule.dialogModule.editedRecord;\n    var cellValue = null;\n    var colName = null;\n\n    if (!isNullOrUndefined(args.element)) {\n      inputElement = args.element;\n      targetId = inputElement.getAttribute('id');\n    } else if (!isNullOrUndefined(args.container)) {\n      inputElement = args.container;\n      targetId = inputElement.querySelector('input').getAttribute('id');\n      inputElement = inputElement.querySelector('#' + targetId);\n    } else if (!isNullOrUndefined(args.event) && !isNullOrUndefined(args.event.path[1])) {\n      inputElement = args.event.path[1];\n      targetId = inputElement.querySelector('input').getAttribute('id');\n      inputElement = inputElement.querySelector('#' + targetId);\n    }\n\n    if (isNullOrUndefined(inputElement)) {\n      cellValue = args.value;\n      colName = column.field;\n    } else {\n      cellValue = inputElement.value;\n      colName = targetId.replace(ganttObj.element.id, '');\n    }\n\n    if (colName.search('Segments') === 0) {\n      colName = colName.replace('SegmentsTabContainer', '');\n      this.validateSegmentFields(ganttObj, colName, cellValue, args);\n      return true;\n    } else {\n      this.validateScheduleValuesByCurrentField(colName, cellValue, this.editedRecord);\n      var ganttProp = currentData.ganttProperties;\n      var tasks = ganttObj.taskFields;\n\n      if (!isNullOrUndefined(tasks.startDate) && tasks.startDate !== colName) {\n        this.updateScheduleFields(dialog, ganttProp, 'startDate');\n      }\n\n      if (!isNullOrUndefined(tasks.endDate) && tasks.endDate !== colName) {\n        this.updateScheduleFields(dialog, ganttProp, 'endDate');\n      }\n\n      if (!isNullOrUndefined(tasks.duration) && tasks.duration !== colName) {\n        this.updateScheduleFields(dialog, ganttProp, 'duration');\n      }\n\n      if (!isNullOrUndefined(tasks.work) && tasks.work !== colName) {\n        this.updateScheduleFields(dialog, ganttProp, 'work');\n      }\n\n      this.dialogEditValidationFlag = false;\n      return true;\n    }\n  };\n\n  DialogEdit.prototype.updateScheduleFields = function (dialog, ganttProp, ganttField) {\n    var ganttObj = this.parent;\n    var ganttId = ganttObj.element.id;\n    var columnName = getValue(ganttField, ganttObj.columnMapping);\n    var col = ganttObj.columnByField[columnName];\n    var tempValue;\n    var taskField = this.parent.taskFields;\n\n    if (col.editType === 'stringedit') {\n      var textBox = dialog.querySelector('#' + ganttId + columnName).ej2_instances[0];\n      tempValue = !isNullOrUndefined(col.edit) && !isNullOrUndefined(col.edit.read) ? col.edit.read() : !isNullOrUndefined(col.valueAccessor) ? col.valueAccessor(columnName, ganttObj.editModule.dialogModule.editedRecord, col) : // eslint-disable-line\n      this.parent.dataOperation.getDurationString(ganttProp.duration, ganttProp.durationUnit);\n\n      if (textBox.value !== tempValue.toString() && taskField.duration === columnName) {\n        textBox.value = tempValue;\n        textBox.dataBind();\n      } else if (taskField.startDate === columnName || taskField.endDate === columnName) {\n        textBox.value = taskField.startDate === columnName ? ganttProp.startDate.toString() : ganttProp.endDate.toString();\n        textBox.dataBind();\n      }\n    } else if (col.editType === 'datepickeredit' || col.editType === 'datetimepickeredit') {\n      var picker = col.editType === 'datepickeredit' ? dialog.querySelector('#' + ganttId + columnName).ej2_instances[0] : dialog.querySelector('#' + ganttId + columnName).ej2_instances[0];\n      tempValue = ganttProp[ganttField];\n\n      if (isNullOrUndefined(picker.value) && !isNullOrUndefined(tempValue) || isNullOrUndefined(tempValue) && !isNullOrUndefined(picker.value) || picker.value !== tempValue && !isNullOrUndefined(picker.value) && !isNullOrUndefined(tempValue) && picker.value.toString() !== tempValue.toString()) {\n        picker.value = tempValue;\n        picker.dataBind();\n      }\n    } else if (col.editType === 'numericedit') {\n      var numericTextBox = dialog.querySelector('#' + ganttId + columnName).ej2_instances[0];\n      tempValue = ganttProp[ganttField];\n\n      if (!isNullOrUndefined(tempValue) && numericTextBox.value !== tempValue) {\n        numericTextBox.value = tempValue;\n        numericTextBox.dataBind();\n      }\n    }\n  };\n  /**\n   * @param {IGanttData} ganttData .\n   * @returns {void} .\n   * @private\n   */\n\n\n  DialogEdit.prototype.validateDuration = function (ganttData) {\n    var ganttProp = ganttData.ganttProperties;\n\n    if (!this.dialogEditValidationFlag) {\n      if (isNullOrUndefined(ganttProp.duration)) {\n        this.parent.setRecordValue('endDate', null, ganttProp, true);\n        this.parent.setRecordValue('isMilestone', false, ganttProp, true);\n      } else if (isScheduledTask(ganttProp) || !isNullOrUndefined(ganttProp.startDate)) {\n        if (ganttData.ganttProperties.isMilestone && ganttData.ganttProperties.duration !== 0) {\n          this.parent.dateValidationModule.calculateStartDate(ganttData);\n        }\n\n        this.parent.dateValidationModule.calculateEndDate(ganttData);\n      } else if (!isScheduledTask(ganttProp) && !isNullOrUndefined(ganttProp.endDate)) {\n        this.parent.dateValidationModule.calculateStartDate(ganttData);\n      }\n\n      var milestone = ganttProp.duration === 0 ? true : false;\n      this.parent.setRecordValue('isMilestone', milestone, ganttProp, true);\n      this.dialogEditValidationFlag = true;\n    }\n  };\n\n  DialogEdit.prototype.validateStartDate = function (ganttData) {\n    var ganttProp = ganttData.ganttProperties;\n    var tasks = this.parent.taskFields;\n\n    if (!this.dialogEditValidationFlag) {\n      if (isNullOrUndefined(ganttProp.startDate)) {\n        this.parent.setRecordValue('duration', null, ganttProp, true);\n        this.parent.setRecordValue('isMilestone', false, ganttProp, true);\n\n        if (this.parent.allowUnscheduledTasks && isNullOrUndefined(tasks.endDate)) {\n          this.parent.setRecordValue('endDate', null, ganttProp, true);\n        }\n      } else if (isScheduledTask(ganttProp)) {\n        if (isNullOrUndefined(tasks.duration)) {\n          this.parent.dateValidationModule.calculateDuration(ganttData);\n        } else if (isNullOrUndefined(tasks.endDate)) {\n          this.parent.dateValidationModule.calculateEndDate(ganttData);\n        } else {\n          this.parent.dateValidationModule.calculateEndDate(ganttData);\n        }\n      } else {\n        if (!isNullOrUndefined(ganttProp.endDate)) {\n          this.parent.dateValidationModule.calculateDuration(ganttData);\n        } else if (!isNullOrUndefined(ganttProp.duration)) {\n          this.parent.dateValidationModule.calculateEndDate(ganttData);\n        }\n      }\n\n      this.dialogEditValidationFlag = true;\n    }\n  };\n\n  DialogEdit.prototype.validateEndDate = function (ganttData) {\n    var ganttProp = ganttData.ganttProperties;\n    var tasks = this.parent.taskFields;\n\n    if (!this.dialogEditValidationFlag) {\n      if (isNullOrUndefined(ganttProp.endDate)) {\n        this.parent.setRecordValue('duration', null, ganttProp, true);\n        this.parent.setRecordValue('isMilestone', false, ganttProp, true);\n      } else if (isScheduledTask(ganttProp)) {\n        if (isNullOrUndefined(tasks.duration)) {\n          this.parent.dateValidationModule.calculateDuration(ganttData);\n        } else if (isNullOrUndefined(ganttProp.startDate)) {\n          this.parent.dateValidationModule.calculateStartDate(ganttData);\n        } else {\n          if (!isNullOrUndefined(ganttProp.segments) && ganttProp.segments.length > 0) {\n            ganttProp.segments = this.parent.editModule.cellEditModule.validateEndDateWithSegments(ganttProp);\n          }\n\n          this.parent.dateValidationModule.calculateDuration(ganttData);\n        }\n      } else {\n        if (!isNullOrUndefined(ganttProp.duration)) {\n          this.parent.dateValidationModule.calculateStartDate(ganttData);\n        } else if (!isNullOrUndefined(ganttProp.startDate)) {\n          this.parent.dateValidationModule.calculateDuration(ganttData);\n        }\n      }\n\n      this.dialogEditValidationFlag = true;\n    }\n  };\n  /**\n   *\n   * @param {string} columnName .\n   * @param {string} value .\n   * @param {IGanttData} currentData .\n   * @returns {boolean} .\n   * @private\n   */\n\n\n  DialogEdit.prototype.validateScheduleValuesByCurrentField = function (columnName, value, currentData) {\n    var ganttObj = this.parent;\n    var ganttProp = currentData.ganttProperties;\n    var taskSettings = ganttObj.taskFields;\n\n    if (taskSettings.duration === columnName) {\n      if (!isNullOrUndefined(value) && value !== '') {\n        ganttObj.dataOperation.updateDurationValue(value, ganttProp);\n      } else {\n        if (ganttObj.allowUnscheduledTasks) {\n          this.parent.setRecordValue('duration', null, ganttProp, true);\n        }\n      }\n\n      this.validateDuration(currentData);\n      this.parent.editModule.updateResourceRelatedFields(currentData, 'duration');\n    }\n\n    if (taskSettings.startDate === columnName) {\n      if (value !== '') {\n        var startDate = this.parent.dateValidationModule.getDateFromFormat(value);\n        startDate = this.parent.dateValidationModule.checkStartDate(startDate, ganttProp);\n        this.parent.setRecordValue('startDate', startDate, ganttProp, true);\n      } else {\n        if (ganttObj.allowUnscheduledTasks && !currentData.hasChildRecords) {\n          this.parent.setRecordValue('startDate', null, ganttProp, true);\n        }\n      }\n\n      this.validateStartDate(currentData);\n    }\n\n    if (taskSettings.endDate === columnName) {\n      if (value !== '') {\n        var endDate = this.parent.dateValidationModule.getDateFromFormat(value);\n\n        if (endDate.getHours() === 0 && ganttObj.defaultEndTime !== 86400) {\n          this.parent.dateValidationModule.setTime(ganttObj.defaultEndTime, endDate);\n        }\n\n        endDate = this.parent.dateValidationModule.checkEndDate(endDate, ganttProp);\n\n        if (isNullOrUndefined(ganttProp.startDate) || endDate.getTime() > ganttProp.startDate.getTime()) {\n          this.parent.setRecordValue('endDate', endDate, ganttProp, true);\n        }\n      } else {\n        if (ganttObj.allowUnscheduledTasks) {\n          this.parent.setRecordValue('endDate', null, ganttProp, true);\n        }\n      }\n\n      this.validateEndDate(currentData);\n    }\n\n    if (taskSettings.work === columnName) {\n      if (!isNullOrUndefined(value) && value !== '') {\n        this.parent.setRecordValue('work', value, ganttProp, true);\n        this.parent.editModule.updateResourceRelatedFields(currentData, 'work');\n        this.validateDuration(currentData);\n      }\n    }\n\n    if (columnName === 'taskType') {\n      this.parent.setRecordValue('taskType', value, ganttProp, true);\n    }\n\n    if (taskSettings.manual === columnName) {\n      this.parent.editModule.updateTaskScheduleModes(currentData);\n    }\n\n    return true;\n  };\n\n  DialogEdit.prototype.getSegmentsModel = function (fields) {\n    var _this = this;\n\n    var taskSettings = this.parent.taskFields;\n\n    if (isNullOrUndefined(fields) || fields.length === 0) {\n      fields = [];\n\n      if (!isNullOrUndefined(taskSettings.startDate)) {\n        fields.push('startDate');\n      }\n\n      if (!isNullOrUndefined(taskSettings.endDate)) {\n        fields.push('endDate');\n      }\n\n      if (!isNullOrUndefined(taskSettings.duration)) {\n        fields.push('duration');\n      }\n    }\n\n    var segmentInputModel = {};\n    segmentInputModel.editSettings = {\n      allowEditing: true,\n      allowAdding: true,\n      allowDeleting: true,\n      mode: 'Normal',\n      newRowPosition: 'Bottom'\n    };\n    segmentInputModel.locale = this.parent.locale;\n    segmentInputModel.dataSource = [];\n    segmentInputModel.rowHeight = this.parent.isAdaptive ? 48 : null;\n    segmentInputModel.toolbar = [{\n      id: this.parent.element.id + 'SegmentsTabContainer' + '_add',\n      prefixIcon: 'e-add',\n      tooltipText: this.localeObj.getConstant('add'),\n      align: 'Right',\n      text: this.parent.isAdaptive ? '' : this.localeObj.getConstant('add')\n    }, {\n      id: this.parent.element.id + 'SegmentsTabContainer' + '_delete',\n      prefixIcon: 'e-delete',\n      tooltipText: this.localeObj.getConstant('delete'),\n      align: 'Right',\n      text: this.parent.isAdaptive ? '' : this.localeObj.getConstant('delete')\n    }];\n    var gridColumns = [];\n\n    var _loop_1 = function (i) {\n      var gridColumn = {};\n      var generalTabString = 'General';\n\n      switch (fields[i]) {\n        case 'startDate':\n        case 'endDate':\n          gridColumn = {\n            field: fields[i],\n            headerText: this_1.localeObj.getConstant(fields[i]),\n            editType: 'stringedit',\n            width: '200px',\n            edit: {\n              write: function (args) {\n                var datePickerModel = _this.beforeOpenArgs[generalTabString][_this.parent.taskFields[fields[i]]];\n                var value = args.rowData[args.column.field];\n                setValue('value', value, datePickerModel);\n                var datePicker = new DatePicker(datePickerModel);\n                datePicker.appendTo(args.element);\n              },\n              read: function (args) {\n                var ej2Instance = args.ej2_instances[0];\n                return ej2Instance.value;\n              }\n            },\n            format: this_1.parent.getDateFormat()\n          };\n\n          if (fields[i] === 'startDate') {\n            gridColumn.validationRules = {\n              required: true\n            };\n          }\n\n          gridColumns.push(gridColumn);\n          break;\n\n        case 'duration':\n          gridColumn = {\n            field: fields[i],\n            headerText: this_1.localeObj.getConstant(fields[i]),\n            editType: 'stringedit',\n            width: '100px',\n            edit: {\n              write: function (args) {\n                var inputTextModel = _this.beforeOpenArgs[generalTabString][_this.parent.taskFields[fields[i]]];\n                inputTextModel.floatLabelType = 'Never';\n                var value = args.rowData[args.column.field];\n\n                if (!isNullOrUndefined(value)) {\n                  setValue('value', value, inputTextModel);\n                } else {\n                  setValue('value', null, inputTextModel);\n                }\n\n                setValue('value', value, inputTextModel);\n                var inputModel = new TextBox(inputTextModel);\n                inputModel.appendTo(args.element);\n              },\n              read: function (args) {\n                var ej2Instance = args.ej2_instances[0];\n                return ej2Instance.value.toString();\n              }\n            }\n          };\n          gridColumns.push(gridColumn);\n          break;\n      }\n    };\n\n    var this_1 = this;\n\n    for (var i = 0; i < fields.length; i++) {\n      _loop_1(i);\n    }\n\n    segmentInputModel.columns = gridColumns;\n    segmentInputModel.height = this.parent.isAdaptive ? '100%' : '153px';\n    return segmentInputModel;\n  };\n\n  DialogEdit.prototype.getGridColumnByField = function (fieldName, columns) {\n    var column;\n\n    for (var i = 0; i < columns.length; i++) {\n      if (columns[i].field === fieldName) {\n        column = columns[i];\n      }\n    }\n\n    return column;\n  };\n\n  DialogEdit.prototype.updateSegmentField = function (columnName, args, segment) {\n    var dialog = this.parent.editModule.dialogModule.dialog;\n    var gridModel = getValue('Segments', this.beforeOpenArgs);\n    var col = this.getGridColumnByField(columnName, gridModel.columns);\n    var ganttId = this.parent.element.id;\n    var tempValue = segment[columnName];\n    var inputValue;\n\n    if (col.editType === 'stringedit') {\n      inputValue = dialog.querySelector('#' + ganttId + 'SegmentsTabContainer' + columnName).ej2_instances[0];\n    } else if (col.editType === 'datepickeredit') {\n      inputValue = dialog.querySelector('#' + ganttId + 'SegmentsTabContainer' + columnName).ej2_instances[0];\n    }\n\n    if (inputValue.value !== tempValue.toString()) {\n      inputValue.value = tempValue;\n      inputValue.dataBind();\n    }\n  };\n\n  DialogEdit.prototype.validateSegmentFields = function (ganttObj, columnName, cellValue, args) {\n    var taskSettings = this.parent.taskFields;\n\n    if (!isNullOrUndefined(taskSettings.duration) && taskSettings.duration.toLowerCase() === columnName.toLowerCase()) {\n      if (!isNullOrUndefined(cellValue) && cellValue !== '') {\n        this.selectedSegment.duration = Number(cellValue);\n        var endDate = ganttObj.dataOperation.getEndDate(this.selectedSegment.startDate, Number(cellValue), this.editedRecord.ganttProperties.durationUnit, this.editedRecord.ganttProperties, false);\n        endDate = ganttObj.dataOperation.checkEndDate(endDate, this.editedRecord.ganttProperties, false);\n        this.selectedSegment.endDate = endDate;\n      }\n    }\n\n    if (!isNullOrUndefined(taskSettings.startDate) && taskSettings.startDate.toLowerCase() === columnName.toLowerCase()) {\n      if (cellValue !== '') {\n        var startDate = this.parent.dateValidationModule.getDateFromFormat(cellValue);\n        startDate = this.parent.dateValidationModule.checkStartDate(startDate);\n        this.selectedSegment.startDate = startDate;\n\n        if (!isNullOrUndefined(taskSettings.endDate)) {\n          this.selectedSegment.endDate = this.parent.dataOperation.getEndDate(startDate, this.selectedSegment.duration, this.editedRecord.ganttProperties.durationUnit, this.editedRecord.ganttProperties, false);\n        }\n      }\n    }\n\n    if (!isNullOrUndefined(taskSettings.endDate) && taskSettings.endDate.toLowerCase() === columnName.toLowerCase()) {\n      if (cellValue !== '') {\n        var endDate = this.parent.dateValidationModule.getDateFromFormat(cellValue);\n\n        if (endDate.getHours() === 0 && ganttObj.defaultEndTime !== 86400) {\n          this.parent.dateValidationModule.setTime(ganttObj.defaultEndTime, endDate);\n        }\n\n        endDate = this.parent.dateValidationModule.checkEndDate(endDate, this.editedRecord.ganttProperties);\n        this.selectedSegment.endDate = endDate;\n        this.selectedSegment.duration = this.parent.dataOperation.getDuration(this.selectedSegment.startDate, this.selectedSegment.endDate, this.editedRecord.ganttProperties.durationUnit, true, false, true);\n      }\n    }\n\n    if (!isNullOrUndefined(taskSettings.startDate)) {\n      this.updateSegmentField('startDate', args, this.selectedSegment);\n    }\n\n    if (!isNullOrUndefined(taskSettings.endDate)) {\n      this.updateSegmentField('endDate', args, this.selectedSegment);\n    }\n\n    if (!isNullOrUndefined(taskSettings.duration)) {\n      this.updateSegmentField('duration', args, this.selectedSegment);\n    }\n  };\n\n  DialogEdit.prototype.getPredecessorModel = function (fields) {\n    if (isNullOrUndefined(fields) || fields.length === 0) {\n      fields = ['ID', 'Name', 'Type', 'Offset', 'UniqueId'];\n    }\n\n    var inputModel = {};\n    inputModel.editSettings = {\n      allowEditing: true,\n      allowAdding: true,\n      allowDeleting: true,\n      mode: 'Normal'\n    };\n    inputModel.locale = this.parent.locale;\n    inputModel.dataSource = [];\n    inputModel.rowHeight = this.parent.isAdaptive ? 48 : null;\n    inputModel.toolbar = [{\n      id: this.parent.element.id + 'DependencyTabContainer' + '_add',\n      prefixIcon: 'e-add',\n      tooltipText: this.localeObj.getConstant('add'),\n      align: 'Right',\n      text: this.parent.isAdaptive ? '' : this.localeObj.getConstant('add')\n    }, {\n      id: this.parent.element.id + 'DependencyTabContainer' + '_delete',\n      prefixIcon: 'e-delete',\n      tooltipText: this.localeObj.getConstant('delete'),\n      align: 'Right',\n      text: this.parent.isAdaptive ? '' : this.localeObj.getConstant('delete')\n    }];\n    var columns = [];\n\n    for (var i = 0; i < fields.length; i++) {\n      var column = {};\n\n      if (fields[i].toLowerCase() === 'id') {\n        column = {\n          field: 'id',\n          headerText: this.localeObj.getConstant('id'),\n          allowEditing: false,\n          width: '70px'\n        };\n        columns.push(column);\n      } else if (fields[i].toLowerCase() === 'name') {\n        column = {\n          field: 'name',\n          headerText: this.localeObj.getConstant('name'),\n          editType: 'stringedit',\n          width: '250px',\n          validationRules: {\n            required: true\n          }\n        };\n        columns.push(column);\n      } else if (fields[i].toLowerCase() === 'type') {\n        column = {\n          field: 'type',\n          headerText: this.localeObj.getConstant('type'),\n          editType: 'dropdownedit',\n          dataSource: this.types,\n          foreignKeyField: 'id',\n          foreignKeyValue: 'text',\n          defaultValue: 'FS',\n          validationRules: {\n            required: true\n          },\n          width: '150px'\n        };\n        columns.push(column);\n      } else if (fields[i].toLowerCase() === 'offset') {\n        column = {\n          field: 'offset',\n          headerText: this.localeObj.getConstant('offset'),\n          editType: 'stringedit',\n          defaultValue: this.parent.dataOperation.getDurationString(0, this.beforeOpenArgs.rowData.ganttProperties.durationUnit),\n          validationRules: {\n            required: true\n          },\n          width: '100px'\n        };\n        columns.push(column);\n      } else if (fields[i].toLowerCase() === 'uniqueid') {\n        column = {\n          field: 'uniqueId',\n          isPrimaryKey: true,\n          visible: false,\n          defaultValue: getUid().toString()\n        };\n        columns.push(column);\n      }\n    }\n\n    inputModel.columns = columns;\n    inputModel.height = this.parent.isAdaptive ? '100%' : '153px';\n    return inputModel;\n  };\n\n  DialogEdit.prototype.getResourcesModel = function (fields) {\n    var ganttObj = this.parent;\n    var resourceSettings = ganttObj.resourceFields;\n\n    if (isNullOrUndefined(fields) || fields.length === 0) {\n      fields = [resourceSettings.id, resourceSettings.name, resourceSettings.unit, resourceSettings.group];\n    }\n\n    var inputModel = {\n      allowFiltering: true,\n      treeColumnIndex: -1,\n      childMapping: '',\n      editSettings: {\n        allowEditing: true,\n        mode: 'Cell'\n      },\n      locale: this.parent.locale,\n      allowSelection: true,\n      rowHeight: this.parent.isAdaptive ? 48 : null,\n      filterSettings: {\n        type: 'Menu'\n      },\n      selectionSettings: {\n        checkboxOnly: true,\n        checkboxMode: 'Default',\n        persistSelection: true,\n        type: 'Multiple'\n      }\n    };\n    var columns = [{\n      type: 'checkbox',\n      allowEditing: false,\n      allowSorting: false,\n      allowFiltering: false,\n      width: 60\n    }];\n\n    for (var i = 0; i < fields.length; i++) {\n      var column = {};\n\n      if (fields[i] === resourceSettings.id) {\n        column = {\n          field: resourceSettings.id,\n          headerText: this.localeObj.getConstant('id'),\n          isPrimaryKey: true,\n          width: '100px',\n          allowEditing: false\n        };\n        columns.push(column);\n      } else if (fields[i] === resourceSettings.name) {\n        column = {\n          field: resourceSettings.name,\n          headerText: this.localeObj.getConstant('name'),\n          allowEditing: false\n        };\n        columns.push(column);\n      } else if (fields[i] === resourceSettings.unit) {\n        column = {\n          field: resourceSettings.unit,\n          headerText: this.localeObj.getConstant('unit'),\n          editType: 'numericedit',\n          edit: {\n            params: {\n              min: 0\n            }\n          }\n        };\n        columns.push(column);\n      } else if (fields[i] === resourceSettings.group && !isNullOrUndefined(resourceSettings.group)) {\n        column = {\n          field: resourceSettings.group,\n          headerText: this.localeObj.getConstant('group'),\n          allowEditing: false\n        };\n        columns.push(column);\n      }\n    }\n\n    inputModel.columns = columns;\n    inputModel.height = this.parent.isAdaptive ? '100%' : '196px';\n    return inputModel;\n  };\n\n  DialogEdit.prototype.getNotesModel = function (fields) {\n    if (isNullOrUndefined(fields) || fields.length === 0) {\n      fields = ['Bold', 'Italic', 'Underline', 'StrikeThrough', 'FontName', 'FontSize', 'FontColor', 'BackgroundColor', 'LowerCase', 'UpperCase', '|', 'Alignments', 'OrderedList', 'UnorderedList', 'Outdent', 'Indent', '|', 'CreateTable', 'CreateLink', '|', 'ClearFormat', 'Print', '|', 'Undo', 'Redo'];\n    }\n\n    var inputModel = {\n      placeholder: this.localeObj.getConstant('writeNotes'),\n      toolbarSettings: {\n        items: fields\n      },\n      height: this.parent.isAdaptive ? '100%' : 'auto',\n      locale: this.parent.locale\n    };\n    return inputModel;\n  };\n\n  DialogEdit.prototype.createDivElement = function (className, id) {\n    return createElement('div', {\n      className: className,\n      id: id\n    });\n  };\n\n  DialogEdit.prototype.createInputElement = function (className, id, fieldName, type) {\n    return createElement(type || 'input', {\n      className: className,\n      attrs: {\n        type: 'text',\n        id: id,\n        name: fieldName,\n        title: fieldName\n      }\n    });\n  };\n\n  DialogEdit.prototype.renderTabItems = function () {\n    var tabModel = this.beforeOpenArgs.tabModel;\n    var items = tabModel.items;\n    var index = 0;\n\n    for (var i = 0; i < items.length; i++) {\n      var item = items[i];\n\n      if (item.content instanceof HTMLElement) {\n        continue;\n      } else if (item.content === 'General') {\n        item.content = this.renderGeneralTab(item.content);\n      } else if (item.content === 'Dependency') {\n        if (this.editedRecord.hasChildRecords) {\n          item.disabled = true;\n        }\n\n        item.content = this.renderPredecessorTab(item.content);\n      } else if (item.content === 'Resources') {\n        item.content = this.renderResourceTab(item.content);\n      } else if (item.content === 'Custom' + '' + index) {\n        item.content = this.renderCustomTab(item.content);\n        index++;\n      } else if (item.content === 'Notes') {\n        item.content = this.renderNotesTab(item.content);\n      } else if (item.content === 'Segments') {\n        if (this.editedRecord.hasChildRecords) {\n          item.disabled = true;\n        }\n\n        item.content = this.renderSegmentsTab(item.content);\n      }\n    }\n  };\n\n  DialogEdit.prototype.segmentGridActionBegin = function (args) {\n    var taskFields = this.parent.taskFields;\n    var itemName = 'Segments';\n    var gridModel = this.beforeOpenArgs[itemName];\n\n    if (args.requestType === 'add' || args.requestType === 'beginEdit' || args.requestType === 'save') {\n      var gridData = gridModel.dataSource;\n      var selectedItem = getValue('rowData', args);\n      var startDate = this.beforeOpenArgs.rowData.ganttProperties.startDate;\n\n      if (!isNullOrUndefined(startDate)) {\n        if (args.requestType === 'add') {\n          var arg = {};\n          var sDate = getValue('startDate', selectedItem);\n          var eDate = getValue('endDate', selectedItem);\n          var duration = getValue('duration', selectedItem);\n          var startDate_1 = !isNullOrUndefined(gridData) && gridData.length > 0 ? !isNullOrUndefined(taskFields.endDate) ? new Date(getValue('endDate', gridData[0]).getTime()) : new Date(getValue('startDate', gridData[0]).getTime()) : !isNullOrUndefined(this.beforeOpenArgs.rowData.ganttProperties.startDate) && new Date(this.beforeOpenArgs.rowData.ganttProperties.startDate.getTime());\n          startDate_1.setHours(0, 0, 0, 0);\n\n          if (!isNullOrUndefined(gridData) && gridData.length > 0) {\n            startDate_1.setDate(startDate_1.getDate() + 2);\n          }\n\n          sDate = this.parent.dataOperation.checkStartDate(startDate_1);\n          eDate = this.parent.dateValidationModule.getDateFromFormat(sDate);\n\n          if (eDate.getHours() === 0 && this.parent.defaultEndTime !== 86400) {\n            this.parent.dateValidationModule.setTime(this.parent.defaultEndTime, eDate);\n          }\n\n          eDate = !isNullOrUndefined(taskFields.endDate) && !isNullOrUndefined(gridData) && gridData.length <= 0 ? this.beforeOpenArgs.rowData.ganttProperties.endDate : eDate;\n          duration = !isNullOrUndefined(taskFields.duration) && !isNullOrUndefined(gridData) && gridData.length <= 0 ? this.beforeOpenArgs.rowData.ganttProperties.duration : 1;\n          arg = {\n            startDate: sDate,\n            endDate: eDate,\n            duration: duration\n          };\n          args.rowData = arg;\n        }\n      }\n\n      this.selectedSegment = args.rowData; // if (args.requestType === 'save') {\n      //     // let duration: string = 'duration';\n      //     // let tempDuration: Object = this.parent.dataOperation.getDurationValue(args.data[duration]);\n      //     // args.data[duration] = getValue('duration', tempDuration);\n      //     this.selectedSegment = !isNullOrUndefined(this.editedRecord.ganttProperties.segments[args.rowIndex]) ?\n      //         this.editedRecord.ganttProperties.segments[args.rowIndex] : !isNullOrUndefined(gridData[args.rowIndex]) ?\n      //             gridData[args.rowIndex] : gridData;\n      // }\n    }\n  };\n\n  DialogEdit.prototype.renderSegmentsTab = function (itemName) {\n    var ganttObj = this.parent;\n    var gridModel = this.beforeOpenArgs[itemName];\n    var ganttData = this.beforeOpenArgs.rowData;\n    var preData = [];\n\n    if (this.isEdit) {\n      preData = isNullOrUndefined(ganttData.ganttProperties.segments) ? [] : ganttData.ganttProperties.segments;\n    }\n\n    gridModel.dataSource = preData;\n    gridModel.actionBegin = this.segmentGridActionBegin.bind(this);\n    Grid.Inject(Edit, Page, GridToolbar, ForeignKey);\n    var gridObj = new Grid(gridModel);\n    var divElement = this.createDivElement('', ganttObj.element.id + '' + itemName + 'TabContainer');\n    gridObj.appendTo(divElement);\n    return divElement;\n  };\n\n  DialogEdit.prototype.renderGeneralTab = function (itemName) {\n    var ganttObj = this.parent;\n    var itemModel = this.beforeOpenArgs[itemName];\n    var divElement = this.createDivElement('e-edit-form-row', ganttObj.element.id + '' + itemName + 'TabContainer');\n\n    for (var _i = 0, _a = Object.keys(itemModel); _i < _a.length; _i++) {\n      var key = _a[_i];\n\n      if (this.parent.columnByField[key].visible === false) {\n        continue;\n      }\n\n      var column = this.parent.columnByField[key];\n      var inputModel = itemModel[key];\n      divElement.appendChild(this.renderInputElements(inputModel, column));\n    }\n\n    return divElement;\n  };\n\n  DialogEdit.prototype.isCheckIsDisabled = function (column) {\n    var disabled = false;\n\n    if (column.allowEditing === false || column.isPrimaryKey || this.parent.readOnly) {\n      if (this.parent.customColumns.indexOf(column.field) !== -1) {\n        disabled = true;\n      } else {\n        if (column.field === this.parent.taskFields.id || column.field === this.parent.taskFields.name || column.field === this.parent.taskFields.duration || column.field === this.parent.taskFields.progress || column.field === this.parent.taskFields.startDate || column.field === this.parent.taskFields.endDate || column.field === this.parent.taskFields.baselineStartDate || column.field === this.parent.taskFields.baselineEndDate || column.field === this.parent.taskFields.work || column.field === 'taskType') {\n          disabled = true;\n        }\n      }\n    }\n\n    if (this.isEdit) {\n      if (column.field === this.parent.taskFields.id) {\n        disabled = true;\n      }\n\n      if (this.editedRecord.hasChildRecords) {\n        if (column.field === this.parent.taskFields.endDate || column.field === this.parent.taskFields.duration || column.field === this.parent.taskFields.progress || column.field === this.parent.taskFields.work || column.field === 'taskType') {\n          disabled = true;\n        }\n      }\n    }\n\n    return disabled;\n  };\n\n  DialogEdit.prototype.renderPredecessorTab = function (itemName) {\n    var _this = this;\n\n    var ganttObj = this.parent;\n    var gridModel = this.beforeOpenArgs[itemName];\n    var dependencyColumn = this.parent.columnByField[this.parent.taskFields.dependency];\n\n    if (dependencyColumn.allowEditing === false || dependencyColumn.isPrimaryKey || this.parent.readOnly) {\n      gridModel.editSettings.allowEditing = false;\n      gridModel.editSettings.allowAdding = false;\n      gridModel.editSettings.allowDeleting = false;\n    }\n\n    var ganttData = this.beforeOpenArgs.rowData;\n    var preData = [];\n    this.taskNameCollection();\n\n    if (this.isEdit) {\n      preData = this.predecessorEditCollection(ganttData);\n      this.updatePredecessorDropDownData(ganttData);\n    }\n\n    gridModel.dataSource = preData;\n    gridModel.actionBegin = this.gridActionBegin.bind(this);\n    var columns = gridModel.columns;\n    columns[1].edit = {\n      write: function (args) {\n        if (getValue('requestType', args) === 'add') {\n          setValue('rowData.uniqueId', getUid(), args);\n        }\n\n        var field = 'name';\n        var autoObj = new ComboBox({\n          dataSource: new DataManager(_this.idCollection),\n          popupHeight: '180px',\n          allowCustom: false,\n          fields: {\n            value: 'text'\n          },\n          value: args.rowData[field],\n          change: function (arg) {\n            var tr = closest(arg.element, 'tr');\n            var idInput = tr.querySelector('#' + _this.parent.element.id + 'DependencyTabContainerid');\n\n            if (idInput) {\n              if (!isNullOrUndefined(arg.itemData) && !isNullOrUndefined(arg.item)) {\n                idInput.value = arg.itemData.id;\n              } else {\n                idInput.value = '';\n              }\n            }\n          },\n          autofill: true\n        });\n        autoObj.appendTo(args.element);\n      },\n      read: function (args) {\n        var ej2Instance = args.ej2_instances[0];\n        return ej2Instance.value;\n      }\n    };\n    Grid.Inject(Edit, Page, GridToolbar, ForeignKey);\n    var gridObj = new Grid(gridModel);\n    var divElement = this.createDivElement('e-dependent-div', ganttObj.element.id + '' + itemName + 'TabContainer');\n    gridObj.appendTo(divElement);\n    return divElement;\n  };\n\n  DialogEdit.prototype.gridActionBegin = function (args) {\n    var _this = this;\n\n    var itemName = 'Dependency';\n    var gridModel = this.beforeOpenArgs[itemName];\n\n    if (args.requestType === 'add' || args.requestType === 'beginEdit') {\n      var isEdit_1 = args.requestType === 'add' ? false : true;\n      this.idCollection = extend([], [], this.preTableCollection, true);\n      var gridData_1 = gridModel.dataSource;\n\n      var _loop_2 = function (i) {\n        // eslint-disable-next-line\n        this_2.idCollection.forEach(function (data, index) {\n          if (data.id === getValue('id', gridData_1[i])) {\n            var selectedItem = getValue('rowData', args);\n\n            if (isEdit_1 && getValue('id', selectedItem) === data.id) {\n              return;\n            }\n\n            _this.idCollection.splice(_this.idCollection.indexOf(data), 1);\n          }\n        });\n      };\n\n      var this_2 = this;\n\n      for (var i = 0; i <= gridData_1.length; i++) {\n        _loop_2(i);\n      }\n    }\n  };\n\n  DialogEdit.prototype.updateResourceCollection = function (args, resourceTreeGridId) {\n    if (!isNullOrUndefined(args.data) && Object.keys(args.data).length) {\n      var ganttObj = this.parent;\n      var treeGridId = document.querySelector('#' + resourceTreeGridId);\n      var resourceTreeGrid = treeGridId.ej2_instances[0];\n\n      if (!isNullOrUndefined(resourceTreeGrid) && resourceTreeGrid.getSelectedRecords().length > 0) {\n        var tempRecords = resourceTreeGrid.getSelectedRecords();\n        var index = void 0;\n        var selectedItems = [];\n\n        for (index = 0; index < tempRecords.length; index++) {\n          selectedItems.push(tempRecords[index].taskData);\n        }\n\n        this.ganttResources = extend([], selectedItems);\n      } else {\n        this.ganttResources = [];\n      }\n    } else {\n      this.ganttResources = [];\n    }\n  };\n\n  DialogEdit.prototype.renderResourceTab = function (itemName) {\n    var _this = this;\n\n    var ganttObj = this.parent;\n    var resourceSettings = ganttObj.resourceFields;\n    var ganttData = this.beforeOpenArgs.rowData;\n    var rowResource = ganttData.ganttProperties.resourceInfo;\n    var inputModel = this.beforeOpenArgs[itemName];\n    var resourceTreeGridId = ganttObj.element.id + '' + itemName + 'TabContainer';\n    var resourceData = extend([], [], ganttObj.resources, true);\n    this.parent.dataOperation.updateResourceUnit(resourceData);\n\n    if (!isNullOrUndefined(rowResource)) {\n      var count = void 0;\n      var rowResourceLength = rowResource.length;\n      var index = void 0;\n      var resourceDataLength = resourceData.length;\n\n      for (count = 0; count < rowResourceLength; count++) {\n        for (index = 0; index < resourceDataLength; index++) {\n          if (rowResource[count][resourceSettings.id] === resourceData[index][resourceSettings.id]) {\n            resourceData[index][resourceSettings.unit] = rowResource[count][resourceSettings.unit];\n          }\n        }\n      }\n    }\n\n    inputModel.dataSource = resourceData;\n    var resourceInfo = ganttData.ganttProperties.resourceInfo;\n\n    if (this.isEdit && !isNullOrUndefined(resourceInfo)) {\n      for (var i = 0; i < resourceInfo.length; i++) {\n        this.ganttResources.push(resourceInfo[i]);\n      }\n    }\n\n    inputModel.rowSelected = function (args) {\n      _this.updateResourceCollection(args, resourceTreeGridId);\n    };\n\n    inputModel.rowDeselected = function (args) {\n      _this.updateResourceCollection(args, resourceTreeGridId);\n    };\n\n    var divElement = this.createDivElement('e-resource-div', resourceTreeGridId);\n    TreeGrid.Inject(Selection, Filter, TreeGridEdit, VirtualScroll);\n    var treeGridObj = new TreeGrid(inputModel);\n    var resourceColumn = this.parent.columnByField[this.parent.taskFields.resourceInfo];\n\n    if (resourceColumn.allowEditing === false || resourceColumn.isPrimaryKey || this.parent.readOnly) {\n      treeGridObj.allowSelection = false;\n      treeGridObj.allowFiltering = false;\n      treeGridObj.editSettings.allowEditing = false;\n    }\n\n    treeGridObj.dataBound = function () {\n      if (_this.parent.editDialogFields.length >= 1 && _this.parent.editDialogFields[0].type === 'Resources') {\n        var id = _this.parent.element.id + 'ResourcesTabContainer';\n\n        _this.resourceSelection(id);\n      }\n    };\n\n    treeGridObj.appendTo(divElement);\n    return divElement;\n  };\n\n  DialogEdit.prototype.resourceSelection = function (id) {\n    var _this = this;\n\n    var resourceTreeGrid = document.querySelector('#' + id).ej2_instances[0];\n    var currentViewData = resourceTreeGrid.getCurrentViewRecords();\n    var resources = this.ganttResources;\n\n    if (resources && resources.length > 0) {\n      currentViewData.forEach(function (data, index) {\n        for (var i = 0; i < resources.length; i++) {\n          if (data.taskData[_this.parent.resourceFields.id] === resources[i][_this.parent.resourceFields.id] && !isNullOrUndefined(resourceTreeGrid.selectionModule) && resourceTreeGrid.getSelectedRowIndexes().indexOf(index) === -1) {\n            resourceTreeGrid.selectRow(index);\n          }\n        }\n      });\n    }\n  };\n\n  DialogEdit.prototype.renderCustomTab = function (itemName) {\n    return this.renderGeneralTab(itemName);\n  };\n\n  DialogEdit.prototype.renderNotesTab = function (itemName) {\n    var ganttObj = this.parent;\n    var inputModel = this.beforeOpenArgs[itemName];\n    var ganttProp = this.editedRecord.ganttProperties;\n    var divElement = this.createDivElement('', ganttObj.element.id + '' + itemName + 'TabContainer');\n    RichTextEditor.Inject(RTEToolbar, Link, HtmlEditor, QuickToolbar, Count);\n    inputModel.value = ganttProp.notes;\n    var notesColumn = this.parent.columnByField[this.parent.taskFields.notes];\n\n    if (notesColumn.allowEditing === false || notesColumn.isPrimaryKey || this.parent.readOnly) {\n      inputModel.enabled = false;\n    }\n\n    var rteObj = new RichTextEditor(inputModel);\n    rteObj.appendTo(divElement);\n    return divElement;\n  };\n\n  DialogEdit.prototype.renderInputElements = function (inputModel, column) {\n    var _this = this;\n\n    var ganttId = this.parent.element.id;\n    var ganttData = this.editedRecord;\n    var divElement = this.createDivElement('e-edit-form-column');\n    var inputElement;\n    var editArgs = {\n      column: column,\n      data: ganttData\n    };\n\n    if (!isNullOrUndefined(column.edit) && isNullOrUndefined(column.edit.params)) {\n      var create = column.edit.create;\n\n      if (typeof create === 'string') {\n        create = getObject(create, window);\n        inputElement = create(editArgs);\n      } else {\n        inputElement = column.edit.create(editArgs);\n      }\n\n      inputElement.className = '';\n      inputElement.setAttribute('type', 'text');\n      inputElement.setAttribute('id', ganttId + '' + column.field);\n      inputElement.setAttribute('name', column.field);\n      inputElement.setAttribute('title', column.field);\n      divElement.appendChild(inputElement);\n    } else {\n      inputElement = this.createInputElement('', ganttId + '' + column.field, column.field);\n      divElement.appendChild(inputElement);\n    }\n\n    inputModel.enabled = !this.isCheckIsDisabled(column);\n\n    if (column.field === this.parent.taskFields.duration) {\n      if (!isNullOrUndefined(column.valueAccessor)) {\n        if (typeof column.valueAccessor === 'string') {\n          var valueAccessor = getObject(column.valueAccessor, window);\n          inputModel.value = valueAccessor(column.field, ganttData, column);\n        } else {\n          inputModel.value = column.valueAccessor(column.field, ganttData, column);\n        }\n      } else if (isNullOrUndefined(column.edit)) {\n        var ganttProp = ganttData.ganttProperties;\n        inputModel.value = this.parent.dataOperation.getDurationString(ganttProp.duration, ganttProp.durationUnit);\n      }\n    } else {\n      if (column.editType === 'booleanedit') {\n        if (ganttData[column.field] === true) {\n          inputModel.checked = true;\n        } else {\n          inputModel.checked = false;\n        }\n      } else {\n        inputModel.value = ganttData[column.field];\n      }\n    }\n\n    if (!isNullOrUndefined(column.edit) && isNullOrUndefined(column.edit.params)) {\n      var write = column.edit.write;\n      var inputObj = void 0;\n\n      if (typeof write === 'string') {\n        write = getObject(write, window);\n        inputObj = write({\n          column: column,\n          rowData: ganttData,\n          element: inputElement\n        });\n      } else {\n        inputObj = column.edit.write({\n          column: column,\n          rowData: ganttData,\n          element: inputElement\n        });\n      }\n\n      if (column.field === this.parent.taskFields.duration) {\n        inputObj.change = function (args) {\n          _this.validateScheduleFields(args, column, _this.parent);\n        };\n      }\n    } else {\n      var inputObj = new this.inputs[column.editType](inputModel);\n      inputObj.appendTo(inputElement);\n    }\n\n    return divElement;\n  };\n\n  DialogEdit.prototype.taskNameCollection = function () {\n    var flatData = this.parent.flatData;\n    this.preTaskIds = [];\n    this.preTableCollection = [];\n\n    for (var i = 0; i < flatData.length; i++) {\n      var data = flatData[i];\n\n      if (data.hasChildRecords) {\n        continue;\n      }\n\n      var taskId = this.parent.viewType === 'ResourceView' ? data.ganttProperties.taskId.toString() : data.ganttProperties.rowUniqueID.toString();\n      var tempObject = {\n        id: taskId,\n        text: taskId + '-' + data.ganttProperties.taskName,\n        value: taskId\n      };\n      this.preTaskIds.push(tempObject.id);\n      this.preTableCollection.push(tempObject);\n    }\n  };\n\n  DialogEdit.prototype.predecessorEditCollection = function (ganttData) {\n    var preDataCollection = [];\n    var ganttProp = ganttData.ganttProperties;\n\n    if (this.isEdit && !isNullOrUndefined(this.parent.taskFields.dependency) && !isNullOrUndefined(ganttData) && !isNullOrUndefined(ganttProp.predecessor)) {\n      var predecessor = ganttProp.predecessor;\n      var idCollection = this.preTableCollection;\n\n      for (var i = 0; i < predecessor.length; i++) {\n        var from = predecessor[i].from.toString();\n        var preData = {};\n        var taskID = this.parent.viewType === 'ResourceView' ? ganttProp.taskId : ganttProp.rowUniqueID;\n\n        if (taskID.toString() !== from) {\n          preData.id = from;\n\n          for (var index = 0; index < idCollection.length; index++) {\n            if (idCollection[index].value === from) {\n              preData.name = idCollection[index].text;\n              break;\n            }\n          }\n\n          preData.type = predecessor[i].type;\n          var offset = predecessor[i].offset;\n          var offsetUnit = predecessor[i].offsetUnit;\n          preData.offset = this.parent.dataOperation.getDurationString(offset, offsetUnit);\n          preData.uniqueId = getUid();\n          preDataCollection.push(preData);\n        }\n      }\n    }\n\n    return preDataCollection;\n  };\n\n  DialogEdit.prototype.updatePredecessorDropDownData = function (ganttData) {\n    var index = -1;\n    var id = this.parent.viewType === 'ResourceView' ? ganttData.ganttProperties.taskId.toString() : ganttData.ganttProperties.rowUniqueID.toString();\n    index = this.preTaskIds.indexOf(id);\n    this.preTableCollection.splice(index, 1);\n    this.preTaskIds.splice(index, 1);\n    this.validSuccessorTasks(ganttData, this.preTaskIds, this.preTableCollection);\n  };\n\n  DialogEdit.prototype.validSuccessorTasks = function (data, ids, idCollection) {\n    var _this = this;\n\n    var ganttProp = data.ganttProperties;\n\n    if (ganttProp.predecessor && ganttProp.predecessor.length > 0) {\n      var predecessor = ganttProp.predecessor;\n      var fromId_1 = this.parent.viewType === 'ResourceView' ? ganttProp.taskId.toString() : ganttProp.rowUniqueID.toString();\n      predecessor.forEach(function (item) {\n        if (item.from.toString() === fromId_1) {\n          var toId = item.to;\n          var idIndex = -1;\n          idIndex = ids.indexOf(toId);\n\n          if (idIndex > -1) {\n            ids.splice(idIndex, 1);\n            idCollection.splice(idIndex, 1);\n          }\n\n          var ganttData = _this.parent.connectorLineModule.getRecordByID(toId);\n\n          _this.validSuccessorTasks(ganttData, ids, idCollection);\n        }\n      });\n    }\n  };\n\n  DialogEdit.prototype.getPredecessorType = function () {\n    var typeText = [this.parent.getPredecessorTextValue('SS'), this.parent.getPredecessorTextValue('SF'), this.parent.getPredecessorTextValue('FS'), this.parent.getPredecessorTextValue('FF')];\n    var types = [{\n      id: 'FS',\n      text: typeText[2],\n      value: typeText[2]\n    }, {\n      id: 'FF',\n      text: typeText[3],\n      value: typeText[3]\n    }, {\n      id: 'SS',\n      text: typeText[0],\n      value: typeText[0]\n    }, {\n      id: 'SF',\n      text: typeText[1],\n      value: typeText[1]\n    }];\n    return types;\n  };\n\n  DialogEdit.prototype.initiateDialogSave = function () {\n    if (this.isEdit) {\n      this.parent.initiateEditAction(true);\n    } else {\n      this.addedRecord = {};\n    }\n\n    var ganttObj = this.parent;\n    var tabModel = this.beforeOpenArgs.tabModel;\n    var items = tabModel.items;\n\n    for (var i = 0; i < items.length; i++) {\n      var element = items[i].content;\n      var id = element.id;\n\n      if (!isNullOrUndefined(id) || id !== '') {\n        id = id.replace(ganttObj.element.id, '');\n        id = id.replace('TabContainer', '');\n\n        if (id === 'General') {\n          this.updateGeneralTab(element, false);\n        } else if (id === 'Dependency') {\n          this.updatePredecessorTab(element);\n        } else if (id === 'Notes') {\n          this.updateNotesTab(element);\n        } else if (id === 'Resources') {\n          this.updateResourceTab(element);\n        } else if (id.indexOf('Custom') !== -1) {\n          this.updateCustomTab(element);\n        } else if (id === 'Segments') {\n          this.updateSegmentsData(element, this.beforeOpenArgs.rowData);\n        }\n      }\n    }\n\n    if (this.isEdit) {\n      /**\n       * If any update on edited task do it here\n       */\n      this.parent.dataOperation.updateWidthLeft(this.rowData);\n      var editArgs = {\n        data: this.rowData,\n        action: 'DialogEditing'\n      };\n      this.parent.editModule.initiateUpdateAction(editArgs);\n    } else {\n      if (this.parent.viewType === 'ResourceView') {\n        var newRecords = extend({}, this.addedRecord, true);\n\n        if (newRecords[this.parent.taskFields.resourceInfo].length) {\n          for (var i = 0; i < newRecords[this.parent.taskFields.resourceInfo].length; i++) {\n            var id = newRecords[this.parent.taskFields.resourceInfo][i].toString();\n            var parentRecordIndex = this.parent.getTaskIds().indexOf('R' + id.toString());\n\n            if (parentRecordIndex !== -1) {\n              this.parent.editModule.addRecord(this.addedRecord, 'Child', parentRecordIndex);\n              break;\n            }\n          }\n        } else {\n          this.parent.editModule.addRecord(this.addedRecord, 'Bottom');\n        }\n      } else {\n        this.parent.editModule.addRecord(this.addedRecord, this.parent.editSettings.newRowPosition);\n      }\n    }\n\n    return true;\n  };\n\n  DialogEdit.prototype.updateSegmentTaskData = function (dataSource) {\n    var userData = [];\n    var taskSettings = this.parent.taskFields;\n\n    for (var i = 0; i < dataSource.length; i++) {\n      var taskData = {};\n\n      if (!isNullOrUndefined(taskSettings.startDate)) {\n        taskData[this.parent.taskFields.startDate] = dataSource[i].startDate;\n      }\n\n      if (!isNullOrUndefined(taskSettings.endDate)) {\n        taskData[this.parent.taskFields.endDate] = dataSource[i].endDate;\n      }\n\n      if (!isNullOrUndefined(taskSettings.duration)) {\n        taskData[this.parent.taskFields.duration] = Number(dataSource[i].duration);\n        dataSource[i].duration = taskData[this.parent.taskFields.duration];\n      }\n\n      userData.push(taskData);\n    }\n\n    if (!this.isEdit) {\n      this.addedRecord[taskSettings.segments] = userData;\n    } else {\n      this.rowData.ganttProperties.segments = dataSource;\n      this.parent.setRecordValue('segments', this.parent.dataOperation.setSegmentsInfo(this.rowData, false), this.rowData.ganttProperties, true);\n      this.parent.setRecordValue('taskData.' + this.parent.taskFields.segments, userData, this.rowData);\n    }\n  }; // eslint-disable-next-line\n\n\n  DialogEdit.prototype.updateSegmentsData = function (segmentForm, data) {\n    var gridObj = segmentForm.ej2_instances[0];\n\n    if (gridObj.isEdit) {\n      gridObj.endEdit();\n    }\n\n    var dataSource = gridObj.currentViewData;\n    this.updateSegmentTaskData(dataSource);\n  };\n\n  DialogEdit.prototype.updateGeneralTab = function (generalForm, isCustom) {\n    var ganttObj = this.parent;\n    var childNodes = generalForm.childNodes;\n    var tasksData = {};\n\n    if (!this.isEdit) {\n      tasksData = this.addedRecord;\n    }\n\n    for (var i = 0; i < childNodes.length; i++) {\n      var div = childNodes[i];\n      var inputElement = div.querySelector('input[id^=\"' + ganttObj.element.id + '\"]');\n\n      if (inputElement) {\n        var fieldName = inputElement.id.replace(ganttObj.element.id, '');\n        var controlObj = div.querySelector('#' + ganttObj.element.id + fieldName).ej2_instances[0];\n        var column = ganttObj.columnByField[fieldName];\n\n        if (!isNullOrUndefined(column.edit) && isNullOrUndefined(column.edit.params)) {\n          var read = column.edit.read;\n\n          if (typeof read === 'string') {\n            read = getObject(read, window);\n            tasksData[fieldName] = read(inputElement, controlObj.value);\n          } else {\n            tasksData[fieldName] = column.edit.read(inputElement, controlObj.value);\n          }\n        } else if (isCustom && column.editType === 'booleanedit') {\n          if (inputElement.checked === true) {\n            tasksData[fieldName] = true;\n          } else {\n            tasksData[fieldName] = false;\n          }\n        } else {\n          tasksData[fieldName] = controlObj.value;\n        }\n      }\n    }\n\n    if (this.isEdit) {\n      this.updateScheduleProperties(this.editedRecord, this.rowData);\n      ganttObj.editModule.validateUpdateValues(tasksData, this.rowData, true);\n    }\n  };\n\n  DialogEdit.prototype.updateScheduleProperties = function (fromRecord, toRecord) {\n    this.parent.setRecordValue('startDate', fromRecord.ganttProperties.startDate, toRecord.ganttProperties, true);\n    this.parent.setRecordValue('endDate', fromRecord.ganttProperties.endDate, toRecord.ganttProperties, true);\n    this.parent.setRecordValue('duration', fromRecord.ganttProperties.duration, toRecord.ganttProperties, true);\n    this.parent.setRecordValue('durationUnit', fromRecord.ganttProperties.durationUnit, toRecord.ganttProperties, true);\n    this.parent.setRecordValue('work', fromRecord.ganttProperties.work, toRecord.ganttProperties, true);\n\n    if (!isNullOrUndefined(this.parent.taskFields.startDate)) {\n      this.parent.dataOperation.updateMappingData(this.rowData, this.parent.taskFields.startDate);\n    }\n\n    if (!isNullOrUndefined(this.parent.taskFields.endDate)) {\n      this.parent.dataOperation.updateMappingData(this.rowData, this.parent.taskFields.endDate);\n    }\n\n    if (!isNullOrUndefined(this.parent.taskFields.duration)) {\n      this.parent.dataOperation.updateMappingData(this.rowData, this.parent.taskFields.duration);\n      this.parent.setRecordValue('durationUnit', fromRecord.ganttProperties.durationUnit, this.rowData, true);\n\n      if (this.rowData.ganttProperties.duration === 0) {\n        this.parent.setRecordValue('isMilestone', true, this.rowData.ganttProperties, true);\n      } else {\n        this.parent.setRecordValue('isMilestone', false, this.rowData.ganttProperties, true);\n      }\n    }\n\n    if (!isNullOrUndefined(this.parent.taskFields.work)) {\n      this.parent.dataOperation.updateMappingData(this.rowData, this.parent.taskFields.work);\n    }\n\n    if (!isNullOrUndefined(this.parent.taskFields.manual)) {\n      this.parent.dataOperation.updateMappingData(this.rowData, this.parent.taskFields.manual);\n    }\n  };\n\n  DialogEdit.prototype.updatePredecessorTab = function (preElement) {\n    var gridObj = preElement.ej2_instances[0];\n\n    if (gridObj.isEdit) {\n      gridObj.endEdit();\n    }\n\n    var dataSource = gridObj.dataSource;\n    var predecessorName = [];\n    var newValues = [];\n    var predecessorString = '';\n    var ids = [];\n\n    for (var i = 0; i < dataSource.length; i++) {\n      var preData = dataSource[i];\n      var newId = preData.name.split('-')[0];\n\n      if (preData.id !== newId) {\n        preData.id = newId;\n      }\n\n      if (ids.indexOf(preData.id) === -1) {\n        var name_1 = preData.id + preData.type;\n\n        if (preData.offset && preData.offset.indexOf('-') !== -1) {\n          name_1 += preData.offset;\n        } else {\n          name_1 += '+' + preData.offset;\n        }\n\n        predecessorName.push(name_1);\n        ids.push(preData.id);\n      }\n    }\n\n    if (this.isEdit) {\n      if (predecessorName.length > 0) {\n        newValues = this.parent.predecessorModule.calculatePredecessor(predecessorName.join(','), this.rowData);\n        this.parent.setRecordValue('predecessor', newValues, this.rowData.ganttProperties, true);\n        predecessorString = this.parent.predecessorModule.getPredecessorStringValue(this.rowData);\n      } else {\n        newValues = [];\n        this.parent.setRecordValue('predecessor', newValues, this.rowData.ganttProperties, true);\n        predecessorString = '';\n      }\n\n      this.parent.setRecordValue('predecessorsName', predecessorString, this.rowData.ganttProperties, true);\n      this.parent.setRecordValue('taskData.' + this.parent.taskFields.dependency, predecessorString, this.rowData);\n      this.parent.setRecordValue(this.parent.taskFields.dependency, predecessorString, this.rowData);\n      this.parent.predecessorModule.updateUnscheduledDependency(this.rowData);\n    } else {\n      this.addedRecord[this.parent.taskFields.dependency] = predecessorName.length > 0 ? predecessorName.join(',') : '';\n    }\n  };\n\n  DialogEdit.prototype.updateResourceTab = function (resourceElement) {\n    var treeGridObj = resourceElement.ej2_instances[0];\n\n    if (treeGridObj) {\n      treeGridObj.grid.endEdit();\n    }\n\n    var selectedItems = this.ganttResources;\n\n    if (this.parent.viewType === 'ResourceView' && !isNullOrUndefined(this.rowData.ganttProperties)) {\n      if (JSON.stringify(this.ganttResources) !== JSON.stringify(this.rowData.ganttProperties.resourceInfo)) {\n        this.isResourceUpdate = true;\n        this.previousResource = !isNullOrUndefined(this.rowData.ganttProperties.resourceInfo) ? this.rowData.ganttProperties.resourceInfo.slice() : [];\n      } else {\n        this.isResourceUpdate = false;\n      }\n    }\n\n    var idArray = [];\n\n    if (this.isEdit) {\n      this.parent.setRecordValue('resourceInfo', selectedItems, this.rowData.ganttProperties, true);\n      this.parent.dataOperation.updateMappingData(this.rowData, 'resourceInfo');\n      this.parent.editModule.updateResourceRelatedFields(this.rowData, 'resource');\n      this.validateDuration(this.rowData);\n    } else {\n      for (var i = 0; i < selectedItems.length; i++) {\n        idArray.push(selectedItems[i][this.parent.resourceFields.id]);\n        this.isAddNewResource = true;\n      }\n\n      this.addedRecord[this.parent.taskFields.resourceInfo] = idArray;\n    }\n  };\n\n  DialogEdit.prototype.updateNotesTab = function (notesElement) {\n    var ganttObj = this.parent;\n    var rte = notesElement.ej2_instances[0];\n\n    if (this.isEdit) {\n      if (ganttObj.columnByField[ganttObj.taskFields.notes].disableHtmlEncode) {\n        this.parent.setRecordValue('notes', rte.getHtml(), this.rowData.ganttProperties, true);\n      } else {\n        this.parent.setRecordValue('notes', rte.getText(), this.rowData.ganttProperties, true);\n      }\n\n      ganttObj.dataOperation.updateMappingData(this.rowData, 'notes');\n    } else {\n      this.addedRecord[this.parent.taskFields.notes] = rte.getHtml();\n    }\n  };\n\n  DialogEdit.prototype.updateCustomTab = function (customElement) {\n    this.updateGeneralTab(customElement, true);\n  };\n\n  return DialogEdit;\n}();\n\nexport { DialogEdit };","map":{"version":3,"sources":["/Users/tristanbilot/Desktop/Design4green/design4green/node_modules/@syncfusion/ej2-gantt/src/gantt/actions/dialog-edit.js"],"names":["remove","extend","isNullOrUndefined","createElement","getValue","setValue","closest","DataManager","DataUtil","Dialog","Tab","Grid","Edit","Toolbar","GridToolbar","Page","getObject","ForeignKey","getActualProperties","RichTextEditor","RTEToolbar","Link","HtmlEditor","QuickToolbar","Count","TextBox","NumericTextBox","MaskedTextBox","CheckBox","DatePicker","DateTimePicker","DropDownList","ComboBox","isScheduledTask","TreeGrid","Selection","Filter","TreeGridEdit","VirtualScroll","getUid","DialogEdit","parent","updatedEditFields","updatedAddFields","addedRecord","dialogEditValidationFlag","ganttResources","previousResource","isResourceUpdate","localeObj","beforeOpenArgs","cancel","types","getPredecessorType","rowData","editedRecord","inputs","booleanedit","dropdownedit","datepickeredit","datetimepickeredit","maskededit","numericedit","stringedit","processDialogFields","wireEvents","prototype","on","dblClickHandler","e","ganttData","ganttChartModule","getRecordByTarget","editModule","editSettings","allowEditing","openEditDialog","editDialogFields","length","getDefaultDialogFields","validateDialogFields","addDialogFields","dialogFields","newDialogFields","emptyCustomColumn","i","fieldItem","type","fields","getGeneralColumnFields","taskFields","dependency","resourceInfo","notes","getCustomColumnFields","push","_i","_a","Object","keys","columnMapping","key","customColumns","columnByField","valueOf","visible","openAddDialog","isEdit","composeAddRecord","createDialog","getMinimumStartDate","minDate","aggregates","min","flatData","Date","getTime","timelineModule","timelineStartDate","dateValidationModule","checkStartDate","tempData","ganttProperties","columns","ganttColumns","taskSettings","id","getNewTaskId","field","rowUniqueID","startDate","endDate","timezone","duration","durationUnit","toLocaleLowerCase","name","taskName","progress","work","taskType","isAutoSchedule","taskMode","manual","openToolbarEditDialog","gObj","focusedRowIndex","selectionModule","selectRow","selectedRowId","selectionSettings","mode","selectedRowIndexes","updatedRecords","getSelectedRowCellIndexes","rowIndex","taskId","ganttObj","currentViewData","indexOf","ids","toString","selectedRowIndex","viewType","level","_this","dialogModel","dialogMaxWidth","isAdaptive","dialog","element","styles","appendChild","animationSettings","effect","header","getConstant","isModal","cssClass","allowDragging","showCloseIcon","position","X","Y","height","target","document","body","close","dialogClose","bind","closeOnEscape","open","args","dialogElement","generalTabElement","querySelector","scrollHeight","offsetHeight","classList","add","tabObj","selectedItem","select","style","maxHeight","focusModule","setActiveElement","locale","buttons","buttonModel","content","click","buttonClick","createTab","pointerEvents","toLowerCase","innerText","trim","dialogObj","isDestroyed","hide","initiateDialogSave","resetValues","getActiveElement","focus","isAddNewResource","destroyDialogInnerElements","destroy","tabModel","items","replace","destroyCustomField","gridObj","ej2_instances","rte","treeGridObj","childNodes","div","inputElement","fieldName","controlObj","column","edit","params","window","off","dialogModule","undefined","getEditFields","tabItems","dialogSettings","tabElement","tasks","count","index","dialogField","tabItem","headerText","getFieldsModel","segments","getSegmentsModel","getPredecessorModel","getResourcesModel","getNotesModel","text","requestType","trigger","arg","renderTabItems","selected","tabSelectedEvent","overflowMode","isStringTemplate","appendTo","actionCompleteArgs","action","data","actionCompleteArg","selectedContent","responsiveTabContent","resourceSelection","getElementById","refresh","enableToolbarItems","dialogContent","dialogContentHeight","clientHeight","grid","contains","getHeaderContent","toolbar_1","parentElement","fieldsModel","createInputModel","common","placeholder","floatLabelType","editType","checkboxModel","label","textBox","change","validateScheduleFields","numeric","max","datePickerObj","format","getDateFormat","strictMode","firstDayOfWeek","customTimelineSettings","weekStartDay","renderDayCell","renderWorkingDayCell","dateTimePickerObj","dataKey","fieldsKey","value","dropDownListObj","targetId","currentData","cellValue","colName","getAttribute","container","event","path","search","validateSegmentFields","validateScheduleValuesByCurrentField","ganttProp","updateScheduleFields","ganttField","ganttId","columnName","col","tempValue","taskField","read","valueAccessor","dataOperation","getDurationString","dataBind","picker","numericTextBox","validateDuration","setRecordValue","isMilestone","calculateStartDate","calculateEndDate","milestone","validateStartDate","allowUnscheduledTasks","calculateDuration","validateEndDate","cellEditModule","validateEndDateWithSegments","updateDurationValue","updateResourceRelatedFields","getDateFromFormat","hasChildRecords","getHours","defaultEndTime","setTime","checkEndDate","updateTaskScheduleModes","segmentInputModel","allowAdding","allowDeleting","newRowPosition","dataSource","rowHeight","toolbar","prefixIcon","tooltipText","align","gridColumns","_loop_1","gridColumn","generalTabString","this_1","width","write","datePickerModel","datePicker","ej2Instance","validationRules","required","inputTextModel","inputModel","getGridColumnByField","updateSegmentField","segment","gridModel","inputValue","selectedSegment","Number","getEndDate","getDuration","foreignKeyField","foreignKeyValue","defaultValue","isPrimaryKey","resourceSettings","resourceFields","unit","group","allowFiltering","treeColumnIndex","childMapping","allowSelection","filterSettings","checkboxOnly","checkboxMode","persistSelection","allowSorting","toolbarSettings","createDivElement","className","createInputElement","attrs","title","item","HTMLElement","renderGeneralTab","disabled","renderPredecessorTab","renderResourceTab","renderCustomTab","renderNotesTab","renderSegmentsTab","segmentGridActionBegin","itemName","gridData","sDate","eDate","startDate_1","setHours","setDate","getDate","preData","actionBegin","Inject","divElement","itemModel","renderInputElements","isCheckIsDisabled","readOnly","baselineStartDate","baselineEndDate","dependencyColumn","taskNameCollection","predecessorEditCollection","updatePredecessorDropDownData","gridActionBegin","autoObj","idCollection","popupHeight","allowCustom","tr","idInput","itemData","autofill","isEdit_1","preTableCollection","gridData_1","_loop_2","this_2","forEach","splice","updateResourceCollection","resourceTreeGridId","treeGridId","resourceTreeGrid","getSelectedRecords","tempRecords","selectedItems","taskData","rowResource","resourceData","resources","updateResourceUnit","rowResourceLength","resourceDataLength","rowSelected","rowDeselected","resourceColumn","dataBound","getCurrentViewRecords","getSelectedRowIndexes","notesColumn","enabled","rteObj","editArgs","create","setAttribute","checked","inputObj","preTaskIds","tempObject","preDataCollection","predecessor","from","taskID","offset","offsetUnit","uniqueId","validSuccessorTasks","fromId_1","toId","to","idIndex","connectorLineModule","getRecordByID","typeText","getPredecessorTextValue","initiateEditAction","updateGeneralTab","updatePredecessorTab","updateNotesTab","updateResourceTab","updateCustomTab","updateSegmentsData","updateWidthLeft","initiateUpdateAction","newRecords","parentRecordIndex","getTaskIds","addRecord","updateSegmentTaskData","userData","setSegmentsInfo","segmentForm","endEdit","generalForm","isCustom","tasksData","updateScheduleProperties","validateUpdateValues","fromRecord","toRecord","updateMappingData","preElement","predecessorName","newValues","predecessorString","newId","split","name_1","predecessorModule","calculatePredecessor","join","getPredecessorStringValue","updateUnscheduledDependency","resourceElement","JSON","stringify","slice","idArray","notesElement","disableHtmlEncode","getHtml","getText","customElement"],"mappings":"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","sourcesContent":["import { remove, extend, isNullOrUndefined, createElement, getValue, setValue, closest } from '@syncfusion/ej2-base';\nimport { DataManager, DataUtil } from '@syncfusion/ej2-data';\nimport { Dialog } from '@syncfusion/ej2-popups';\nimport { Tab } from '@syncfusion/ej2-navigations';\nimport { Grid, Edit, Toolbar as GridToolbar, Page, getObject } from '@syncfusion/ej2-grids';\nimport { ForeignKey, getActualProperties } from '@syncfusion/ej2-grids';\nimport { RichTextEditor, Toolbar as RTEToolbar, Link, HtmlEditor, QuickToolbar, Count } from '@syncfusion/ej2-richtexteditor';\nimport { TextBox, NumericTextBox, MaskedTextBox } from '@syncfusion/ej2-inputs';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { DatePicker, DateTimePicker } from '@syncfusion/ej2-calendars';\nimport { DropDownList, ComboBox } from '@syncfusion/ej2-dropdowns';\nimport { isScheduledTask } from '../base/utils';\nimport { TreeGrid, Selection, Filter, Edit as TreeGridEdit, VirtualScroll } from '@syncfusion/ej2-treegrid';\nimport { getUid } from '../base/utils';\n/**\n *\n * @hidden\n */\nvar DialogEdit = /** @class */ (function () {\n    /**\n     * Constructor for render module\n     *\n     * @param {Gantt} parent .\n     * @returns {void} .\n     */\n    function DialogEdit(parent) {\n        /**\n         * @private\n         */\n        this.updatedEditFields = null;\n        this.updatedAddFields = null;\n        this.addedRecord = null;\n        this.dialogEditValidationFlag = false;\n        this.ganttResources = [];\n        /**\n         * @private\n         */\n        this.previousResource = [];\n        /**\n         * @private\n         */\n        this.isResourceUpdate = false;\n        this.parent = parent;\n        this.localeObj = this.parent.localeObj;\n        this.beforeOpenArgs = { cancel: false };\n        this.types = this.getPredecessorType();\n        this.rowData = {};\n        this.editedRecord = {};\n        this.inputs = {\n            booleanedit: CheckBox,\n            dropdownedit: DropDownList,\n            datepickeredit: DatePicker,\n            datetimepickeredit: DateTimePicker,\n            maskededit: MaskedTextBox,\n            numericedit: NumericTextBox,\n            stringedit: TextBox\n        };\n        this.processDialogFields();\n        this.wireEvents();\n    }\n    DialogEdit.prototype.wireEvents = function () {\n        this.parent.on('chartDblClick', this.dblClickHandler, this);\n    };\n    DialogEdit.prototype.dblClickHandler = function (e) {\n        var ganttData = this.parent.ganttChartModule.getRecordByTarget(e);\n        if (!isNullOrUndefined(ganttData) && this.parent.editModule && this.parent.editSettings.allowEditing) {\n            this.openEditDialog(ganttData);\n        }\n    };\n    /**\n     * Method to validate add and edit dialog fields property.\n     *\n     * @returns {void} .\n     * @private\n     */\n    DialogEdit.prototype.processDialogFields = function () {\n        if (isNullOrUndefined(this.parent.editDialogFields) ||\n            this.parent.editDialogFields && this.parent.editDialogFields.length === 0) {\n            this.updatedEditFields = this.getDefaultDialogFields();\n            this.updatedEditFields = this.validateDialogFields(this.updatedEditFields);\n        }\n        else {\n            this.updatedEditFields = this.validateDialogFields(this.parent.editDialogFields);\n        }\n        if (isNullOrUndefined(this.parent.addDialogFields) ||\n            this.parent.addDialogFields && this.parent.addDialogFields.length === 0) {\n            this.updatedAddFields = this.getDefaultDialogFields();\n            this.updatedAddFields = this.validateDialogFields(this.updatedAddFields);\n        }\n        else {\n            this.updatedAddFields = this.validateDialogFields(this.parent.addDialogFields);\n        }\n    };\n    DialogEdit.prototype.validateDialogFields = function (dialogFields) {\n        var newDialogFields = [];\n        var emptyCustomColumn = 0;\n        for (var i = 0; i < dialogFields.length; i++) {\n            var fieldItem = getActualProperties(dialogFields[i]);\n            if (fieldItem.type === 'General' && (isNullOrUndefined(fieldItem.fields) || fieldItem.fields.length === 0)) {\n                fieldItem.fields = this.getGeneralColumnFields();\n            }\n            if (fieldItem.type === 'Dependency' && isNullOrUndefined(this.parent.taskFields.dependency)\n                || fieldItem.type === 'Resources' && isNullOrUndefined(this.parent.taskFields.resourceInfo)\n                || fieldItem.type === 'Notes' && isNullOrUndefined(this.parent.taskFields.notes)) {\n                continue;\n            }\n            if (fieldItem.type === 'Custom' && (isNullOrUndefined(fieldItem.fields) || fieldItem.fields.length === 0)) {\n                emptyCustomColumn += 1;\n                fieldItem.fields = this.getCustomColumnFields();\n            }\n            if (emptyCustomColumn > 1) {\n                continue;\n            }\n            newDialogFields.push(fieldItem);\n        }\n        return newDialogFields;\n    };\n    /**\n     * Method to get general column fields\n     *\n     * @returns {string[]} .\n     */\n    DialogEdit.prototype.getGeneralColumnFields = function () {\n        var fields = [];\n        for (var _i = 0, _a = Object.keys(this.parent.columnMapping); _i < _a.length; _i++) {\n            var key = _a[_i];\n            if (key === 'dependency' || key === 'resourceInfo' || key === 'notes') {\n                continue;\n            }\n            fields.push(this.parent.columnMapping[key]);\n        }\n        return fields;\n    };\n    /**\n     * Method to get custom column fields\n     *\n     * @returns {void} .\n     */\n    DialogEdit.prototype.getCustomColumnFields = function () {\n        var fields = [];\n        for (var i = 0; i < this.parent.customColumns.length; i++) {\n            fields.push(this.parent.customColumns[i]);\n        }\n        return fields;\n    };\n    /**\n     * Get default dialog fields when fields are not defined for add and edit dialogs\n     *\n     * @returns {AddDialogFieldSettings} .\n     */\n    DialogEdit.prototype.getDefaultDialogFields = function () {\n        var dialogFields = [];\n        var fieldItem = {};\n        var taskFields = this.parent.taskFields;\n        var columnMapping = this.parent.columnMapping;\n        if (Object.keys(columnMapping).length !== 0) {\n            fieldItem.type = 'General';\n            dialogFields.push(fieldItem);\n        }\n        if (!isNullOrUndefined(getValue('dependency', columnMapping))) {\n            fieldItem = {};\n            if (this.parent.columnByField[columnMapping.dependency.valueOf()].visible !== false) {\n                fieldItem.type = 'Dependency';\n            }\n            dialogFields.push(fieldItem);\n        }\n        if (!isNullOrUndefined(getValue('resourceInfo', columnMapping))) {\n            fieldItem = {};\n            if (this.parent.columnByField[columnMapping.resourceInfo.valueOf()].visible !== false) {\n                fieldItem.type = 'Resources';\n            }\n            dialogFields.push(fieldItem);\n        }\n        if (!isNullOrUndefined(getValue('notes', columnMapping))) {\n            fieldItem = {};\n            if (this.parent.columnByField[columnMapping.notes.valueOf()].visible !== false) {\n                fieldItem.type = 'Notes';\n            }\n            dialogFields.push(fieldItem);\n        }\n        if (!isNullOrUndefined(getValue('segments', taskFields))) {\n            fieldItem = {};\n            fieldItem.type = 'Segments';\n            dialogFields.push(fieldItem);\n        }\n        if (this.parent.customColumns.length > 0) {\n            fieldItem = {};\n            fieldItem.type = 'Custom';\n            dialogFields.push(fieldItem);\n        }\n        return dialogFields;\n    };\n    /**\n     * @returns {void} .\n     * @private\n     */\n    DialogEdit.prototype.openAddDialog = function () {\n        this.isEdit = false;\n        this.editedRecord = this.composeAddRecord();\n        this.createDialog();\n    };\n    /**\n     *\n     * @returns {Date} .\n     * @private\n     */\n    DialogEdit.prototype.getMinimumStartDate = function () {\n        var minDate = DataUtil.aggregates.min(this.parent.flatData, 'ganttProperties.startDate');\n        if (!isNullOrUndefined(minDate)) {\n            minDate = new Date(minDate.getTime());\n        }\n        else {\n            minDate = new Date(this.parent.timelineModule.timelineStartDate.getTime());\n        }\n        minDate = this.parent.dateValidationModule.checkStartDate(minDate);\n        return new Date(minDate.getTime());\n    };\n    /**\n     * @returns {IGanttData} .\n     * @private\n     */\n    DialogEdit.prototype.composeAddRecord = function () {\n        var tempData = {};\n        tempData.ganttProperties = {};\n        var columns = this.parent.ganttColumns;\n        var taskSettings = this.parent.taskFields;\n        var id = this.parent.editModule.getNewTaskId();\n        for (var i = 0; i < columns.length; i++) {\n            var field = columns[i].field;\n            if (field === taskSettings.id) {\n                tempData[field] = id;\n                tempData.ganttProperties.rowUniqueID = tempData[field];\n            }\n            else if (columns[i].field === taskSettings.startDate) {\n                if (isNullOrUndefined(tempData[taskSettings.endDate])) {\n                    tempData[field] = this.getMinimumStartDate();\n                }\n                else {\n                    tempData[field] = new Date(tempData[taskSettings.endDate]);\n                }\n                if (this.parent.timezone) {\n                    tempData[field] = this.parent.dateValidationModule.remove(tempData[field], this.parent.timezone);\n                }\n                tempData.ganttProperties.startDate = new Date(tempData[field]);\n            }\n            else if (columns[i].field === taskSettings.endDate) {\n                if (isNullOrUndefined(tempData[taskSettings.startDate])) {\n                    tempData[field] = this.getMinimumStartDate();\n                }\n                else {\n                    tempData[field] = new Date(tempData[taskSettings.startDate]);\n                }\n                if (this.parent.timezone) {\n                    tempData[field] = this.parent.dateValidationModule.remove(tempData[field], this.parent.timezone);\n                }\n                tempData.ganttProperties.endDate = new Date(tempData[field]);\n            }\n            else if (columns[i].field === taskSettings.duration) {\n                tempData[field] = 1;\n                tempData.ganttProperties.duration = tempData[field];\n                tempData.ganttProperties.durationUnit = this.parent.durationUnit.toLocaleLowerCase();\n            }\n            else if (columns[i].field === taskSettings.name) {\n                tempData[field] = 'New Task ' + id;\n                tempData.ganttProperties.taskName = tempData[field];\n            }\n            else if (columns[i].field === taskSettings.progress) {\n                tempData[field] = 0;\n                tempData.ganttProperties.progress = tempData[field];\n            }\n            else if (columns[i].field === taskSettings.work) {\n                tempData[field] = 0;\n                tempData.ganttProperties.work = tempData[field];\n            }\n            else if (columns[i].field === 'taskType') {\n                tempData[field] = this.parent.taskType;\n                tempData.ganttProperties.taskType = tempData[field];\n            }\n            else {\n                tempData[this.parent.ganttColumns[i].field] = '';\n            }\n        }\n        tempData.ganttProperties.isAutoSchedule = (this.parent.taskMode === 'Auto') ? true :\n            (this.parent.taskMode === 'Manual') ? false :\n                tempData[taskSettings.manual] === true ? false : true;\n        return tempData;\n    };\n    /**\n     * @returns {void} .\n     * @private\n     */\n    DialogEdit.prototype.openToolbarEditDialog = function () {\n        var gObj = this.parent;\n        if (gObj.editModule && gObj.editSettings.allowEditing) {\n            if (this.parent.ganttChartModule.focusedRowIndex > -1 && gObj.selectionModule) {\n                gObj.selectionModule.selectRow(this.parent.ganttChartModule.focusedRowIndex, false, false);\n            }\n            var selectedRowId = gObj.selectionModule ?\n                (gObj.selectionSettings.mode === 'Row' || gObj.selectionSettings.mode === 'Both') &&\n                    gObj.selectionModule.selectedRowIndexes.length === 1 ?\n                    gObj.updatedRecords[gObj.selectionModule.selectedRowIndexes[0]].ganttProperties.rowUniqueID :\n                    gObj.selectionSettings.mode === 'Cell' &&\n                        gObj.selectionModule.getSelectedRowCellIndexes().length === 1 ?\n                        gObj.updatedRecords[gObj.selectionModule.getSelectedRowCellIndexes()[0].rowIndex].ganttProperties.rowUniqueID :\n                        null : null;\n            if (!isNullOrUndefined(selectedRowId)) {\n                this.openEditDialog(selectedRowId);\n            }\n        }\n    };\n    /**\n     * @param { number | string | object} taskId .\n     * @returns {void} .\n     * @private\n     */\n    DialogEdit.prototype.openEditDialog = function (taskId) {\n        var ganttObj = this.parent;\n        if (typeof taskId === 'object' && !isNullOrUndefined(taskId)) {\n            this.rowIndex = this.parent.currentViewData.indexOf(taskId);\n            if (this.rowIndex > -1) {\n                this.rowData = taskId;\n            }\n        }\n        else if (!isNullOrUndefined(taskId)) {\n            this.rowIndex = ganttObj.ids.indexOf(taskId.toString());\n            if (this.rowIndex > -1) {\n                this.rowData = ganttObj.flatData[this.rowIndex];\n            }\n        }\n        else if (ganttObj.selectedRowIndex > -1) {\n            this.rowData = ganttObj.currentViewData[ganttObj.selectedRowIndex];\n            this.rowIndex = ganttObj.selectedRowIndex;\n        }\n        this.isEdit = true;\n        if (this.parent.viewType === 'ResourceView' && this.rowData.level === 0) {\n            return;\n        }\n        if (Object.keys(this.rowData).length !== 0) {\n            this.editedRecord = extend({}, {}, this.rowData, true);\n            this.createDialog();\n        }\n    };\n    DialogEdit.prototype.createDialog = function () {\n        var _this = this;\n        var ganttObj = this.parent;\n        var dialogModel = {};\n        this.beforeOpenArgs.dialogModel = dialogModel;\n        this.beforeOpenArgs.rowData = this.editedRecord;\n        this.beforeOpenArgs.rowIndex = this.rowIndex;\n        var dialogMaxWidth = this.parent.isAdaptive ? '' : '600px';\n        var dialog = this.parent.createElement('div', { id: ganttObj.element.id + '_dialog', styles: 'max-width:' + dialogMaxWidth });\n        ganttObj.element.appendChild(dialog);\n        dialogModel.animationSettings = { effect: 'None' };\n        dialogModel.header = this.localeObj.getConstant(this.isEdit ? 'editDialogTitle' : 'addDialogTitle');\n        dialogModel.isModal = true;\n        dialogModel.cssClass = 'e-gantt-dialog';\n        dialogModel.allowDragging = this.parent.isAdaptive ? false : true;\n        dialogModel.showCloseIcon = true;\n        var position = this.parent.isAdaptive ? { X: 'top', Y: 'left' } : { X: 'center', Y: 'center' };\n        dialogModel.position = position;\n        //dialogModel.width = '750px';\n        dialogModel.height = this.parent.isAdaptive ? '100%' : 'auto';\n        dialogModel.target = document.body;\n        dialogModel.close = this.dialogClose.bind(this);\n        dialogModel.closeOnEscape = true;\n        dialogModel.open = function (args) {\n            var dialogElement = getValue('element', args);\n            var generalTabElement = dialogElement.querySelector('#' + _this.parent.element.id + 'GeneralTabContainer');\n            if (generalTabElement && generalTabElement.scrollHeight > generalTabElement.offsetHeight) {\n                generalTabElement.classList.add('e-scroll');\n            }\n            if (_this.tabObj.selectedItem === 0) {\n                _this.tabObj.select(0);\n            }\n            if (_this.parent.isAdaptive) {\n                dialogElement.style.maxHeight = 'none';\n            }\n            if (_this.parent.focusModule) {\n                _this.parent.focusModule.setActiveElement(dialogElement);\n            }\n        };\n        dialogModel.locale = this.parent.locale;\n        dialogModel.buttons = [{\n                buttonModel: {\n                    content: this.localeObj.getConstant('saveButton'), cssClass: 'e-primary'\n                },\n                click: this.buttonClick.bind(this)\n            }, {\n                buttonModel: { cssClass: 'e-flat', content: this.localeObj.getConstant('cancel') },\n                click: this.buttonClick.bind(this)\n            }];\n        this.createTab(dialogModel, dialog);\n    };\n    DialogEdit.prototype.buttonClick = function (e) {\n        var target = e.target;\n        target.style.pointerEvents = 'none';\n        if ((this.localeObj.getConstant('cancel')).toLowerCase() === e.target.innerText.trim().toLowerCase()) {\n            if (this.dialog && !this.dialogObj.isDestroyed) {\n                this.dialogObj.hide();\n                this.dialogClose();\n            }\n        }\n        else {\n            this.initiateDialogSave();\n            target.style.pointerEvents = 'auto';\n        }\n    };\n    /**\n     * @returns {void} .\n     * @private\n     */\n    DialogEdit.prototype.dialogClose = function () {\n        if (this.dialog) {\n            this.resetValues();\n        }\n        if (!isNullOrUndefined(this.parent.focusModule) &&\n            !isNullOrUndefined(this.parent.focusModule.getActiveElement(true))) {\n            this.parent.focusModule.getActiveElement(true).focus();\n        }\n    };\n    DialogEdit.prototype.resetValues = function () {\n        this.isEdit = false;\n        this.isAddNewResource = false;\n        this.editedRecord = {};\n        this.rowData = {};\n        this.rowIndex = -1;\n        this.addedRecord = null;\n        this.ganttResources = [];\n        this.dialogEditValidationFlag = false;\n        if (this.dialog && !this.dialogObj.isDestroyed) {\n            this.destroyDialogInnerElements();\n            this.dialogObj.destroy();\n            remove(this.dialog);\n        }\n    };\n    DialogEdit.prototype.destroyDialogInnerElements = function () {\n        var ganttObj = this.parent;\n        var tabModel = this.beforeOpenArgs.tabModel;\n        var items = tabModel.items;\n        for (var i = 0; i < items.length; i++) {\n            var element = items[i].content;\n            var id = element.id;\n            if (!isNullOrUndefined(id) || id !== '') {\n                id = id.replace(ganttObj.element.id, '');\n                id = id.replace('TabContainer', '');\n                if (id === 'General') {\n                    this.destroyCustomField(element);\n                }\n                else if (id === 'Dependency') {\n                    var gridObj = element.ej2_instances[0];\n                    gridObj.destroy();\n                }\n                else if (id === 'Notes') {\n                    var rte = element.ej2_instances[0];\n                    rte.destroy();\n                }\n                else if (id === 'Resources') {\n                    var treeGridObj = element.ej2_instances[0];\n                    treeGridObj.destroy();\n                }\n                else if (id.indexOf('Custom') !== -1) {\n                    this.destroyCustomField(element);\n                }\n            }\n        }\n    };\n    DialogEdit.prototype.destroyCustomField = function (element) {\n        var childNodes = element.childNodes;\n        var ganttObj = this.parent;\n        for (var i = 0; i < childNodes.length; i++) {\n            var div = childNodes[i];\n            var inputElement = div.querySelector('input[id^=\"' + ganttObj.element.id + '\"]');\n            if (inputElement) {\n                var fieldName = inputElement.id.replace(ganttObj.element.id, '');\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                var controlObj = div.querySelector('#' + ganttObj.element.id + fieldName).ej2_instances[0];\n                if (!isNullOrUndefined(controlObj)) {\n                    var column = ganttObj.columnByField[fieldName];\n                    if (!isNullOrUndefined(column.edit) && isNullOrUndefined(column.edit.params)) {\n                        var destroy = column.edit.destroy;\n                        if (typeof destroy === 'string') {\n                            destroy = getObject(destroy, window);\n                            destroy();\n                        }\n                        else {\n                            column.edit.destroy();\n                        }\n                    }\n                    else {\n                        controlObj.destroy();\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @returns {void} .\n     * @private\n     */\n    DialogEdit.prototype.destroy = function () {\n        this.resetValues();\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off('chartDblClick', this.dblClickHandler);\n        this.parent.editModule.dialogModule = undefined;\n    };\n    /**\n     * Method to get current edit dialog fields value\n     *\n     * @returns {AddDialogFieldSettings} .\n     */\n    DialogEdit.prototype.getEditFields = function () {\n        if (this.isEdit) {\n            return this.updatedEditFields;\n        }\n        else {\n            return this.updatedAddFields;\n        }\n    };\n    DialogEdit.prototype.createTab = function (dialogModel, dialog) {\n        var _this = this;\n        var ganttObj = this.parent;\n        var tabModel = {};\n        var tabItems = [];\n        var dialogSettings = this.getEditFields();\n        var tabElement;\n        var tasks = ganttObj.taskFields;\n        var length = dialogSettings.length;\n        tabModel.items = tabItems;\n        tabModel.locale = this.parent.locale;\n        this.beforeOpenArgs.tabModel = tabModel;\n        var count = 0;\n        var index = 0;\n        if (length > 0) {\n            for (var i = 0; i < length; i++) {\n                var dialogField = dialogSettings[i];\n                var tabItem = {};\n                if (dialogField.type === 'General') {\n                    if (Object.keys(ganttObj.columnMapping).length === 0) {\n                        continue;\n                    }\n                    if (isNullOrUndefined(dialogField.headerText)) {\n                        dialogField.headerText = this.localeObj.getConstant('generalTab');\n                    }\n                    tabItem.content = 'General';\n                    this.beforeOpenArgs[tabItem.content] = this.getFieldsModel(dialogField.fields);\n                }\n                else if (dialogField.type === 'Segments') {\n                    if (isNullOrUndefined(tasks.segments)) {\n                        continue;\n                    }\n                    if (isNullOrUndefined(dialogField.headerText)) {\n                        dialogField.headerText = this.localeObj.getConstant('segments');\n                    }\n                    tabItem.content = 'Segments';\n                    this.beforeOpenArgs[tabItem.content] = this.getSegmentsModel(dialogField.fields);\n                }\n                else if (dialogField.type === 'Dependency') {\n                    if (isNullOrUndefined(tasks.dependency)) {\n                        continue;\n                    }\n                    if (isNullOrUndefined(dialogField.headerText)) {\n                        dialogField.headerText = this.localeObj.getConstant('dependency');\n                    }\n                    tabItem.content = 'Dependency';\n                    this.beforeOpenArgs[tabItem.content] = this.getPredecessorModel(dialogField.fields);\n                }\n                else if (dialogField.type === 'Resources') {\n                    if (isNullOrUndefined(tasks.resourceInfo)) {\n                        continue;\n                    }\n                    if (isNullOrUndefined(dialogField.headerText)) {\n                        dialogField.headerText = this.localeObj.getConstant('resourceName');\n                    }\n                    tabItem.content = 'Resources';\n                    this.beforeOpenArgs[tabItem.content] = this.getResourcesModel(dialogField.fields);\n                }\n                else if (dialogField.type === 'Notes') {\n                    if (isNullOrUndefined(tasks.notes)) {\n                        continue;\n                    }\n                    if (isNullOrUndefined(dialogField.headerText)) {\n                        dialogField.headerText = this.localeObj.getConstant('notes');\n                    }\n                    tabItem.content = 'Notes';\n                    this.beforeOpenArgs[tabItem.content] = this.getNotesModel(dialogField.fields);\n                }\n                else {\n                    if (isNullOrUndefined(dialogField.fields) || dialogField.fields.length === 0) {\n                        continue;\n                    }\n                    if (isNullOrUndefined(dialogField.headerText)) {\n                        dialogField.headerText = this.localeObj.getConstant('customTab'); // eslint-disable-next-line\n                        count++;\n                    }\n                    tabItem.content = 'Custom' + '' + index++;\n                    this.beforeOpenArgs[tabItem.content] = this.getFieldsModel(dialogField.fields);\n                }\n                tabItem.header = { text: dialogField.headerText };\n                tabItems.push(tabItem);\n            }\n        }\n        this.beforeOpenArgs.requestType = this.isEdit ? 'beforeOpenEditDialog' : 'beforeOpenAddDialog';\n        var args = {\n            rowData: this.beforeOpenArgs.rowData,\n            name: this.beforeOpenArgs.name,\n            requestType: this.beforeOpenArgs.requestType,\n            cancel: this.beforeOpenArgs.cancel\n        };\n        this.parent.trigger('actionBegin', this.beforeOpenArgs, function (arg) {\n            _this.renderTabItems();\n            if (!arg.cancel) {\n                tabModel.selected = _this.tabSelectedEvent.bind(_this);\n                tabModel.height = _this.parent.isAdaptive ? '100%' : 'auto';\n                tabModel.overflowMode = 'Scrollable';\n                _this.tabObj = new Tab(tabModel);\n                _this.tabObj.isStringTemplate = true;\n                tabElement = _this.parent.createElement('div', { id: ganttObj.element.id + '_Tab' });\n                _this.tabObj.appendTo(tabElement);\n                dialogModel.content = tabElement;\n                _this.dialog = dialog;\n                _this.dialogObj = new Dialog(dialogModel);\n                _this.dialogObj.isStringTemplate = true;\n                _this.dialogObj.appendTo(_this.dialog);\n                var actionCompleteArgs = {\n                    action: 'OpenDialog',\n                    requestType: _this.isEdit ? 'openEditDialog' : 'openAddDialog',\n                    data: _this.beforeOpenArgs.rowData,\n                    element: _this.dialog,\n                    cancel: false\n                };\n                _this.parent.trigger('actionComplete', actionCompleteArgs, function (actionCompleteArg) {\n                    if (actionCompleteArg.cancel) {\n                        _this.resetValues();\n                    }\n                });\n            }\n        });\n    };\n    DialogEdit.prototype.tabSelectedEvent = function (args) {\n        var ganttObj = this.parent;\n        var id = args.selectedContent.childNodes[0].id;\n        if (this.parent.isAdaptive) {\n            this.responsiveTabContent(id, ganttObj);\n        }\n        if (id === ganttObj.element.id + 'ResourcesTabContainer') {\n            this.resourceSelection(id);\n        }\n        else if (id === ganttObj.element.id + 'NotesTabContainer') {\n            document.getElementById(id).ej2_instances[0].refresh();\n        }\n        else if (id === ganttObj.element.id + 'SegmentsTabContainer') {\n            if (isNullOrUndefined(this.beforeOpenArgs.rowData.ganttProperties.startDate)) {\n                document.getElementById(id).ej2_instances[0]\n                    .enableToolbarItems([this.parent.element.id + 'SegmentsTabContainer' + '_add'], false);\n            }\n            else {\n                document.getElementById(id).ej2_instances[0]\n                    .enableToolbarItems([this.parent.element.id + 'SegmentsTabContainer' + '_add'], true);\n            }\n        }\n    };\n    DialogEdit.prototype.responsiveTabContent = function (id, ganttObj) {\n        var dialogContent = document.getElementById(ganttObj.element.id + '_dialog_dialog-content');\n        var dialogContentHeight = dialogContent.clientHeight;\n        dialogContentHeight -= dialogContent.querySelector('.e-tab-header').offsetHeight;\n        var grid = document.querySelector('#' + id);\n        if (grid.classList.contains('e-grid')) {\n            dialogContentHeight -= grid.ej2_instances[0].getHeaderContent().offsetHeight;\n            var toolbar_1 = grid.querySelector('.e-toolbar');\n            if (toolbar_1) {\n                dialogContentHeight -= toolbar_1.offsetHeight;\n            }\n        }\n        grid.parentElement.style.height = dialogContentHeight + 'px';\n    };\n    DialogEdit.prototype.getFieldsModel = function (fields) {\n        var fieldsModel = {};\n        var columnByField = this.parent.columnByField;\n        for (var i = 0; i < fields.length; i++) {\n            if (fields[i] === this.parent.taskFields.dependency ||\n                fields[i] === this.parent.taskFields.resourceInfo ||\n                fields[i] === this.parent.taskFields.notes) {\n                continue;\n            }\n            if (!isNullOrUndefined(columnByField[fields[i]])) {\n                var fieldName = fields[i];\n                this.createInputModel(columnByField[fieldName], fieldsModel);\n            }\n        }\n        return fieldsModel;\n    };\n    DialogEdit.prototype.createInputModel = function (column, fieldsModel) {\n        var _this = this;\n        var ganttObj = this.parent;\n        var locale = this.parent.locale;\n        var taskSettings = this.parent.taskFields;\n        var common = {\n            placeholder: column.headerText,\n            floatLabelType: 'Auto'\n        };\n        switch (column.editType) {\n            case 'booleanedit':\n                {\n                    var checkboxModel = {\n                        label: column.headerText,\n                        locale: locale\n                    };\n                    fieldsModel[column.field] = checkboxModel;\n                    break;\n                }\n            case 'stringedit':\n                {\n                    var textBox = common;\n                    if (column.field === ganttObj.columnMapping.duration || column.field === ganttObj.columnMapping.startDate ||\n                        column.field === ganttObj.columnMapping.endDate) {\n                        textBox.change = function (args) {\n                            _this.validateScheduleFields(args, column, ganttObj);\n                        };\n                    }\n                    fieldsModel[column.field] = common;\n                    break;\n                }\n            case 'numericedit':\n                {\n                    var numeric = common;\n                    if (taskSettings.progress === column.field) {\n                        numeric.min = 0;\n                        numeric.max = 100;\n                    }\n                    if (taskSettings.work === column.field) {\n                        numeric.change = function (args) {\n                            _this.validateScheduleFields(args, column, ganttObj);\n                        };\n                    }\n                    fieldsModel[column.field] = numeric;\n                    break;\n                }\n            case 'datepickeredit':\n                {\n                    var datePickerObj = common;\n                    datePickerObj.format = this.parent.getDateFormat();\n                    datePickerObj.strictMode = true;\n                    datePickerObj.firstDayOfWeek = ganttObj.timelineModule.customTimelineSettings.weekStartDay;\n                    if (column.field === ganttObj.columnMapping.startDate ||\n                        column.field === ganttObj.columnMapping.endDate) {\n                        datePickerObj.renderDayCell = this.parent.renderWorkingDayCell.bind(this.parent);\n                        datePickerObj.change = function (args) {\n                            _this.validateScheduleFields(args, column, ganttObj);\n                        };\n                    }\n                    fieldsModel[column.field] = datePickerObj;\n                    break;\n                }\n            case 'datetimepickeredit':\n                {\n                    var dateTimePickerObj = common;\n                    dateTimePickerObj.format = this.parent.getDateFormat();\n                    dateTimePickerObj.strictMode = true;\n                    dateTimePickerObj.firstDayOfWeek = ganttObj.timelineModule.customTimelineSettings.weekStartDay;\n                    if (column.field === ganttObj.columnMapping.startDate ||\n                        column.field === ganttObj.columnMapping.endDate) {\n                        dateTimePickerObj.renderDayCell = this.parent.renderWorkingDayCell.bind(this.parent);\n                        dateTimePickerObj.change = function (args) {\n                            _this.validateScheduleFields(args, column, ganttObj);\n                        };\n                    }\n                    fieldsModel[column.field] = dateTimePickerObj;\n                    break;\n                }\n            case 'dropdownedit':\n                if (column.field === 'taskType' || column.field === ganttObj.columnMapping.manual) {\n                    var dataKey = 'dataSource';\n                    var fieldsKey = 'fields';\n                    var types = [\n                        { 'ID': 1, 'Value': 'FixedUnit' }, { 'ID': 2, 'Value': 'FixedWork' }, { 'ID': 3, 'Value': 'FixedDuration' }\n                    ];\n                    common[dataKey] = types;\n                    common[fieldsKey] = { value: 'Value' };\n                    var dropDownListObj = common;\n                    dropDownListObj.change = function (args) {\n                        if (column.field === taskSettings.manual) {\n                            _this.editedRecord.ganttProperties.isAutoSchedule = !args.value;\n                        }\n                        _this.validateScheduleFields(args, column, ganttObj);\n                    };\n                }\n                fieldsModel[column.field] = common;\n                break;\n            case 'maskededit':\n                fieldsModel[column.field] = common;\n                break;\n        }\n        if (!isNullOrUndefined(column.edit) && !isNullOrUndefined(column.edit.params)) {\n            extend(fieldsModel[column.field], column.edit.params);\n        }\n        return fieldsModel;\n    };\n    DialogEdit.prototype.validateScheduleFields = function (args, column, ganttObj) {\n        var dialog = ganttObj.editModule.dialogModule.dialog;\n        var targetId = null;\n        var inputElement;\n        var currentData = ganttObj.editModule.dialogModule.editedRecord;\n        var cellValue = null;\n        var colName = null;\n        if (!isNullOrUndefined(args.element)) {\n            inputElement = args.element;\n            targetId = inputElement.getAttribute('id');\n        }\n        else if (!isNullOrUndefined(args.container)) {\n            inputElement = args.container;\n            targetId = inputElement.querySelector('input').getAttribute('id');\n            inputElement = inputElement.querySelector('#' + targetId);\n        }\n        else if (!isNullOrUndefined(args.event) && !isNullOrUndefined(args.event.path[1])) {\n            inputElement = args.event.path[1];\n            targetId = inputElement.querySelector('input').getAttribute('id');\n            inputElement = inputElement.querySelector('#' + targetId);\n        }\n        if (isNullOrUndefined(inputElement)) {\n            cellValue = args.value;\n            colName = column.field;\n        }\n        else {\n            cellValue = inputElement.value;\n            colName = targetId.replace(ganttObj.element.id, '');\n        }\n        if (colName.search('Segments') === 0) {\n            colName = colName.replace('SegmentsTabContainer', '');\n            this.validateSegmentFields(ganttObj, colName, cellValue, args);\n            return true;\n        }\n        else {\n            this.validateScheduleValuesByCurrentField(colName, cellValue, this.editedRecord);\n            var ganttProp = currentData.ganttProperties;\n            var tasks = ganttObj.taskFields;\n            if (!isNullOrUndefined(tasks.startDate) && tasks.startDate !== colName) {\n                this.updateScheduleFields(dialog, ganttProp, 'startDate');\n            }\n            if (!isNullOrUndefined(tasks.endDate) && tasks.endDate !== colName) {\n                this.updateScheduleFields(dialog, ganttProp, 'endDate');\n            }\n            if (!isNullOrUndefined(tasks.duration) && tasks.duration !== colName) {\n                this.updateScheduleFields(dialog, ganttProp, 'duration');\n            }\n            if (!isNullOrUndefined(tasks.work) && tasks.work !== colName) {\n                this.updateScheduleFields(dialog, ganttProp, 'work');\n            }\n            this.dialogEditValidationFlag = false;\n            return true;\n        }\n    };\n    DialogEdit.prototype.updateScheduleFields = function (dialog, ganttProp, ganttField) {\n        var ganttObj = this.parent;\n        var ganttId = ganttObj.element.id;\n        var columnName = getValue(ganttField, ganttObj.columnMapping);\n        var col = ganttObj.columnByField[columnName];\n        var tempValue;\n        var taskField = this.parent.taskFields;\n        if (col.editType === 'stringedit') {\n            var textBox = dialog.querySelector('#' + ganttId + columnName).ej2_instances[0];\n            tempValue = !isNullOrUndefined(col.edit) && !isNullOrUndefined(col.edit.read) ? col.edit.read() :\n                !isNullOrUndefined(col.valueAccessor) ? col.valueAccessor(columnName, ganttObj.editModule.dialogModule.editedRecord, col) : // eslint-disable-line\n                    this.parent.dataOperation.getDurationString(ganttProp.duration, ganttProp.durationUnit);\n            if (textBox.value !== tempValue.toString() && taskField.duration === columnName) {\n                textBox.value = tempValue;\n                textBox.dataBind();\n            }\n            else if (taskField.startDate === columnName || taskField.endDate === columnName) {\n                textBox.value = taskField.startDate === columnName ? ganttProp.startDate.toString() : ganttProp.endDate.toString();\n                textBox.dataBind();\n            }\n        }\n        else if (col.editType === 'datepickeredit' || col.editType === 'datetimepickeredit') {\n            var picker = col.editType === 'datepickeredit' ?\n                dialog.querySelector('#' + ganttId + columnName).ej2_instances[0] :\n                dialog.querySelector('#' + ganttId + columnName).ej2_instances[0];\n            tempValue = ganttProp[ganttField];\n            if (((isNullOrUndefined(picker.value)) && !isNullOrUndefined(tempValue)) ||\n                (isNullOrUndefined(tempValue) && !isNullOrUndefined(picker.value)) ||\n                (picker.value !== tempValue && !isNullOrUndefined(picker.value) && !isNullOrUndefined(tempValue)\n                    && picker.value.toString() !== tempValue.toString())) {\n                picker.value = tempValue;\n                picker.dataBind();\n            }\n        }\n        else if (col.editType === 'numericedit') {\n            var numericTextBox = dialog.querySelector('#' + ganttId + columnName).ej2_instances[0];\n            tempValue = ganttProp[ganttField];\n            if (!isNullOrUndefined(tempValue) && numericTextBox.value !== tempValue) {\n                numericTextBox.value = tempValue;\n                numericTextBox.dataBind();\n            }\n        }\n    };\n    /**\n     * @param {IGanttData} ganttData .\n     * @returns {void} .\n     * @private\n     */\n    DialogEdit.prototype.validateDuration = function (ganttData) {\n        var ganttProp = ganttData.ganttProperties;\n        if (!this.dialogEditValidationFlag) {\n            if (isNullOrUndefined(ganttProp.duration)) {\n                this.parent.setRecordValue('endDate', null, ganttProp, true);\n                this.parent.setRecordValue('isMilestone', false, ganttProp, true);\n            }\n            else if (isScheduledTask(ganttProp) || !isNullOrUndefined(ganttProp.startDate)) {\n                if (ganttData.ganttProperties.isMilestone && ganttData.ganttProperties.duration !== 0) {\n                    this.parent.dateValidationModule.calculateStartDate(ganttData);\n                }\n                this.parent.dateValidationModule.calculateEndDate(ganttData);\n            }\n            else if (!isScheduledTask(ganttProp) && !isNullOrUndefined(ganttProp.endDate)) {\n                this.parent.dateValidationModule.calculateStartDate(ganttData);\n            }\n            var milestone = ganttProp.duration === 0 ? true : false;\n            this.parent.setRecordValue('isMilestone', milestone, ganttProp, true);\n            this.dialogEditValidationFlag = true;\n        }\n    };\n    DialogEdit.prototype.validateStartDate = function (ganttData) {\n        var ganttProp = ganttData.ganttProperties;\n        var tasks = this.parent.taskFields;\n        if (!this.dialogEditValidationFlag) {\n            if (isNullOrUndefined(ganttProp.startDate)) {\n                this.parent.setRecordValue('duration', null, ganttProp, true);\n                this.parent.setRecordValue('isMilestone', false, ganttProp, true);\n                if (this.parent.allowUnscheduledTasks && isNullOrUndefined(tasks.endDate)) {\n                    this.parent.setRecordValue('endDate', null, ganttProp, true);\n                }\n            }\n            else if (isScheduledTask(ganttProp)) {\n                if (isNullOrUndefined(tasks.duration)) {\n                    this.parent.dateValidationModule.calculateDuration(ganttData);\n                }\n                else if (isNullOrUndefined(tasks.endDate)) {\n                    this.parent.dateValidationModule.calculateEndDate(ganttData);\n                }\n                else {\n                    this.parent.dateValidationModule.calculateEndDate(ganttData);\n                }\n            }\n            else {\n                if (!isNullOrUndefined(ganttProp.endDate)) {\n                    this.parent.dateValidationModule.calculateDuration(ganttData);\n                }\n                else if (!isNullOrUndefined(ganttProp.duration)) {\n                    this.parent.dateValidationModule.calculateEndDate(ganttData);\n                }\n            }\n            this.dialogEditValidationFlag = true;\n        }\n    };\n    DialogEdit.prototype.validateEndDate = function (ganttData) {\n        var ganttProp = ganttData.ganttProperties;\n        var tasks = this.parent.taskFields;\n        if (!this.dialogEditValidationFlag) {\n            if (isNullOrUndefined(ganttProp.endDate)) {\n                this.parent.setRecordValue('duration', null, ganttProp, true);\n                this.parent.setRecordValue('isMilestone', false, ganttProp, true);\n            }\n            else if (isScheduledTask(ganttProp)) {\n                if (isNullOrUndefined(tasks.duration)) {\n                    this.parent.dateValidationModule.calculateDuration(ganttData);\n                }\n                else if (isNullOrUndefined(ganttProp.startDate)) {\n                    this.parent.dateValidationModule.calculateStartDate(ganttData);\n                }\n                else {\n                    if (!isNullOrUndefined(ganttProp.segments) && ganttProp.segments.length > 0) {\n                        ganttProp.segments = this.parent.editModule.cellEditModule.validateEndDateWithSegments(ganttProp);\n                    }\n                    this.parent.dateValidationModule.calculateDuration(ganttData);\n                }\n            }\n            else {\n                if (!isNullOrUndefined(ganttProp.duration)) {\n                    this.parent.dateValidationModule.calculateStartDate(ganttData);\n                }\n                else if (!isNullOrUndefined(ganttProp.startDate)) {\n                    this.parent.dateValidationModule.calculateDuration(ganttData);\n                }\n            }\n            this.dialogEditValidationFlag = true;\n        }\n    };\n    /**\n     *\n     * @param {string} columnName .\n     * @param {string} value .\n     * @param {IGanttData} currentData .\n     * @returns {boolean} .\n     * @private\n     */\n    DialogEdit.prototype.validateScheduleValuesByCurrentField = function (columnName, value, currentData) {\n        var ganttObj = this.parent;\n        var ganttProp = currentData.ganttProperties;\n        var taskSettings = ganttObj.taskFields;\n        if (taskSettings.duration === columnName) {\n            if (!isNullOrUndefined(value) && value !== '') {\n                ganttObj.dataOperation.updateDurationValue(value, ganttProp);\n            }\n            else {\n                if (ganttObj.allowUnscheduledTasks) {\n                    this.parent.setRecordValue('duration', null, ganttProp, true);\n                }\n            }\n            this.validateDuration(currentData);\n            this.parent.editModule.updateResourceRelatedFields(currentData, 'duration');\n        }\n        if (taskSettings.startDate === columnName) {\n            if (value !== '') {\n                var startDate = this.parent.dateValidationModule.getDateFromFormat(value);\n                startDate = this.parent.dateValidationModule.checkStartDate(startDate, ganttProp);\n                this.parent.setRecordValue('startDate', startDate, ganttProp, true);\n            }\n            else {\n                if (ganttObj.allowUnscheduledTasks && !(currentData.hasChildRecords)) {\n                    this.parent.setRecordValue('startDate', null, ganttProp, true);\n                }\n            }\n            this.validateStartDate(currentData);\n        }\n        if (taskSettings.endDate === columnName) {\n            if (value !== '') {\n                var endDate = this.parent.dateValidationModule.getDateFromFormat(value);\n                if (endDate.getHours() === 0 && ganttObj.defaultEndTime !== 86400) {\n                    this.parent.dateValidationModule.setTime(ganttObj.defaultEndTime, endDate);\n                }\n                endDate = this.parent.dateValidationModule.checkEndDate(endDate, ganttProp);\n                if (isNullOrUndefined(ganttProp.startDate) || endDate.getTime() > (ganttProp.startDate).getTime()) {\n                    this.parent.setRecordValue('endDate', endDate, ganttProp, true);\n                }\n            }\n            else {\n                if (ganttObj.allowUnscheduledTasks) {\n                    this.parent.setRecordValue('endDate', null, ganttProp, true);\n                }\n            }\n            this.validateEndDate(currentData);\n        }\n        if (taskSettings.work === columnName) {\n            if (!isNullOrUndefined(value) && value !== '') {\n                this.parent.setRecordValue('work', value, ganttProp, true);\n                this.parent.editModule.updateResourceRelatedFields(currentData, 'work');\n                this.validateDuration(currentData);\n            }\n        }\n        if (columnName === 'taskType') {\n            this.parent.setRecordValue('taskType', value, ganttProp, true);\n        }\n        if (taskSettings.manual === columnName) {\n            this.parent.editModule.updateTaskScheduleModes(currentData);\n        }\n        return true;\n    };\n    DialogEdit.prototype.getSegmentsModel = function (fields) {\n        var _this = this;\n        var taskSettings = this.parent.taskFields;\n        if (isNullOrUndefined(fields) || fields.length === 0) {\n            fields = [];\n            if (!isNullOrUndefined(taskSettings.startDate)) {\n                fields.push('startDate');\n            }\n            if (!isNullOrUndefined(taskSettings.endDate)) {\n                fields.push('endDate');\n            }\n            if (!isNullOrUndefined(taskSettings.duration)) {\n                fields.push('duration');\n            }\n        }\n        var segmentInputModel = {};\n        segmentInputModel.editSettings = {\n            allowEditing: true, allowAdding: true, allowDeleting: true, mode: 'Normal', newRowPosition: 'Bottom'\n        };\n        segmentInputModel.locale = this.parent.locale;\n        segmentInputModel.dataSource = [];\n        segmentInputModel.rowHeight = this.parent.isAdaptive ? 48 : null;\n        segmentInputModel.toolbar = [\n            {\n                id: this.parent.element.id + 'SegmentsTabContainer' + '_add', prefixIcon: 'e-add',\n                tooltipText: this.localeObj.getConstant('add'), align: 'Right',\n                text: this.parent.isAdaptive ? '' : this.localeObj.getConstant('add')\n            },\n            {\n                id: this.parent.element.id + 'SegmentsTabContainer' + '_delete', prefixIcon: 'e-delete',\n                tooltipText: this.localeObj.getConstant('delete'), align: 'Right',\n                text: this.parent.isAdaptive ? '' : this.localeObj.getConstant('delete')\n            }\n        ];\n        var gridColumns = [];\n        var _loop_1 = function (i) {\n            var gridColumn = {};\n            var generalTabString = 'General';\n            switch (fields[i]) {\n                case 'startDate':\n                case 'endDate':\n                    gridColumn = {\n                        field: fields[i], headerText: this_1.localeObj.getConstant(fields[i]), editType: 'stringedit', width: '200px',\n                        edit: {\n                            write: function (args) {\n                                var datePickerModel = _this.beforeOpenArgs[generalTabString][_this.parent.taskFields[fields[i]]];\n                                var value = args.rowData[args.column.field];\n                                setValue('value', value, datePickerModel);\n                                var datePicker = new DatePicker(datePickerModel);\n                                datePicker.appendTo(args.element);\n                            },\n                            read: function (args) {\n                                var ej2Instance = args.ej2_instances[0];\n                                return ej2Instance.value;\n                            }\n                        },\n                        format: this_1.parent.getDateFormat()\n                    };\n                    if (fields[i] === 'startDate') {\n                        gridColumn.validationRules = { required: true };\n                    }\n                    gridColumns.push(gridColumn);\n                    break;\n                case 'duration':\n                    gridColumn = {\n                        field: fields[i], headerText: this_1.localeObj.getConstant(fields[i]), editType: 'stringedit', width: '100px',\n                        edit: {\n                            write: function (args) {\n                                var inputTextModel = _this.beforeOpenArgs[generalTabString][_this.parent.taskFields[fields[i]]];\n                                inputTextModel.floatLabelType = 'Never';\n                                var value = args.rowData[args.column.field];\n                                if (!isNullOrUndefined(value)) {\n                                    setValue('value', value, inputTextModel);\n                                }\n                                else {\n                                    setValue('value', null, inputTextModel);\n                                }\n                                setValue('value', value, inputTextModel);\n                                var inputModel = new TextBox(inputTextModel);\n                                inputModel.appendTo(args.element);\n                            },\n                            read: function (args) {\n                                var ej2Instance = args.ej2_instances[0];\n                                return ej2Instance.value.toString();\n                            }\n                        }\n                    };\n                    gridColumns.push(gridColumn);\n                    break;\n            }\n        };\n        var this_1 = this;\n        for (var i = 0; i < fields.length; i++) {\n            _loop_1(i);\n        }\n        segmentInputModel.columns = gridColumns;\n        segmentInputModel.height = this.parent.isAdaptive ? '100%' : '153px';\n        return segmentInputModel;\n    };\n    DialogEdit.prototype.getGridColumnByField = function (fieldName, columns) {\n        var column;\n        for (var i = 0; i < columns.length; i++) {\n            if (columns[i].field === fieldName) {\n                column = columns[i];\n            }\n        }\n        return column;\n    };\n    DialogEdit.prototype.updateSegmentField = function (columnName, args, segment) {\n        var dialog = this.parent.editModule.dialogModule.dialog;\n        var gridModel = getValue('Segments', this.beforeOpenArgs);\n        var col = this.getGridColumnByField(columnName, gridModel.columns);\n        var ganttId = this.parent.element.id;\n        var tempValue = segment[columnName];\n        var inputValue;\n        if (col.editType === 'stringedit') {\n            inputValue = dialog.querySelector('#' + ganttId + 'SegmentsTabContainer' + columnName)\n                .ej2_instances[0];\n        }\n        else if (col.editType === 'datepickeredit') {\n            inputValue = dialog.querySelector('#' + ganttId + 'SegmentsTabContainer' + columnName)\n                .ej2_instances[0];\n        }\n        if (inputValue.value !== tempValue.toString()) {\n            inputValue.value = tempValue;\n            inputValue.dataBind();\n        }\n    };\n    DialogEdit.prototype.validateSegmentFields = function (ganttObj, columnName, cellValue, args) {\n        var taskSettings = this.parent.taskFields;\n        if (!isNullOrUndefined(taskSettings.duration) && taskSettings.duration.toLowerCase() === columnName.toLowerCase()) {\n            if (!isNullOrUndefined(cellValue) && cellValue !== '') {\n                this.selectedSegment.duration = Number(cellValue);\n                var endDate = ganttObj.dataOperation.getEndDate(this.selectedSegment.startDate, Number(cellValue), this.editedRecord.ganttProperties.durationUnit, this.editedRecord.ganttProperties, false);\n                endDate = ganttObj.dataOperation.checkEndDate(endDate, this.editedRecord.ganttProperties, false);\n                this.selectedSegment.endDate = endDate;\n            }\n        }\n        if (!isNullOrUndefined(taskSettings.startDate) && taskSettings.startDate.toLowerCase() === columnName.toLowerCase()) {\n            if (cellValue !== '') {\n                var startDate = this.parent.dateValidationModule.getDateFromFormat(cellValue);\n                startDate = this.parent.dateValidationModule.checkStartDate(startDate);\n                this.selectedSegment.startDate = startDate;\n                if (!isNullOrUndefined(taskSettings.endDate)) {\n                    this.selectedSegment.endDate = this.parent.dataOperation.getEndDate(startDate, this.selectedSegment.duration, this.editedRecord.ganttProperties.durationUnit, this.editedRecord.ganttProperties, false);\n                }\n            }\n        }\n        if (!isNullOrUndefined(taskSettings.endDate) && taskSettings.endDate.toLowerCase() === columnName.toLowerCase()) {\n            if (cellValue !== '') {\n                var endDate = this.parent.dateValidationModule.getDateFromFormat(cellValue);\n                if (endDate.getHours() === 0 && ganttObj.defaultEndTime !== 86400) {\n                    this.parent.dateValidationModule.setTime(ganttObj.defaultEndTime, endDate);\n                }\n                endDate = this.parent.dateValidationModule.checkEndDate(endDate, this.editedRecord.ganttProperties);\n                this.selectedSegment.endDate = endDate;\n                this.selectedSegment.duration = this.parent.dataOperation.getDuration(this.selectedSegment.startDate, this.selectedSegment.endDate, this.editedRecord.ganttProperties.durationUnit, true, false, true);\n            }\n        }\n        if (!isNullOrUndefined(taskSettings.startDate)) {\n            this.updateSegmentField('startDate', args, this.selectedSegment);\n        }\n        if (!isNullOrUndefined(taskSettings.endDate)) {\n            this.updateSegmentField('endDate', args, this.selectedSegment);\n        }\n        if (!isNullOrUndefined(taskSettings.duration)) {\n            this.updateSegmentField('duration', args, this.selectedSegment);\n        }\n    };\n    DialogEdit.prototype.getPredecessorModel = function (fields) {\n        if (isNullOrUndefined(fields) || fields.length === 0) {\n            fields = ['ID', 'Name', 'Type', 'Offset', 'UniqueId'];\n        }\n        var inputModel = {};\n        inputModel.editSettings = { allowEditing: true, allowAdding: true, allowDeleting: true, mode: 'Normal' };\n        inputModel.locale = this.parent.locale;\n        inputModel.dataSource = [];\n        inputModel.rowHeight = this.parent.isAdaptive ? 48 : null;\n        inputModel.toolbar = [\n            {\n                id: this.parent.element.id + 'DependencyTabContainer' + '_add', prefixIcon: 'e-add',\n                tooltipText: this.localeObj.getConstant('add'), align: 'Right',\n                text: this.parent.isAdaptive ? '' : this.localeObj.getConstant('add')\n            },\n            {\n                id: this.parent.element.id + 'DependencyTabContainer' + '_delete', prefixIcon: 'e-delete',\n                tooltipText: this.localeObj.getConstant('delete'), align: 'Right',\n                text: this.parent.isAdaptive ? '' : this.localeObj.getConstant('delete')\n            }\n        ];\n        var columns = [];\n        for (var i = 0; i < fields.length; i++) {\n            var column = {};\n            if (fields[i].toLowerCase() === 'id') {\n                column = {\n                    field: 'id', headerText: this.localeObj.getConstant('id'), allowEditing: false, width: '70px'\n                };\n                columns.push(column);\n            }\n            else if (fields[i].toLowerCase() === 'name') {\n                column = {\n                    field: 'name', headerText: this.localeObj.getConstant('name'), editType: 'stringedit', width: '250px',\n                    validationRules: { required: true }\n                };\n                columns.push(column);\n            }\n            else if (fields[i].toLowerCase() === 'type') {\n                column = {\n                    field: 'type', headerText: this.localeObj.getConstant('type'), editType: 'dropdownedit',\n                    dataSource: this.types, foreignKeyField: 'id', foreignKeyValue: 'text',\n                    defaultValue: 'FS', validationRules: { required: true }, width: '150px'\n                };\n                columns.push(column);\n            }\n            else if (fields[i].toLowerCase() === 'offset') {\n                column = {\n                    field: 'offset', headerText: this.localeObj.getConstant('offset'), editType: 'stringedit',\n                    defaultValue: this.parent.dataOperation.getDurationString(0, this.beforeOpenArgs.rowData.ganttProperties.durationUnit),\n                    validationRules: { required: true }, width: '100px'\n                };\n                columns.push(column);\n            }\n            else if (fields[i].toLowerCase() === 'uniqueid') {\n                column = {\n                    field: 'uniqueId', isPrimaryKey: true, visible: false, defaultValue: getUid().toString()\n                };\n                columns.push(column);\n            }\n        }\n        inputModel.columns = columns;\n        inputModel.height = this.parent.isAdaptive ? '100%' : '153px';\n        return inputModel;\n    };\n    DialogEdit.prototype.getResourcesModel = function (fields) {\n        var ganttObj = this.parent;\n        var resourceSettings = ganttObj.resourceFields;\n        if (isNullOrUndefined(fields) || fields.length === 0) {\n            fields = [resourceSettings.id, resourceSettings.name, resourceSettings.unit, resourceSettings.group];\n        }\n        var inputModel = {\n            allowFiltering: true,\n            treeColumnIndex: -1,\n            childMapping: '',\n            editSettings: { allowEditing: true, mode: 'Cell' },\n            locale: this.parent.locale,\n            allowSelection: true,\n            rowHeight: this.parent.isAdaptive ? 48 : null,\n            filterSettings: { type: 'Menu' },\n            selectionSettings: { checkboxOnly: true, checkboxMode: 'Default', persistSelection: true, type: 'Multiple' }\n        };\n        var columns = [\n            { type: 'checkbox', allowEditing: false, allowSorting: false, allowFiltering: false, width: 60 }\n        ];\n        for (var i = 0; i < fields.length; i++) {\n            var column = {};\n            if (fields[i] === resourceSettings.id) {\n                column = {\n                    field: resourceSettings.id,\n                    headerText: this.localeObj.getConstant('id'), isPrimaryKey: true, width: '100px',\n                    allowEditing: false\n                };\n                columns.push(column);\n            }\n            else if (fields[i] === resourceSettings.name) {\n                column = {\n                    field: resourceSettings.name, headerText: this.localeObj.getConstant('name'),\n                    allowEditing: false\n                };\n                columns.push(column);\n            }\n            else if (fields[i] === resourceSettings.unit) {\n                column = {\n                    field: resourceSettings.unit,\n                    headerText: this.localeObj.getConstant('unit'),\n                    editType: 'numericedit',\n                    edit: { params: { min: 0 } }\n                };\n                columns.push(column);\n            }\n            else if (fields[i] === resourceSettings.group && !isNullOrUndefined(resourceSettings.group)) {\n                column = {\n                    field: resourceSettings.group,\n                    headerText: this.localeObj.getConstant('group'),\n                    allowEditing: false\n                };\n                columns.push(column);\n            }\n        }\n        inputModel.columns = columns;\n        inputModel.height = this.parent.isAdaptive ? '100%' : '196px';\n        return inputModel;\n    };\n    DialogEdit.prototype.getNotesModel = function (fields) {\n        if (isNullOrUndefined(fields) || fields.length === 0) {\n            fields = ['Bold', 'Italic', 'Underline', 'StrikeThrough',\n                'FontName', 'FontSize', 'FontColor', 'BackgroundColor',\n                'LowerCase', 'UpperCase', '|',\n                'Alignments', 'OrderedList', 'UnorderedList',\n                'Outdent', 'Indent', '|', 'CreateTable',\n                'CreateLink', '|', 'ClearFormat', 'Print',\n                '|', 'Undo', 'Redo'];\n        }\n        var inputModel = {\n            placeholder: this.localeObj.getConstant('writeNotes'),\n            toolbarSettings: {\n                items: fields\n            },\n            height: this.parent.isAdaptive ? '100%' : 'auto',\n            locale: this.parent.locale\n        };\n        return inputModel;\n    };\n    DialogEdit.prototype.createDivElement = function (className, id) {\n        return createElement('div', { className: className, id: id });\n    };\n    DialogEdit.prototype.createInputElement = function (className, id, fieldName, type) {\n        return createElement(type || 'input', {\n            className: className, attrs: {\n                type: 'text', id: id, name: fieldName,\n                title: fieldName\n            }\n        });\n    };\n    DialogEdit.prototype.renderTabItems = function () {\n        var tabModel = this.beforeOpenArgs.tabModel;\n        var items = tabModel.items;\n        var index = 0;\n        for (var i = 0; i < items.length; i++) {\n            var item = items[i];\n            if (item.content instanceof HTMLElement) {\n                continue;\n            }\n            else if (item.content === 'General') {\n                item.content = this.renderGeneralTab(item.content);\n            }\n            else if (item.content === 'Dependency') {\n                if (this.editedRecord.hasChildRecords) {\n                    item.disabled = true;\n                }\n                item.content = this.renderPredecessorTab(item.content);\n            }\n            else if (item.content === 'Resources') {\n                item.content = this.renderResourceTab(item.content);\n            }\n            else if (item.content === ('Custom' + '' + index)) {\n                item.content = this.renderCustomTab(item.content);\n                index++;\n            }\n            else if (item.content === 'Notes') {\n                item.content = this.renderNotesTab(item.content);\n            }\n            else if (item.content === 'Segments') {\n                if (this.editedRecord.hasChildRecords) {\n                    item.disabled = true;\n                }\n                item.content = this.renderSegmentsTab(item.content);\n            }\n        }\n    };\n    DialogEdit.prototype.segmentGridActionBegin = function (args) {\n        var taskFields = this.parent.taskFields;\n        var itemName = 'Segments';\n        var gridModel = this.beforeOpenArgs[itemName];\n        if (args.requestType === 'add' || args.requestType === 'beginEdit' || args.requestType === 'save') {\n            var gridData = gridModel.dataSource;\n            var selectedItem = getValue('rowData', args);\n            var startDate = this.beforeOpenArgs.rowData.ganttProperties.startDate;\n            if (!isNullOrUndefined(startDate)) {\n                if (args.requestType === 'add') {\n                    var arg = {};\n                    var sDate = getValue('startDate', selectedItem);\n                    var eDate = getValue('endDate', selectedItem);\n                    var duration = getValue('duration', selectedItem);\n                    var startDate_1 = !isNullOrUndefined(gridData) && gridData.length > 0 ?\n                        !isNullOrUndefined(taskFields.endDate) ? new Date(getValue('endDate', gridData[0]).getTime()) :\n                            new Date(getValue('startDate', gridData[0]).getTime()) :\n                        !isNullOrUndefined(this.beforeOpenArgs.rowData.ganttProperties.startDate) &&\n                            new Date(this.beforeOpenArgs.rowData.ganttProperties.startDate.getTime());\n                    startDate_1.setHours(0, 0, 0, 0);\n                    if (!isNullOrUndefined(gridData) && gridData.length > 0) {\n                        startDate_1.setDate(startDate_1.getDate() + 2);\n                    }\n                    sDate = this.parent.dataOperation.checkStartDate(startDate_1);\n                    eDate = this.parent.dateValidationModule.getDateFromFormat(sDate);\n                    if (eDate.getHours() === 0 && this.parent.defaultEndTime !== 86400) {\n                        this.parent.dateValidationModule.setTime(this.parent.defaultEndTime, eDate);\n                    }\n                    eDate = !isNullOrUndefined(taskFields.endDate) && !isNullOrUndefined(gridData) && gridData.length <= 0 ?\n                        this.beforeOpenArgs.rowData.ganttProperties.endDate : eDate;\n                    duration = !isNullOrUndefined(taskFields.duration) && !isNullOrUndefined(gridData) && gridData.length <= 0 ?\n                        this.beforeOpenArgs.rowData.ganttProperties.duration : 1;\n                    arg = {\n                        startDate: sDate,\n                        endDate: eDate,\n                        duration: duration\n                    };\n                    args.rowData = arg;\n                }\n            }\n            this.selectedSegment = args.rowData;\n            // if (args.requestType === 'save') {\n            //     // let duration: string = 'duration';\n            //     // let tempDuration: Object = this.parent.dataOperation.getDurationValue(args.data[duration]);\n            //     // args.data[duration] = getValue('duration', tempDuration);\n            //     this.selectedSegment = !isNullOrUndefined(this.editedRecord.ganttProperties.segments[args.rowIndex]) ?\n            //         this.editedRecord.ganttProperties.segments[args.rowIndex] : !isNullOrUndefined(gridData[args.rowIndex]) ?\n            //             gridData[args.rowIndex] : gridData;\n            // }\n        }\n    };\n    DialogEdit.prototype.renderSegmentsTab = function (itemName) {\n        var ganttObj = this.parent;\n        var gridModel = this.beforeOpenArgs[itemName];\n        var ganttData = this.beforeOpenArgs.rowData;\n        var preData = [];\n        if (this.isEdit) {\n            preData = isNullOrUndefined(ganttData.ganttProperties.segments) ? [] : ganttData.ganttProperties.segments;\n        }\n        gridModel.dataSource = preData;\n        gridModel.actionBegin = this.segmentGridActionBegin.bind(this);\n        Grid.Inject(Edit, Page, GridToolbar, ForeignKey);\n        var gridObj = new Grid(gridModel);\n        var divElement = this.createDivElement('', ganttObj.element.id + '' + itemName + 'TabContainer');\n        gridObj.appendTo(divElement);\n        return divElement;\n    };\n    DialogEdit.prototype.renderGeneralTab = function (itemName) {\n        var ganttObj = this.parent;\n        var itemModel = this.beforeOpenArgs[itemName];\n        var divElement = this.createDivElement('e-edit-form-row', ganttObj.element.id\n            + '' + itemName + 'TabContainer');\n        for (var _i = 0, _a = Object.keys(itemModel); _i < _a.length; _i++) {\n            var key = _a[_i];\n            if (this.parent.columnByField[key].visible === false) {\n                continue;\n            }\n            var column = this.parent.columnByField[key];\n            var inputModel = itemModel[key];\n            divElement.appendChild(this.renderInputElements(inputModel, column));\n        }\n        return divElement;\n    };\n    DialogEdit.prototype.isCheckIsDisabled = function (column) {\n        var disabled = false;\n        if (column.allowEditing === false || column.isPrimaryKey || this.parent.readOnly) {\n            if (this.parent.customColumns.indexOf(column.field) !== -1) {\n                disabled = true;\n            }\n            else {\n                if (column.field === this.parent.taskFields.id || column.field === this.parent.taskFields.name ||\n                    column.field === this.parent.taskFields.duration || column.field === this.parent.taskFields.progress ||\n                    column.field === this.parent.taskFields.startDate || column.field === this.parent.taskFields.endDate ||\n                    column.field === this.parent.taskFields.baselineStartDate || column.field === this.parent.taskFields.baselineEndDate ||\n                    column.field === this.parent.taskFields.work || column.field === 'taskType') {\n                    disabled = true;\n                }\n            }\n        }\n        if (this.isEdit) {\n            if (column.field === this.parent.taskFields.id) {\n                disabled = true;\n            }\n            if (this.editedRecord.hasChildRecords) {\n                if (column.field === this.parent.taskFields.endDate || column.field === this.parent.taskFields.duration ||\n                    column.field === this.parent.taskFields.progress || column.field === this.parent.taskFields.work ||\n                    column.field === 'taskType') {\n                    disabled = true;\n                }\n            }\n        }\n        return disabled;\n    };\n    DialogEdit.prototype.renderPredecessorTab = function (itemName) {\n        var _this = this;\n        var ganttObj = this.parent;\n        var gridModel = this.beforeOpenArgs[itemName];\n        var dependencyColumn = this.parent.columnByField[this.parent.taskFields.dependency];\n        if (dependencyColumn.allowEditing === false || dependencyColumn.isPrimaryKey || this.parent.readOnly) {\n            gridModel.editSettings.allowEditing = false;\n            gridModel.editSettings.allowAdding = false;\n            gridModel.editSettings.allowDeleting = false;\n        }\n        var ganttData = this.beforeOpenArgs.rowData;\n        var preData = [];\n        this.taskNameCollection();\n        if (this.isEdit) {\n            preData = this.predecessorEditCollection(ganttData);\n            this.updatePredecessorDropDownData(ganttData);\n        }\n        gridModel.dataSource = preData;\n        gridModel.actionBegin = this.gridActionBegin.bind(this);\n        var columns = gridModel.columns;\n        columns[1].edit = {\n            write: function (args) {\n                if (getValue('requestType', args) === 'add') {\n                    setValue('rowData.uniqueId', getUid(), args);\n                }\n                var field = 'name';\n                var autoObj = new ComboBox({\n                    dataSource: new DataManager(_this.idCollection),\n                    popupHeight: '180px',\n                    allowCustom: false,\n                    fields: { value: 'text' },\n                    value: args.rowData[field],\n                    change: function (arg) {\n                        var tr = closest(arg.element, 'tr');\n                        var idInput = tr.querySelector('#' + _this.parent.element.id + 'DependencyTabContainerid');\n                        if (idInput) {\n                            if (!isNullOrUndefined(arg.itemData) && !isNullOrUndefined(arg.item)) {\n                                idInput.value = arg.itemData.id;\n                            }\n                            else {\n                                idInput.value = '';\n                            }\n                        }\n                    },\n                    autofill: true\n                });\n                autoObj.appendTo(args.element);\n            },\n            read: function (args) {\n                var ej2Instance = args.ej2_instances[0];\n                return ej2Instance.value;\n            }\n        };\n        Grid.Inject(Edit, Page, GridToolbar, ForeignKey);\n        var gridObj = new Grid(gridModel);\n        var divElement = this.createDivElement('e-dependent-div', ganttObj.element.id + '' + itemName + 'TabContainer');\n        gridObj.appendTo(divElement);\n        return divElement;\n    };\n    DialogEdit.prototype.gridActionBegin = function (args) {\n        var _this = this;\n        var itemName = 'Dependency';\n        var gridModel = this.beforeOpenArgs[itemName];\n        if (args.requestType === 'add' || args.requestType === 'beginEdit') {\n            var isEdit_1 = args.requestType === 'add' ? false : true;\n            this.idCollection = extend([], [], this.preTableCollection, true);\n            var gridData_1 = gridModel.dataSource;\n            var _loop_2 = function (i) {\n                // eslint-disable-next-line\n                this_2.idCollection.forEach(function (data, index) {\n                    if (data.id === getValue('id', gridData_1[i])) {\n                        var selectedItem = getValue('rowData', args);\n                        if (isEdit_1 && getValue('id', selectedItem) === data.id) {\n                            return;\n                        }\n                        _this.idCollection.splice(_this.idCollection.indexOf(data), 1);\n                    }\n                });\n            };\n            var this_2 = this;\n            for (var i = 0; i <= gridData_1.length; i++) {\n                _loop_2(i);\n            }\n        }\n    };\n    DialogEdit.prototype.updateResourceCollection = function (args, resourceTreeGridId) {\n        if (!isNullOrUndefined(args.data) && Object.keys(args.data).length) {\n            var ganttObj = this.parent;\n            var treeGridId = document.querySelector('#' + resourceTreeGridId);\n            var resourceTreeGrid = treeGridId.ej2_instances[0];\n            if (!isNullOrUndefined(resourceTreeGrid) && resourceTreeGrid.getSelectedRecords().length > 0) {\n                var tempRecords = resourceTreeGrid.getSelectedRecords();\n                var index = void 0;\n                var selectedItems = [];\n                for (index = 0; index < tempRecords.length; index++) {\n                    selectedItems.push(tempRecords[index].taskData);\n                }\n                this.ganttResources = extend([], selectedItems);\n            }\n            else {\n                this.ganttResources = [];\n            }\n        }\n        else {\n            this.ganttResources = [];\n        }\n    };\n    DialogEdit.prototype.renderResourceTab = function (itemName) {\n        var _this = this;\n        var ganttObj = this.parent;\n        var resourceSettings = ganttObj.resourceFields;\n        var ganttData = this.beforeOpenArgs.rowData;\n        var rowResource = ganttData.ganttProperties.resourceInfo;\n        var inputModel = this.beforeOpenArgs[itemName];\n        var resourceTreeGridId = ganttObj.element.id + '' + itemName + 'TabContainer';\n        var resourceData = extend([], [], ganttObj.resources, true);\n        this.parent.dataOperation.updateResourceUnit(resourceData);\n        if (!isNullOrUndefined(rowResource)) {\n            var count = void 0;\n            var rowResourceLength = rowResource.length;\n            var index = void 0;\n            var resourceDataLength = resourceData.length;\n            for (count = 0; count < rowResourceLength; count++) {\n                for (index = 0; index < resourceDataLength; index++) {\n                    if (rowResource[count][resourceSettings.id] === resourceData[index][resourceSettings.id]) {\n                        resourceData[index][resourceSettings.unit] = rowResource[count][resourceSettings.unit];\n                    }\n                }\n            }\n        }\n        inputModel.dataSource = resourceData;\n        var resourceInfo = ganttData.ganttProperties.resourceInfo;\n        if (this.isEdit && !isNullOrUndefined(resourceInfo)) {\n            for (var i = 0; i < resourceInfo.length; i++) {\n                this.ganttResources.push(resourceInfo[i]);\n            }\n        }\n        inputModel.rowSelected = function (args) {\n            _this.updateResourceCollection(args, resourceTreeGridId);\n        };\n        inputModel.rowDeselected = function (args) {\n            _this.updateResourceCollection(args, resourceTreeGridId);\n        };\n        var divElement = this.createDivElement('e-resource-div', resourceTreeGridId);\n        TreeGrid.Inject(Selection, Filter, TreeGridEdit, VirtualScroll);\n        var treeGridObj = new TreeGrid(inputModel);\n        var resourceColumn = this.parent.columnByField[this.parent.taskFields.resourceInfo];\n        if (resourceColumn.allowEditing === false || resourceColumn.isPrimaryKey || this.parent.readOnly) {\n            treeGridObj.allowSelection = false;\n            treeGridObj.allowFiltering = false;\n            treeGridObj.editSettings.allowEditing = false;\n        }\n        treeGridObj.dataBound = function () {\n            if (_this.parent.editDialogFields.length >= 1 && _this.parent.editDialogFields[0].type === 'Resources') {\n                var id = _this.parent.element.id + 'ResourcesTabContainer';\n                _this.resourceSelection(id);\n            }\n        };\n        treeGridObj.appendTo(divElement);\n        return divElement;\n    };\n    DialogEdit.prototype.resourceSelection = function (id) {\n        var _this = this;\n        var resourceTreeGrid = document.querySelector('#' + id).ej2_instances[0];\n        var currentViewData = resourceTreeGrid.getCurrentViewRecords();\n        var resources = this.ganttResources;\n        if (resources && resources.length > 0) {\n            currentViewData.forEach(function (data, index) {\n                for (var i = 0; i < resources.length; i++) {\n                    if (data.taskData[_this.parent.resourceFields.id] === resources[i][_this.parent.resourceFields.id] &&\n                        !isNullOrUndefined(resourceTreeGrid.selectionModule) &&\n                        resourceTreeGrid.getSelectedRowIndexes().indexOf(index) === -1) {\n                        resourceTreeGrid.selectRow(index);\n                    }\n                }\n            });\n        }\n    };\n    DialogEdit.prototype.renderCustomTab = function (itemName) {\n        return this.renderGeneralTab(itemName);\n    };\n    DialogEdit.prototype.renderNotesTab = function (itemName) {\n        var ganttObj = this.parent;\n        var inputModel = this.beforeOpenArgs[itemName];\n        var ganttProp = this.editedRecord.ganttProperties;\n        var divElement = this.createDivElement('', ganttObj.element.id + '' + itemName + 'TabContainer');\n        RichTextEditor.Inject(RTEToolbar, Link, HtmlEditor, QuickToolbar, Count);\n        inputModel.value = ganttProp.notes;\n        var notesColumn = this.parent.columnByField[this.parent.taskFields.notes];\n        if (notesColumn.allowEditing === false || notesColumn.isPrimaryKey || this.parent.readOnly) {\n            inputModel.enabled = false;\n        }\n        var rteObj = new RichTextEditor(inputModel);\n        rteObj.appendTo(divElement);\n        return divElement;\n    };\n    DialogEdit.prototype.renderInputElements = function (inputModel, column) {\n        var _this = this;\n        var ganttId = this.parent.element.id;\n        var ganttData = this.editedRecord;\n        var divElement = this.createDivElement('e-edit-form-column');\n        var inputElement;\n        var editArgs = { column: column, data: ganttData };\n        if (!isNullOrUndefined(column.edit) && isNullOrUndefined(column.edit.params)) {\n            var create = column.edit.create;\n            if (typeof create === 'string') {\n                create = getObject(create, window);\n                inputElement = create(editArgs);\n            }\n            else {\n                inputElement = column.edit.create(editArgs);\n            }\n            inputElement.className = '';\n            inputElement.setAttribute('type', 'text');\n            inputElement.setAttribute('id', ganttId + '' + column.field);\n            inputElement.setAttribute('name', column.field);\n            inputElement.setAttribute('title', column.field);\n            divElement.appendChild(inputElement);\n        }\n        else {\n            inputElement = this.createInputElement('', ganttId + '' + column.field, column.field);\n            divElement.appendChild(inputElement);\n        }\n        inputModel.enabled = !this.isCheckIsDisabled(column);\n        if (column.field === this.parent.taskFields.duration) {\n            if (!isNullOrUndefined(column.valueAccessor)) {\n                if (typeof column.valueAccessor === 'string') {\n                    var valueAccessor = getObject(column.valueAccessor, window);\n                    inputModel.value = valueAccessor(column.field, ganttData, column);\n                }\n                else {\n                    inputModel.value = column.valueAccessor(column.field, ganttData, column);\n                }\n            }\n            else if (isNullOrUndefined(column.edit)) {\n                var ganttProp = ganttData.ganttProperties;\n                inputModel.value = this.parent.dataOperation.getDurationString(ganttProp.duration, ganttProp.durationUnit);\n            }\n        }\n        else {\n            if (column.editType === 'booleanedit') {\n                if (ganttData[column.field] === true) {\n                    inputModel.checked = true;\n                }\n                else {\n                    inputModel.checked = false;\n                }\n            }\n            else {\n                inputModel.value = ganttData[column.field];\n            }\n        }\n        if (!isNullOrUndefined(column.edit) && isNullOrUndefined(column.edit.params)) {\n            var write = column.edit.write;\n            var inputObj = void 0;\n            if (typeof write === 'string') {\n                write = getObject(write, window);\n                inputObj = write({\n                    column: column, rowData: ganttData, element: inputElement\n                });\n            }\n            else {\n                inputObj = column.edit.write({\n                    column: column, rowData: ganttData, element: inputElement\n                });\n            }\n            if (column.field === this.parent.taskFields.duration) {\n                inputObj.change = function (args) {\n                    _this.validateScheduleFields(args, column, _this.parent);\n                };\n            }\n        }\n        else {\n            var inputObj = new this.inputs[column.editType](inputModel);\n            inputObj.appendTo(inputElement);\n        }\n        return divElement;\n    };\n    DialogEdit.prototype.taskNameCollection = function () {\n        var flatData = this.parent.flatData;\n        this.preTaskIds = [];\n        this.preTableCollection = [];\n        for (var i = 0; i < flatData.length; i++) {\n            var data = flatData[i];\n            if (data.hasChildRecords) {\n                continue;\n            }\n            var taskId = this.parent.viewType === 'ResourceView' ? data.ganttProperties.taskId.toString()\n                : data.ganttProperties.rowUniqueID.toString();\n            var tempObject = {\n                id: taskId,\n                text: (taskId + '-' + data.ganttProperties.taskName),\n                value: taskId\n            };\n            this.preTaskIds.push(tempObject.id);\n            this.preTableCollection.push(tempObject);\n        }\n    };\n    DialogEdit.prototype.predecessorEditCollection = function (ganttData) {\n        var preDataCollection = [];\n        var ganttProp = ganttData.ganttProperties;\n        if (this.isEdit && !isNullOrUndefined(this.parent.taskFields.dependency) && !isNullOrUndefined(ganttData) &&\n            !isNullOrUndefined(ganttProp.predecessor)) {\n            var predecessor = ganttProp.predecessor;\n            var idCollection = this.preTableCollection;\n            for (var i = 0; i < predecessor.length; i++) {\n                var from = predecessor[i].from.toString();\n                var preData = {};\n                var taskID = this.parent.viewType === 'ResourceView' ? ganttProp.taskId : ganttProp.rowUniqueID;\n                if (taskID.toString() !== from) {\n                    preData.id = from;\n                    for (var index = 0; index < idCollection.length; index++) {\n                        if (idCollection[index].value === from) {\n                            preData.name = idCollection[index].text;\n                            break;\n                        }\n                    }\n                    preData.type = predecessor[i].type;\n                    var offset = predecessor[i].offset;\n                    var offsetUnit = predecessor[i].offsetUnit;\n                    preData.offset = this.parent.dataOperation.getDurationString(offset, offsetUnit);\n                    preData.uniqueId = getUid();\n                    preDataCollection.push(preData);\n                }\n            }\n        }\n        return preDataCollection;\n    };\n    DialogEdit.prototype.updatePredecessorDropDownData = function (ganttData) {\n        var index = -1;\n        var id = this.parent.viewType === 'ResourceView' ? ganttData.ganttProperties.taskId.toString()\n            : ganttData.ganttProperties.rowUniqueID.toString();\n        index = this.preTaskIds.indexOf(id);\n        this.preTableCollection.splice(index, 1);\n        this.preTaskIds.splice(index, 1);\n        this.validSuccessorTasks(ganttData, this.preTaskIds, this.preTableCollection);\n    };\n    DialogEdit.prototype.validSuccessorTasks = function (data, ids, idCollection) {\n        var _this = this;\n        var ganttProp = data.ganttProperties;\n        if (ganttProp.predecessor && ganttProp.predecessor.length > 0) {\n            var predecessor = ganttProp.predecessor;\n            var fromId_1 = this.parent.viewType === 'ResourceView' ? ganttProp.taskId.toString() : ganttProp.rowUniqueID.toString();\n            predecessor.forEach(function (item) {\n                if (item.from.toString() === fromId_1) {\n                    var toId = item.to;\n                    var idIndex = -1;\n                    idIndex = ids.indexOf(toId);\n                    if (idIndex > -1) {\n                        ids.splice(idIndex, 1);\n                        idCollection.splice(idIndex, 1);\n                    }\n                    var ganttData = _this.parent.connectorLineModule.getRecordByID(toId);\n                    _this.validSuccessorTasks(ganttData, ids, idCollection);\n                }\n            });\n        }\n    };\n    DialogEdit.prototype.getPredecessorType = function () {\n        var typeText = [this.parent.getPredecessorTextValue('SS'), this.parent.getPredecessorTextValue('SF'),\n            this.parent.getPredecessorTextValue('FS'), this.parent.getPredecessorTextValue('FF')];\n        var types = [\n            { id: 'FS', text: typeText[2], value: typeText[2] },\n            { id: 'FF', text: typeText[3], value: typeText[3] },\n            { id: 'SS', text: typeText[0], value: typeText[0] },\n            { id: 'SF', text: typeText[1], value: typeText[1] }\n        ];\n        return types;\n    };\n    DialogEdit.prototype.initiateDialogSave = function () {\n        if (this.isEdit) {\n            this.parent.initiateEditAction(true);\n        }\n        else {\n            this.addedRecord = {};\n        }\n        var ganttObj = this.parent;\n        var tabModel = this.beforeOpenArgs.tabModel;\n        var items = tabModel.items;\n        for (var i = 0; i < items.length; i++) {\n            var element = items[i].content;\n            var id = element.id;\n            if (!isNullOrUndefined(id) || id !== '') {\n                id = id.replace(ganttObj.element.id, '');\n                id = id.replace('TabContainer', '');\n                if (id === 'General') {\n                    this.updateGeneralTab(element, false);\n                }\n                else if (id === 'Dependency') {\n                    this.updatePredecessorTab(element);\n                }\n                else if (id === 'Notes') {\n                    this.updateNotesTab(element);\n                }\n                else if (id === 'Resources') {\n                    this.updateResourceTab(element);\n                }\n                else if (id.indexOf('Custom') !== -1) {\n                    this.updateCustomTab(element);\n                }\n                else if (id === 'Segments') {\n                    this.updateSegmentsData(element, this.beforeOpenArgs.rowData);\n                }\n            }\n        }\n        if (this.isEdit) {\n            /**\n             * If any update on edited task do it here\n             */\n            this.parent.dataOperation.updateWidthLeft(this.rowData);\n            var editArgs = {\n                data: this.rowData,\n                action: 'DialogEditing'\n            };\n            this.parent.editModule.initiateUpdateAction(editArgs);\n        }\n        else {\n            if (this.parent.viewType === 'ResourceView') {\n                var newRecords = extend({}, this.addedRecord, true);\n                if (newRecords[this.parent.taskFields.resourceInfo].length) {\n                    for (var i = 0; i < newRecords[this.parent.taskFields.resourceInfo].length; i++) {\n                        var id = newRecords[this.parent.taskFields.resourceInfo][i].toString();\n                        var parentRecordIndex = this.parent.getTaskIds().indexOf('R' + id.toString());\n                        if (parentRecordIndex !== -1) {\n                            this.parent.editModule.addRecord(this.addedRecord, 'Child', parentRecordIndex);\n                            break;\n                        }\n                    }\n                }\n                else {\n                    this.parent.editModule.addRecord(this.addedRecord, 'Bottom');\n                }\n            }\n            else {\n                this.parent.editModule.addRecord(this.addedRecord, this.parent.editSettings.newRowPosition);\n            }\n        }\n        return true;\n    };\n    DialogEdit.prototype.updateSegmentTaskData = function (dataSource) {\n        var userData = [];\n        var taskSettings = this.parent.taskFields;\n        for (var i = 0; i < dataSource.length; i++) {\n            var taskData = {};\n            if (!isNullOrUndefined(taskSettings.startDate)) {\n                taskData[this.parent.taskFields.startDate] = dataSource[i].startDate;\n            }\n            if (!isNullOrUndefined(taskSettings.endDate)) {\n                taskData[this.parent.taskFields.endDate] = dataSource[i].endDate;\n            }\n            if (!isNullOrUndefined(taskSettings.duration)) {\n                taskData[this.parent.taskFields.duration] = Number(dataSource[i].duration);\n                dataSource[i].duration = taskData[this.parent.taskFields.duration];\n            }\n            userData.push(taskData);\n        }\n        if (!this.isEdit) {\n            this.addedRecord[taskSettings.segments] = userData;\n        }\n        else {\n            this.rowData.ganttProperties.segments = dataSource;\n            this.parent.setRecordValue('segments', this.parent.dataOperation.setSegmentsInfo(this.rowData, false), this.rowData.ganttProperties, true);\n            this.parent.setRecordValue('taskData.' + this.parent.taskFields.segments, userData, this.rowData);\n        }\n    };\n    // eslint-disable-next-line\n    DialogEdit.prototype.updateSegmentsData = function (segmentForm, data) {\n        var gridObj = segmentForm.ej2_instances[0];\n        if (gridObj.isEdit) {\n            gridObj.endEdit();\n        }\n        var dataSource = gridObj.currentViewData;\n        this.updateSegmentTaskData(dataSource);\n    };\n    DialogEdit.prototype.updateGeneralTab = function (generalForm, isCustom) {\n        var ganttObj = this.parent;\n        var childNodes = generalForm.childNodes;\n        var tasksData = {};\n        if (!this.isEdit) {\n            tasksData = this.addedRecord;\n        }\n        for (var i = 0; i < childNodes.length; i++) {\n            var div = childNodes[i];\n            var inputElement = div.querySelector('input[id^=\"' + ganttObj.element.id + '\"]');\n            if (inputElement) {\n                var fieldName = inputElement.id.replace(ganttObj.element.id, '');\n                var controlObj = div.querySelector('#' + ganttObj.element.id + fieldName).ej2_instances[0];\n                var column = ganttObj.columnByField[fieldName];\n                if (!isNullOrUndefined(column.edit) && isNullOrUndefined(column.edit.params)) {\n                    var read = column.edit.read;\n                    if (typeof read === 'string') {\n                        read = getObject(read, window);\n                        tasksData[fieldName] = read(inputElement, controlObj.value);\n                    }\n                    else {\n                        tasksData[fieldName] = column.edit.read(inputElement, controlObj.value);\n                    }\n                }\n                else if (isCustom && column.editType === 'booleanedit') {\n                    if (inputElement.checked === true) {\n                        tasksData[fieldName] = true;\n                    }\n                    else {\n                        tasksData[fieldName] = false;\n                    }\n                }\n                else {\n                    tasksData[fieldName] = controlObj.value;\n                }\n            }\n        }\n        if (this.isEdit) {\n            this.updateScheduleProperties(this.editedRecord, this.rowData);\n            ganttObj.editModule.validateUpdateValues(tasksData, this.rowData, true);\n        }\n    };\n    DialogEdit.prototype.updateScheduleProperties = function (fromRecord, toRecord) {\n        this.parent.setRecordValue('startDate', fromRecord.ganttProperties.startDate, toRecord.ganttProperties, true);\n        this.parent.setRecordValue('endDate', fromRecord.ganttProperties.endDate, toRecord.ganttProperties, true);\n        this.parent.setRecordValue('duration', fromRecord.ganttProperties.duration, toRecord.ganttProperties, true);\n        this.parent.setRecordValue('durationUnit', fromRecord.ganttProperties.durationUnit, toRecord.ganttProperties, true);\n        this.parent.setRecordValue('work', fromRecord.ganttProperties.work, toRecord.ganttProperties, true);\n        if (!isNullOrUndefined(this.parent.taskFields.startDate)) {\n            this.parent.dataOperation.updateMappingData(this.rowData, this.parent.taskFields.startDate);\n        }\n        if (!isNullOrUndefined(this.parent.taskFields.endDate)) {\n            this.parent.dataOperation.updateMappingData(this.rowData, this.parent.taskFields.endDate);\n        }\n        if (!isNullOrUndefined(this.parent.taskFields.duration)) {\n            this.parent.dataOperation.updateMappingData(this.rowData, this.parent.taskFields.duration);\n            this.parent.setRecordValue('durationUnit', fromRecord.ganttProperties.durationUnit, this.rowData, true);\n            if (this.rowData.ganttProperties.duration === 0) {\n                this.parent.setRecordValue('isMilestone', true, this.rowData.ganttProperties, true);\n            }\n            else {\n                this.parent.setRecordValue('isMilestone', false, this.rowData.ganttProperties, true);\n            }\n        }\n        if (!isNullOrUndefined(this.parent.taskFields.work)) {\n            this.parent.dataOperation.updateMappingData(this.rowData, this.parent.taskFields.work);\n        }\n        if (!isNullOrUndefined(this.parent.taskFields.manual)) {\n            this.parent.dataOperation.updateMappingData(this.rowData, this.parent.taskFields.manual);\n        }\n    };\n    DialogEdit.prototype.updatePredecessorTab = function (preElement) {\n        var gridObj = preElement.ej2_instances[0];\n        if (gridObj.isEdit) {\n            gridObj.endEdit();\n        }\n        var dataSource = gridObj.dataSource;\n        var predecessorName = [];\n        var newValues = [];\n        var predecessorString = '';\n        var ids = [];\n        for (var i = 0; i < dataSource.length; i++) {\n            var preData = dataSource[i];\n            var newId = preData.name.split('-')[0];\n            if (preData.id !== newId) {\n                preData.id = newId;\n            }\n            if (ids.indexOf(preData.id) === -1) {\n                var name_1 = preData.id + preData.type;\n                if (preData.offset && preData.offset.indexOf('-') !== -1) {\n                    name_1 += preData.offset;\n                }\n                else {\n                    name_1 += ('+' + preData.offset);\n                }\n                predecessorName.push(name_1);\n                ids.push(preData.id);\n            }\n        }\n        if (this.isEdit) {\n            if (predecessorName.length > 0) {\n                newValues = this.parent.predecessorModule.calculatePredecessor(predecessorName.join(','), this.rowData);\n                this.parent.setRecordValue('predecessor', newValues, this.rowData.ganttProperties, true);\n                predecessorString = this.parent.predecessorModule.getPredecessorStringValue(this.rowData);\n            }\n            else {\n                newValues = [];\n                this.parent.setRecordValue('predecessor', newValues, this.rowData.ganttProperties, true);\n                predecessorString = '';\n            }\n            this.parent.setRecordValue('predecessorsName', predecessorString, this.rowData.ganttProperties, true);\n            this.parent.setRecordValue('taskData.' + this.parent.taskFields.dependency, predecessorString, this.rowData);\n            this.parent.setRecordValue(this.parent.taskFields.dependency, predecessorString, this.rowData);\n            this.parent.predecessorModule.updateUnscheduledDependency(this.rowData);\n        }\n        else {\n            this.addedRecord[this.parent.taskFields.dependency] = predecessorName.length > 0 ? predecessorName.join(',') : '';\n        }\n    };\n    DialogEdit.prototype.updateResourceTab = function (resourceElement) {\n        var treeGridObj = resourceElement.ej2_instances[0];\n        if (treeGridObj) {\n            treeGridObj.grid.endEdit();\n        }\n        var selectedItems = this.ganttResources;\n        if (this.parent.viewType === 'ResourceView' && !isNullOrUndefined(this.rowData.ganttProperties)) {\n            if (JSON.stringify(this.ganttResources) !== JSON.stringify(this.rowData.ganttProperties.resourceInfo)) {\n                this.isResourceUpdate = true;\n                this.previousResource = !isNullOrUndefined(this.rowData.ganttProperties.resourceInfo) ? this.rowData.ganttProperties.resourceInfo.slice() : [];\n            }\n            else {\n                this.isResourceUpdate = false;\n            }\n        }\n        var idArray = [];\n        if (this.isEdit) {\n            this.parent.setRecordValue('resourceInfo', selectedItems, this.rowData.ganttProperties, true);\n            this.parent.dataOperation.updateMappingData(this.rowData, 'resourceInfo');\n            this.parent.editModule.updateResourceRelatedFields(this.rowData, 'resource');\n            this.validateDuration(this.rowData);\n        }\n        else {\n            for (var i = 0; i < selectedItems.length; i++) {\n                idArray.push(selectedItems[i][this.parent.resourceFields.id]);\n                this.isAddNewResource = true;\n            }\n            this.addedRecord[this.parent.taskFields.resourceInfo] = idArray;\n        }\n    };\n    DialogEdit.prototype.updateNotesTab = function (notesElement) {\n        var ganttObj = this.parent;\n        var rte = notesElement.ej2_instances[0];\n        if (this.isEdit) {\n            if (ganttObj.columnByField[ganttObj.taskFields.notes].disableHtmlEncode) {\n                this.parent.setRecordValue('notes', rte.getHtml(), this.rowData.ganttProperties, true);\n            }\n            else {\n                this.parent.setRecordValue('notes', rte.getText(), this.rowData.ganttProperties, true);\n            }\n            ganttObj.dataOperation.updateMappingData(this.rowData, 'notes');\n        }\n        else {\n            this.addedRecord[this.parent.taskFields.notes] = rte.getHtml();\n        }\n    };\n    DialogEdit.prototype.updateCustomTab = function (customElement) {\n        this.updateGeneralTab(customElement, true);\n    };\n    return DialogEdit;\n}());\nexport { DialogEdit };\n"]},"metadata":{},"sourceType":"module"}