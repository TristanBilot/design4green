{"ast":null,"code":"import { select, isNullOrUndefined, Browser, addClass, removeClass, EventHandler, closest, isNullOrUndefined as isNOU } from '@syncfusion/ej2-base';\nimport { RenderType } from '../base/enum';\nimport * as events from '../base/constant';\nimport { pageYOffset, hasClass, isIDevice } from '../base/util';\nimport { BaseQuickToolbar } from './base-quick-toolbar';\nimport { PopupRenderer } from '../renderer/popup-renderer';\nimport { CLS_INLINE_POP, CLS_INLINE } from '../base/classes';\n/**\n * `Quick toolbar` module is used to handle Quick toolbar actions.\n */\n\nvar QuickToolbar =\n/** @class */\nfunction () {\n  function QuickToolbar(parent, locator) {\n    this.parent = parent;\n    this.locator = locator;\n    this.renderFactory = this.locator.getService('rendererFactory');\n    this.renderFactory.addRenderer(RenderType.Popup, new PopupRenderer(this.parent));\n    this.addEventListener();\n  }\n\n  QuickToolbar.prototype.formatItems = function (items) {\n    var formattedItems = [];\n    items.forEach(function (item) {\n      if (typeof item === 'string') {\n        switch (item.toLocaleLowerCase()) {\n          case 'open':\n            formattedItems.push('openLink');\n            break;\n\n          case 'edit':\n            formattedItems.push('editLink');\n            break;\n\n          case 'unlink':\n            formattedItems.push('removeLink');\n            break;\n\n          default:\n            formattedItems.push(item);\n            break;\n        }\n      } else {\n        formattedItems.push(item);\n      }\n    });\n    return formattedItems;\n  };\n\n  QuickToolbar.prototype.getQTBarOptions = function (popType, mode, items, type) {\n    return {\n      popupType: popType,\n      toolbarItems: items,\n      mode: mode,\n      renderType: type\n    };\n  };\n  /**\n   * createQTBar method\n   *\n   * @param {string} popupType - specifies the string value\n   * @param {string} mode - specifies the string value.\n   * @param {string} items - specifies the string.\n   * @param {RenderType} type - specifies the render type.\n   * @returns {BaseQuickToolbar} - specifies the quick toolbar\n   * @hidden\n    */\n\n\n  QuickToolbar.prototype.createQTBar = function (popupType, mode, items, type) {\n    if (items.length < 1) {\n      return null;\n    }\n\n    var qTBar = new BaseQuickToolbar(this.parent, this.locator);\n    qTBar.render(this.getQTBarOptions(popupType, mode, this.formatItems(items), type));\n    return qTBar;\n  };\n\n  QuickToolbar.prototype.initializeQuickToolbars = function () {\n    this.parent.quickToolbarModule = this;\n    this.contentRenderer = this.renderFactory.getRenderer(RenderType.Content);\n\n    if (this.parent.inlineMode.enable && this.parent.inlineMode.onSelection && isIDevice()) {\n      EventHandler.add(this.contentRenderer.getDocument(), 'selectionchange', this.selectionChangeHandler, this);\n    }\n  }; // eslint-disable-next-line\n\n\n  QuickToolbar.prototype.onMouseDown = function (e) {\n    this.parent.isBlur = false;\n    this.parent.isRTE = true;\n  };\n\n  QuickToolbar.prototype.renderQuickToolbars = function () {\n    if (this.linkQTBar || this.imageQTBar || this.textQTBar || this.tableQTBar) {\n      return;\n    }\n\n    this.linkQTBar = this.createQTBar('Link', 'Scrollable', this.parent.quickToolbarSettings.link, RenderType.LinkToolbar);\n    this.renderFactory.addRenderer(RenderType.LinkToolbar, this.linkQTBar);\n    this.textQTBar = this.createQTBar('Text', 'Scrollable', this.parent.quickToolbarSettings.text, RenderType.TextToolbar);\n    this.renderFactory.addRenderer(RenderType.TextToolbar, this.textQTBar);\n    this.imageQTBar = this.createQTBar('Image', 'MultiRow', this.parent.quickToolbarSettings.image, RenderType.ImageToolbar);\n    this.renderFactory.addRenderer(RenderType.ImageToolbar, this.imageQTBar);\n    this.tableQTBar = this.createQTBar('Table', 'MultiRow', this.parent.quickToolbarSettings.table, RenderType.TableToolbar);\n    this.renderFactory.addRenderer(RenderType.TableToolbar, this.tableQTBar);\n\n    if (this.linkQTBar) {\n      EventHandler.add(this.linkQTBar.element, 'mousedown', this.onMouseDown, this);\n    }\n\n    if (this.imageQTBar) {\n      EventHandler.add(this.imageQTBar.element, 'mousedown', this.onMouseDown, this);\n    }\n\n    if (this.textQTBar) {\n      EventHandler.add(this.textQTBar.element, 'mousedown', this.onMouseDown, this);\n    }\n\n    if (this.tableQTBar) {\n      EventHandler.add(this.tableQTBar.element, 'mousedown', this.onMouseDown, this);\n    }\n  };\n\n  QuickToolbar.prototype.renderInlineQuickToolbar = function () {\n    if (this.parent.inlineMode.enable && (!Browser.isDevice || isIDevice())) {\n      addClass([this.parent.element], [CLS_INLINE]);\n      this.inlineQTBar = this.createQTBar('Inline', 'MultiRow', this.parent.toolbarSettings.items, RenderType.InlineToolbar);\n      this.renderFactory.addRenderer(RenderType.InlineToolbar, this.inlineQTBar);\n      EventHandler.add(this.inlineQTBar.element, 'mousedown', this.onMouseDown, this);\n    }\n  };\n  /**\n   * Method for showing the inline quick toolbar\n   *\n   * @param {number} x -specifies the value of x.\n   * @param {number} y - specifies the y valu.\n   * @param {HTMLElement} target - specifies the target element.\n   * @returns {void}\n   * @hidden\n    */\n\n\n  QuickToolbar.prototype.showInlineQTBar = function (x, y, target) {\n    if (this.parent.readonly) {\n      return;\n    }\n\n    this.inlineQTBar.showPopup(x, y, target);\n  };\n  /**\n   * Method for hidding the inline quick toolbar\n   *\n   * @returns {void}\n   * @hidden\n    */\n\n\n  QuickToolbar.prototype.hideInlineQTBar = function () {\n    if (this.inlineQTBar && !hasClass(this.inlineQTBar.element, 'e-popup-close')) {\n      this.inlineQTBar.hidePopup();\n    }\n  };\n  /**\n   * Method for hidding the quick toolbar\n   *\n   * @returns {void}\n   * @hidden\n    */\n\n\n  QuickToolbar.prototype.hideQuickToolbars = function () {\n    if (this.linkQTBar && !hasClass(this.linkQTBar.element, 'e-popup-close') && document.body.contains(this.linkQTBar.element)) {\n      this.linkQTBar.hidePopup();\n    }\n\n    if (this.textQTBar && !hasClass(this.textQTBar.element, 'e-popup-close') && document.body.contains(this.textQTBar.element)) {\n      this.textQTBar.hidePopup();\n    }\n\n    if (this.imageQTBar && !hasClass(this.imageQTBar.element, 'e-popup-close') && document.body.contains(this.imageQTBar.element)) {\n      this.imageQTBar.hidePopup();\n    }\n\n    if (this.tableQTBar && !hasClass(this.tableQTBar.element, 'e-popup-close') && document.body.contains(this.tableQTBar.element)) {\n      this.tableQTBar.hidePopup();\n    }\n\n    if (this.parent.inlineMode.enable && (!Browser.isDevice || isIDevice())) {\n      this.hideInlineQTBar();\n    }\n  };\n\n  QuickToolbar.prototype.deBounce = function (x, y, target) {\n    var _this = this;\n\n    clearTimeout(this.deBouncer);\n    this.deBouncer = window.setTimeout(function () {\n      _this.showInlineQTBar(x, y, target);\n    }, 1000);\n  };\n\n  QuickToolbar.prototype.mouseUpHandler = function (e) {\n    if (this.parent.inlineMode.enable && (!Browser.isDevice || isIDevice())) {\n      var args = e.args.touches ? e.args.changedTouches[0] : e.args;\n      var range = this.parent.getRange();\n      var target = e.args.target;\n\n      if (isNullOrUndefined(select('.' + CLS_INLINE_POP, document.body))) {\n        if (isIDevice() && e.touchData && e.touchData.prevClientX !== e.touchData.clientX && e.touchData.prevClientY !== e.touchData.clientY) {\n          return;\n        }\n\n        this.hideInlineQTBar();\n        var parentLeft = this.parent.element.getBoundingClientRect().left;\n        this.offsetX = this.parent.iframeSettings.enable ? window.pageXOffset + parentLeft + args.clientX : args.pageX;\n        this.offsetY = pageYOffset(args, this.parent.element, this.parent.iframeSettings.enable);\n\n        if (target.nodeName === 'TEXTAREA') {\n          this.showInlineQTBar(this.offsetX, this.offsetY, target);\n        } else {\n          var closestAnchor = closest(target, 'a');\n          target = closestAnchor ? closestAnchor : target;\n          var startNode = this.parent.getRange().startContainer.parentElement;\n          var endNode = this.parent.getRange().endContainer.parentElement;\n\n          if ((isNOU(closest(startNode, 'A')) || isNOU(closest(endNode, 'A'))) && (!closest(target, 'td,th') || !range.collapsed) && (target.tagName !== 'IMG' || this.parent.getRange().startOffset !== this.parent.getRange().endOffset)) {\n            if (this.parent.inlineMode.onSelection && range.collapsed) {\n              return;\n            }\n\n            this.target = target;\n            this.showInlineQTBar(this.offsetX, this.offsetY, target);\n          }\n        }\n      }\n    }\n  };\n\n  QuickToolbar.prototype.keyDownHandler = function () {\n    if (this.parent.inlineMode.enable && (!Browser.isDevice || isIDevice()) && !isNullOrUndefined(select('.' + CLS_INLINE_POP, document))) {\n      this.hideInlineQTBar();\n    }\n  };\n\n  QuickToolbar.prototype.inlineQTBarMouseDownHandler = function () {\n    if (this.parent.inlineMode.enable && (!Browser.isDevice || isIDevice()) && !isNullOrUndefined(select('.' + CLS_INLINE_POP, document))) {\n      this.hideInlineQTBar();\n    }\n  };\n\n  QuickToolbar.prototype.keyUpHandler = function (e) {\n    if (this.parent.inlineMode.enable && !Browser.isDevice) {\n      if (this.parent.inlineMode.onSelection) {\n        return;\n      }\n\n      var args = e.args;\n      this.deBounce(this.offsetX, this.offsetY, args.target);\n    }\n  };\n\n  QuickToolbar.prototype.selectionChangeHandler = function (e) {\n    var _this = this;\n\n    clearTimeout(this.deBouncer);\n    this.deBouncer = window.setTimeout(function () {\n      _this.onSelectionChange(e);\n    }, 1000);\n  };\n\n  QuickToolbar.prototype.onSelectionChange = function (e) {\n    if (!isNullOrUndefined(select('.' + CLS_INLINE_POP, document.body))) {\n      return;\n    }\n\n    var selection = this.contentRenderer.getDocument().getSelection();\n\n    if (!selection.isCollapsed) {\n      this.mouseUpHandler({\n        args: e\n      });\n    }\n  };\n  /**\n   * getInlineBaseToolbar method\n   *\n   * @returns {void}\n   * @hidden\n    */\n\n\n  QuickToolbar.prototype.getInlineBaseToolbar = function () {\n    return this.inlineQTBar && this.inlineQTBar.quickTBarObj;\n  };\n  /**\n   * Destroys the ToolBar.\n   *\n   * @function destroy\n   * @returns {void}\n   * @hidden\n    */\n\n\n  QuickToolbar.prototype.destroy = function () {\n    if (this.linkQTBar) {\n      EventHandler.remove(this.linkQTBar.element, 'mousedown', this.onMouseDown);\n      this.linkQTBar.destroy();\n    }\n\n    if (this.textQTBar) {\n      EventHandler.remove(this.textQTBar.element, 'mousedown', this.onMouseDown);\n      this.textQTBar.destroy();\n    }\n\n    if (this.imageQTBar) {\n      EventHandler.remove(this.imageQTBar.element, 'mousedown', this.onMouseDown);\n      this.imageQTBar.destroy();\n    }\n\n    if (this.tableQTBar) {\n      EventHandler.remove(this.tableQTBar.element, 'mousedown', this.onMouseDown);\n      this.tableQTBar.destroy();\n    }\n\n    if (this.inlineQTBar) {\n      EventHandler.remove(this.inlineQTBar.element, 'mousedown', this.onMouseDown);\n\n      if (isIDevice()) {\n        EventHandler.remove(document, 'selectionchange', this.selectionChangeHandler);\n      }\n\n      this.inlineQTBar.destroy();\n    }\n\n    this.removeEventListener();\n  };\n\n  QuickToolbar.prototype.wireInlineQTBarEvents = function () {\n    this.parent.on(events.mouseUp, this.mouseUpHandler, this);\n    this.parent.on(events.mouseDown, this.inlineQTBarMouseDownHandler, this);\n    this.parent.on(events.keyDown, this.keyDownHandler, this);\n    this.parent.on(events.keyUp, this.keyUpHandler, this);\n    this.parent.on(events.sourceCodeMouseDown, this.mouseUpHandler, this);\n    this.parent.on(events.renderInlineToolbar, this.renderInlineQuickToolbar, this);\n  };\n\n  QuickToolbar.prototype.unWireInlineQTBarEvents = function () {\n    this.parent.off(events.mouseUp, this.mouseUpHandler);\n    this.parent.off(events.mouseDown, this.inlineQTBarMouseDownHandler);\n    this.parent.off(events.keyDown, this.keyDownHandler);\n    this.parent.off(events.keyUp, this.keyUpHandler);\n    this.parent.off(events.sourceCodeMouseDown, this.mouseUpHandler);\n    this.parent.off(events.renderInlineToolbar, this.renderInlineQuickToolbar);\n  }; // eslint-disable-next-line\n\n\n  QuickToolbar.prototype.toolbarUpdated = function (args) {\n    if (this.linkQTBar && !hasClass(this.linkQTBar.element, 'e-popup-close')) {\n      this.linkQTBar.hidePopup();\n    }\n\n    if (this.imageQTBar && !hasClass(this.imageQTBar.element, 'e-popup-close')) {\n      this.imageQTBar.hidePopup();\n    }\n\n    if (this.tableQTBar && !hasClass(this.tableQTBar.element, 'e-popup-close')) {\n      this.tableQTBar.hidePopup();\n    }\n  };\n  /**\n   * addEventListener\n   *\n   * @returns {void}\n   * @hidden\n    */\n\n\n  QuickToolbar.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.on(events.initialEnd, this.initializeQuickToolbars, this);\n    this.parent.on(events.mouseDown, this.renderQuickToolbars, this);\n    this.parent.on(events.toolbarUpdated, this.toolbarUpdated, this);\n    this.parent.on(events.drop, this.renderQuickToolbars, this);\n    this.wireInlineQTBarEvents();\n    this.parent.on(events.modelChanged, this.onPropertyChanged, this);\n\n    if (this.parent.quickToolbarSettings.actionOnScroll === 'hide') {\n      this.parent.on(events.scroll, this.hideQuickToolbars, this);\n      this.parent.on(events.contentscroll, this.hideQuickToolbars, this);\n    }\n\n    this.parent.on(events.focusChange, this.hideQuickToolbars, this);\n    this.parent.on(events.iframeMouseDown, this.onIframeMouseDown, this);\n    this.parent.on(events.destroy, this.destroy, this);\n    this.parent.on(events.keyDown, this.onKeyDown, this);\n    this.parent.on(events.rtlMode, this.setRtl, this);\n  };\n\n  QuickToolbar.prototype.onKeyDown = function (e) {\n    var args = e.args;\n\n    if (args.which === 8 || args.which === 46) {\n      if (this.imageQTBar && !hasClass(this.imageQTBar.element, 'e-popup-close')) {\n        this.imageQTBar.hidePopup();\n      }\n    }\n  };\n\n  QuickToolbar.prototype.onIframeMouseDown = function () {\n    this.hideQuickToolbars();\n    this.hideInlineQTBar();\n  };\n\n  QuickToolbar.prototype.setRtl = function (args) {\n    if (this.inlineQTBar) {\n      this.inlineQTBar.quickTBarObj.toolbarObj.setProperties({\n        enableRtl: args.enableRtl\n      });\n    }\n\n    if (this.imageQTBar) {\n      this.imageQTBar.quickTBarObj.toolbarObj.setProperties({\n        enableRtl: args.enableRtl\n      });\n    }\n\n    if (this.linkQTBar) {\n      this.imageQTBar.quickTBarObj.toolbarObj.setProperties({\n        enableRtl: args.enableRtl\n      });\n    }\n  };\n  /**\n   * removeEventListener\n   *\n   * @returns {void}\n   * @hidden\n    */\n\n\n  QuickToolbar.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.off(events.initialEnd, this.initializeQuickToolbars);\n    this.parent.off(events.mouseDown, this.renderQuickToolbars);\n    this.parent.off(events.toolbarUpdated, this.toolbarUpdated);\n    this.parent.off(events.drop, this.renderQuickToolbars);\n    this.unWireInlineQTBarEvents();\n    this.parent.off(events.modelChanged, this.onPropertyChanged);\n\n    if (this.parent.quickToolbarSettings.actionOnScroll === 'hide') {\n      this.parent.off(events.scroll, this.hideQuickToolbars);\n      this.parent.off(events.contentscroll, this.hideQuickToolbars);\n    }\n\n    this.parent.off(events.focusChange, this.hideQuickToolbars);\n    this.parent.off(events.destroy, this.destroy);\n    this.parent.off(events.iframeMouseDown, this.onIframeMouseDown);\n    this.parent.off(events.keyDown, this.onKeyDown);\n    this.parent.off(events.rtlMode, this.setRtl);\n  };\n  /**\n   * Called internally if any of the property value changed.\n   *\n   * @param {RichTextEditorModel} e - specifies the element.\n   * @returns {void}\n   * @hidden\n    */\n\n\n  QuickToolbar.prototype.onPropertyChanged = function (e) {\n    if (!isNullOrUndefined(e.newProp.quickToolbarSettings)) {\n      for (var _i = 0, _a = Object.keys(e.newProp.quickToolbarSettings); _i < _a.length; _i++) {\n        var prop = _a[_i];\n\n        switch (prop) {\n          case 'actionOnScroll':\n            if (e.newProp.quickToolbarSettings.actionOnScroll === 'none') {\n              this.parent.off(events.scroll, this.hideQuickToolbars);\n              this.parent.off(events.contentscroll, this.hideQuickToolbars);\n            } else {\n              this.parent.on(events.scroll, this.hideQuickToolbars, this);\n              this.parent.on(events.contentscroll, this.hideQuickToolbars, this);\n            }\n\n            break;\n        }\n      }\n    }\n\n    if (e.module !== this.getModuleName()) {\n      return;\n    }\n\n    if (this.inlineQTBar) {\n      removeClass([this.parent.element], [CLS_INLINE]);\n      this.unWireInlineQTBarEvents();\n      this.hideInlineQTBar();\n    }\n\n    if (this.parent.inlineMode.enable && (!Browser.isDevice || isIDevice())) {\n      addClass([this.parent.element], [CLS_INLINE]);\n      this.wireInlineQTBarEvents();\n    }\n  };\n  /**\n   * For internal use only - Get the module name.\n   *\n   * @returns {void}\n   * @hidden\n   */\n\n\n  QuickToolbar.prototype.getModuleName = function () {\n    return 'quickToolbar';\n  };\n\n  return QuickToolbar;\n}();\n\nexport { QuickToolbar };","map":{"version":3,"sources":["/Users/tristanbilot/Desktop/Design4green/design4green/node_modules/@syncfusion/ej2-richtexteditor/src/rich-text-editor/actions/quick-toolbar.js"],"names":["select","isNullOrUndefined","Browser","addClass","removeClass","EventHandler","closest","isNOU","RenderType","events","pageYOffset","hasClass","isIDevice","BaseQuickToolbar","PopupRenderer","CLS_INLINE_POP","CLS_INLINE","QuickToolbar","parent","locator","renderFactory","getService","addRenderer","Popup","addEventListener","prototype","formatItems","items","formattedItems","forEach","item","toLocaleLowerCase","push","getQTBarOptions","popType","mode","type","popupType","toolbarItems","renderType","createQTBar","length","qTBar","render","initializeQuickToolbars","quickToolbarModule","contentRenderer","getRenderer","Content","inlineMode","enable","onSelection","add","getDocument","selectionChangeHandler","onMouseDown","e","isBlur","isRTE","renderQuickToolbars","linkQTBar","imageQTBar","textQTBar","tableQTBar","quickToolbarSettings","link","LinkToolbar","text","TextToolbar","image","ImageToolbar","table","TableToolbar","element","renderInlineQuickToolbar","isDevice","inlineQTBar","toolbarSettings","InlineToolbar","showInlineQTBar","x","y","target","readonly","showPopup","hideInlineQTBar","hidePopup","hideQuickToolbars","document","body","contains","deBounce","_this","clearTimeout","deBouncer","window","setTimeout","mouseUpHandler","args","touches","changedTouches","range","getRange","touchData","prevClientX","clientX","prevClientY","clientY","parentLeft","getBoundingClientRect","left","offsetX","iframeSettings","pageXOffset","pageX","offsetY","nodeName","closestAnchor","startNode","startContainer","parentElement","endNode","endContainer","collapsed","tagName","startOffset","endOffset","keyDownHandler","inlineQTBarMouseDownHandler","keyUpHandler","onSelectionChange","selection","getSelection","isCollapsed","getInlineBaseToolbar","quickTBarObj","destroy","remove","removeEventListener","wireInlineQTBarEvents","on","mouseUp","mouseDown","keyDown","keyUp","sourceCodeMouseDown","renderInlineToolbar","unWireInlineQTBarEvents","off","toolbarUpdated","isDestroyed","initialEnd","drop","modelChanged","onPropertyChanged","actionOnScroll","scroll","contentscroll","focusChange","iframeMouseDown","onIframeMouseDown","onKeyDown","rtlMode","setRtl","which","toolbarObj","setProperties","enableRtl","newProp","_i","_a","Object","keys","prop","module","getModuleName"],"mappings":"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","sourcesContent":["import { select, isNullOrUndefined, Browser, addClass, removeClass, EventHandler, closest, isNullOrUndefined as isNOU } from '@syncfusion/ej2-base';\nimport { RenderType } from '../base/enum';\nimport * as events from '../base/constant';\nimport { pageYOffset, hasClass, isIDevice } from '../base/util';\nimport { BaseQuickToolbar } from './base-quick-toolbar';\nimport { PopupRenderer } from '../renderer/popup-renderer';\nimport { CLS_INLINE_POP, CLS_INLINE } from '../base/classes';\n/**\n * `Quick toolbar` module is used to handle Quick toolbar actions.\n */\nvar QuickToolbar = /** @class */ (function () {\n    function QuickToolbar(parent, locator) {\n        this.parent = parent;\n        this.locator = locator;\n        this.renderFactory = this.locator.getService('rendererFactory');\n        this.renderFactory.addRenderer(RenderType.Popup, new PopupRenderer(this.parent));\n        this.addEventListener();\n    }\n    QuickToolbar.prototype.formatItems = function (items) {\n        var formattedItems = [];\n        items.forEach(function (item) {\n            if (typeof item === 'string') {\n                switch (item.toLocaleLowerCase()) {\n                    case 'open':\n                        formattedItems.push('openLink');\n                        break;\n                    case 'edit':\n                        formattedItems.push('editLink');\n                        break;\n                    case 'unlink':\n                        formattedItems.push('removeLink');\n                        break;\n                    default:\n                        formattedItems.push(item);\n                        break;\n                }\n            }\n            else {\n                formattedItems.push(item);\n            }\n        });\n        return formattedItems;\n    };\n    QuickToolbar.prototype.getQTBarOptions = function (popType, mode, items, type) {\n        return {\n            popupType: popType,\n            toolbarItems: items,\n            mode: mode,\n            renderType: type\n        };\n    };\n    /**\n     * createQTBar method\n     *\n     * @param {string} popupType - specifies the string value\n     * @param {string} mode - specifies the string value.\n     * @param {string} items - specifies the string.\n     * @param {RenderType} type - specifies the render type.\n     * @returns {BaseQuickToolbar} - specifies the quick toolbar\n     * @hidden\n\n     */\n    QuickToolbar.prototype.createQTBar = function (popupType, mode, items, type) {\n        if (items.length < 1) {\n            return null;\n        }\n        var qTBar = new BaseQuickToolbar(this.parent, this.locator);\n        qTBar.render(this.getQTBarOptions(popupType, mode, this.formatItems(items), type));\n        return qTBar;\n    };\n    QuickToolbar.prototype.initializeQuickToolbars = function () {\n        this.parent.quickToolbarModule = this;\n        this.contentRenderer = this.renderFactory.getRenderer(RenderType.Content);\n        if (this.parent.inlineMode.enable && this.parent.inlineMode.onSelection && isIDevice()) {\n            EventHandler.add(this.contentRenderer.getDocument(), 'selectionchange', this.selectionChangeHandler, this);\n        }\n    };\n    // eslint-disable-next-line\n    QuickToolbar.prototype.onMouseDown = function (e) {\n        this.parent.isBlur = false;\n        this.parent.isRTE = true;\n    };\n    QuickToolbar.prototype.renderQuickToolbars = function () {\n        if (this.linkQTBar || this.imageQTBar || this.textQTBar || this.tableQTBar) {\n            return;\n        }\n        this.linkQTBar = this.createQTBar('Link', 'Scrollable', this.parent.quickToolbarSettings.link, RenderType.LinkToolbar);\n        this.renderFactory.addRenderer(RenderType.LinkToolbar, this.linkQTBar);\n        this.textQTBar = this.createQTBar('Text', 'Scrollable', this.parent.quickToolbarSettings.text, RenderType.TextToolbar);\n        this.renderFactory.addRenderer(RenderType.TextToolbar, this.textQTBar);\n        this.imageQTBar = this.createQTBar('Image', 'MultiRow', this.parent.quickToolbarSettings.image, RenderType.ImageToolbar);\n        this.renderFactory.addRenderer(RenderType.ImageToolbar, this.imageQTBar);\n        this.tableQTBar = this.createQTBar('Table', 'MultiRow', this.parent.quickToolbarSettings.table, RenderType.TableToolbar);\n        this.renderFactory.addRenderer(RenderType.TableToolbar, this.tableQTBar);\n        if (this.linkQTBar) {\n            EventHandler.add(this.linkQTBar.element, 'mousedown', this.onMouseDown, this);\n        }\n        if (this.imageQTBar) {\n            EventHandler.add(this.imageQTBar.element, 'mousedown', this.onMouseDown, this);\n        }\n        if (this.textQTBar) {\n            EventHandler.add(this.textQTBar.element, 'mousedown', this.onMouseDown, this);\n        }\n        if (this.tableQTBar) {\n            EventHandler.add(this.tableQTBar.element, 'mousedown', this.onMouseDown, this);\n        }\n    };\n    QuickToolbar.prototype.renderInlineQuickToolbar = function () {\n        if (this.parent.inlineMode.enable && (!Browser.isDevice || isIDevice())) {\n            addClass([this.parent.element], [CLS_INLINE]);\n            this.inlineQTBar = this.createQTBar('Inline', 'MultiRow', this.parent.toolbarSettings.items, RenderType.InlineToolbar);\n            this.renderFactory.addRenderer(RenderType.InlineToolbar, this.inlineQTBar);\n            EventHandler.add(this.inlineQTBar.element, 'mousedown', this.onMouseDown, this);\n        }\n    };\n    /**\n     * Method for showing the inline quick toolbar\n     *\n     * @param {number} x -specifies the value of x.\n     * @param {number} y - specifies the y valu.\n     * @param {HTMLElement} target - specifies the target element.\n     * @returns {void}\n     * @hidden\n\n     */\n    QuickToolbar.prototype.showInlineQTBar = function (x, y, target) {\n        if (this.parent.readonly) {\n            return;\n        }\n        this.inlineQTBar.showPopup(x, y, target);\n    };\n    /**\n     * Method for hidding the inline quick toolbar\n     *\n     * @returns {void}\n     * @hidden\n\n     */\n    QuickToolbar.prototype.hideInlineQTBar = function () {\n        if (this.inlineQTBar && !hasClass(this.inlineQTBar.element, 'e-popup-close')) {\n            this.inlineQTBar.hidePopup();\n        }\n    };\n    /**\n     * Method for hidding the quick toolbar\n     *\n     * @returns {void}\n     * @hidden\n\n     */\n    QuickToolbar.prototype.hideQuickToolbars = function () {\n        if (this.linkQTBar && !hasClass(this.linkQTBar.element, 'e-popup-close') && document.body.contains(this.linkQTBar.element)) {\n            this.linkQTBar.hidePopup();\n        }\n        if (this.textQTBar && !hasClass(this.textQTBar.element, 'e-popup-close') && document.body.contains(this.textQTBar.element)) {\n            this.textQTBar.hidePopup();\n        }\n        if (this.imageQTBar && !hasClass(this.imageQTBar.element, 'e-popup-close') && document.body.contains(this.imageQTBar.element)) {\n            this.imageQTBar.hidePopup();\n        }\n        if (this.tableQTBar && !hasClass(this.tableQTBar.element, 'e-popup-close') && document.body.contains(this.tableQTBar.element)) {\n            this.tableQTBar.hidePopup();\n        }\n        if (this.parent.inlineMode.enable && (!Browser.isDevice || isIDevice())) {\n            this.hideInlineQTBar();\n        }\n    };\n    QuickToolbar.prototype.deBounce = function (x, y, target) {\n        var _this = this;\n        clearTimeout(this.deBouncer);\n        this.deBouncer = window.setTimeout(function () {\n            _this.showInlineQTBar(x, y, target);\n        }, 1000);\n    };\n    QuickToolbar.prototype.mouseUpHandler = function (e) {\n        if (this.parent.inlineMode.enable && (!Browser.isDevice || isIDevice())) {\n            var args = e.args.touches ?\n                e.args.changedTouches[0] : e.args;\n            var range = this.parent.getRange();\n            var target = e.args.target;\n            if (isNullOrUndefined(select('.' + CLS_INLINE_POP, document.body))) {\n                if (isIDevice() && e.touchData && e.touchData.prevClientX !== e.touchData.clientX\n                    && e.touchData.prevClientY !== e.touchData.clientY) {\n                    return;\n                }\n                this.hideInlineQTBar();\n                var parentLeft = this.parent.element.getBoundingClientRect().left;\n                this.offsetX = this.parent.iframeSettings.enable ? window.pageXOffset + parentLeft + args.clientX : args.pageX;\n                this.offsetY = pageYOffset(args, this.parent.element, this.parent.iframeSettings.enable);\n                if (target.nodeName === 'TEXTAREA') {\n                    this.showInlineQTBar(this.offsetX, this.offsetY, target);\n                }\n                else {\n                    var closestAnchor = closest(target, 'a');\n                    target = closestAnchor ? closestAnchor : target;\n                    var startNode = this.parent.getRange().startContainer.parentElement;\n                    var endNode = this.parent.getRange().endContainer.parentElement;\n                    if ((isNOU(closest(startNode, 'A')) || isNOU(closest(endNode, 'A'))) && (!closest(target, 'td,th') || !range.collapsed) &&\n                        (target.tagName !== 'IMG' || this.parent.getRange().startOffset !== this.parent.getRange().endOffset)) {\n                        if (this.parent.inlineMode.onSelection && range.collapsed) {\n                            return;\n                        }\n                        this.target = target;\n                        this.showInlineQTBar(this.offsetX, this.offsetY, target);\n                    }\n                }\n            }\n        }\n    };\n    QuickToolbar.prototype.keyDownHandler = function () {\n        if ((this.parent.inlineMode.enable && (!Browser.isDevice || isIDevice()))\n            && !isNullOrUndefined(select('.' + CLS_INLINE_POP, document))) {\n            this.hideInlineQTBar();\n        }\n    };\n    QuickToolbar.prototype.inlineQTBarMouseDownHandler = function () {\n        if ((this.parent.inlineMode.enable && (!Browser.isDevice || isIDevice()))\n            && !isNullOrUndefined(select('.' + CLS_INLINE_POP, document))) {\n            this.hideInlineQTBar();\n        }\n    };\n    QuickToolbar.prototype.keyUpHandler = function (e) {\n        if (this.parent.inlineMode.enable && !Browser.isDevice) {\n            if (this.parent.inlineMode.onSelection) {\n                return;\n            }\n            var args = e.args;\n            this.deBounce(this.offsetX, this.offsetY, args.target);\n        }\n    };\n    QuickToolbar.prototype.selectionChangeHandler = function (e) {\n        var _this = this;\n        clearTimeout(this.deBouncer);\n        this.deBouncer = window.setTimeout(function () {\n            _this.onSelectionChange(e);\n        }, 1000);\n    };\n    QuickToolbar.prototype.onSelectionChange = function (e) {\n        if (!isNullOrUndefined(select('.' + CLS_INLINE_POP, document.body))) {\n            return;\n        }\n        var selection = this.contentRenderer.getDocument().getSelection();\n        if (!selection.isCollapsed) {\n            this.mouseUpHandler({ args: e });\n        }\n    };\n    /**\n     * getInlineBaseToolbar method\n     *\n     * @returns {void}\n     * @hidden\n\n     */\n    QuickToolbar.prototype.getInlineBaseToolbar = function () {\n        return this.inlineQTBar && this.inlineQTBar.quickTBarObj;\n    };\n    /**\n     * Destroys the ToolBar.\n     *\n     * @function destroy\n     * @returns {void}\n     * @hidden\n\n     */\n    QuickToolbar.prototype.destroy = function () {\n        if (this.linkQTBar) {\n            EventHandler.remove(this.linkQTBar.element, 'mousedown', this.onMouseDown);\n            this.linkQTBar.destroy();\n        }\n        if (this.textQTBar) {\n            EventHandler.remove(this.textQTBar.element, 'mousedown', this.onMouseDown);\n            this.textQTBar.destroy();\n        }\n        if (this.imageQTBar) {\n            EventHandler.remove(this.imageQTBar.element, 'mousedown', this.onMouseDown);\n            this.imageQTBar.destroy();\n        }\n        if (this.tableQTBar) {\n            EventHandler.remove(this.tableQTBar.element, 'mousedown', this.onMouseDown);\n            this.tableQTBar.destroy();\n        }\n        if (this.inlineQTBar) {\n            EventHandler.remove(this.inlineQTBar.element, 'mousedown', this.onMouseDown);\n            if (isIDevice()) {\n                EventHandler.remove(document, 'selectionchange', this.selectionChangeHandler);\n            }\n            this.inlineQTBar.destroy();\n        }\n        this.removeEventListener();\n    };\n    QuickToolbar.prototype.wireInlineQTBarEvents = function () {\n        this.parent.on(events.mouseUp, this.mouseUpHandler, this);\n        this.parent.on(events.mouseDown, this.inlineQTBarMouseDownHandler, this);\n        this.parent.on(events.keyDown, this.keyDownHandler, this);\n        this.parent.on(events.keyUp, this.keyUpHandler, this);\n        this.parent.on(events.sourceCodeMouseDown, this.mouseUpHandler, this);\n        this.parent.on(events.renderInlineToolbar, this.renderInlineQuickToolbar, this);\n    };\n    QuickToolbar.prototype.unWireInlineQTBarEvents = function () {\n        this.parent.off(events.mouseUp, this.mouseUpHandler);\n        this.parent.off(events.mouseDown, this.inlineQTBarMouseDownHandler);\n        this.parent.off(events.keyDown, this.keyDownHandler);\n        this.parent.off(events.keyUp, this.keyUpHandler);\n        this.parent.off(events.sourceCodeMouseDown, this.mouseUpHandler);\n        this.parent.off(events.renderInlineToolbar, this.renderInlineQuickToolbar);\n    };\n    // eslint-disable-next-line\n    QuickToolbar.prototype.toolbarUpdated = function (args) {\n        if (this.linkQTBar && !hasClass(this.linkQTBar.element, 'e-popup-close')) {\n            this.linkQTBar.hidePopup();\n        }\n        if (this.imageQTBar && !hasClass(this.imageQTBar.element, 'e-popup-close')) {\n            this.imageQTBar.hidePopup();\n        }\n        if (this.tableQTBar && !hasClass(this.tableQTBar.element, 'e-popup-close')) {\n            this.tableQTBar.hidePopup();\n        }\n    };\n    /**\n     * addEventListener\n     *\n     * @returns {void}\n     * @hidden\n\n     */\n    QuickToolbar.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(events.initialEnd, this.initializeQuickToolbars, this);\n        this.parent.on(events.mouseDown, this.renderQuickToolbars, this);\n        this.parent.on(events.toolbarUpdated, this.toolbarUpdated, this);\n        this.parent.on(events.drop, this.renderQuickToolbars, this);\n        this.wireInlineQTBarEvents();\n        this.parent.on(events.modelChanged, this.onPropertyChanged, this);\n        if (this.parent.quickToolbarSettings.actionOnScroll === 'hide') {\n            this.parent.on(events.scroll, this.hideQuickToolbars, this);\n            this.parent.on(events.contentscroll, this.hideQuickToolbars, this);\n        }\n        this.parent.on(events.focusChange, this.hideQuickToolbars, this);\n        this.parent.on(events.iframeMouseDown, this.onIframeMouseDown, this);\n        this.parent.on(events.destroy, this.destroy, this);\n        this.parent.on(events.keyDown, this.onKeyDown, this);\n        this.parent.on(events.rtlMode, this.setRtl, this);\n    };\n    QuickToolbar.prototype.onKeyDown = function (e) {\n        var args = e.args;\n        if (args.which === 8 || args.which === 46) {\n            if (this.imageQTBar && !hasClass(this.imageQTBar.element, 'e-popup-close')) {\n                this.imageQTBar.hidePopup();\n            }\n        }\n    };\n    QuickToolbar.prototype.onIframeMouseDown = function () {\n        this.hideQuickToolbars();\n        this.hideInlineQTBar();\n    };\n    QuickToolbar.prototype.setRtl = function (args) {\n        if (this.inlineQTBar) {\n            this.inlineQTBar.quickTBarObj.toolbarObj.setProperties({ enableRtl: args.enableRtl });\n        }\n        if (this.imageQTBar) {\n            this.imageQTBar.quickTBarObj.toolbarObj.setProperties({ enableRtl: args.enableRtl });\n        }\n        if (this.linkQTBar) {\n            this.imageQTBar.quickTBarObj.toolbarObj.setProperties({ enableRtl: args.enableRtl });\n        }\n    };\n    /**\n     * removeEventListener\n     *\n     * @returns {void}\n     * @hidden\n\n     */\n    QuickToolbar.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(events.initialEnd, this.initializeQuickToolbars);\n        this.parent.off(events.mouseDown, this.renderQuickToolbars);\n        this.parent.off(events.toolbarUpdated, this.toolbarUpdated);\n        this.parent.off(events.drop, this.renderQuickToolbars);\n        this.unWireInlineQTBarEvents();\n        this.parent.off(events.modelChanged, this.onPropertyChanged);\n        if (this.parent.quickToolbarSettings.actionOnScroll === 'hide') {\n            this.parent.off(events.scroll, this.hideQuickToolbars);\n            this.parent.off(events.contentscroll, this.hideQuickToolbars);\n        }\n        this.parent.off(events.focusChange, this.hideQuickToolbars);\n        this.parent.off(events.destroy, this.destroy);\n        this.parent.off(events.iframeMouseDown, this.onIframeMouseDown);\n        this.parent.off(events.keyDown, this.onKeyDown);\n        this.parent.off(events.rtlMode, this.setRtl);\n    };\n    /**\n     * Called internally if any of the property value changed.\n     *\n     * @param {RichTextEditorModel} e - specifies the element.\n     * @returns {void}\n     * @hidden\n\n     */\n    QuickToolbar.prototype.onPropertyChanged = function (e) {\n        if (!isNullOrUndefined(e.newProp.quickToolbarSettings)) {\n            for (var _i = 0, _a = Object.keys(e.newProp.quickToolbarSettings); _i < _a.length; _i++) {\n                var prop = _a[_i];\n                switch (prop) {\n                    case 'actionOnScroll':\n                        if (e.newProp.quickToolbarSettings.actionOnScroll === 'none') {\n                            this.parent.off(events.scroll, this.hideQuickToolbars);\n                            this.parent.off(events.contentscroll, this.hideQuickToolbars);\n                        }\n                        else {\n                            this.parent.on(events.scroll, this.hideQuickToolbars, this);\n                            this.parent.on(events.contentscroll, this.hideQuickToolbars, this);\n                        }\n                        break;\n                }\n            }\n        }\n        if (e.module !== this.getModuleName()) {\n            return;\n        }\n        if (this.inlineQTBar) {\n            removeClass([this.parent.element], [CLS_INLINE]);\n            this.unWireInlineQTBarEvents();\n            this.hideInlineQTBar();\n        }\n        if (this.parent.inlineMode.enable && (!Browser.isDevice || isIDevice())) {\n            addClass([this.parent.element], [CLS_INLINE]);\n            this.wireInlineQTBarEvents();\n        }\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {void}\n     * @hidden\n     */\n    QuickToolbar.prototype.getModuleName = function () {\n        return 'quickToolbar';\n    };\n    return QuickToolbar;\n}());\nexport { QuickToolbar };\n"]},"metadata":{},"sourceType":"module"}